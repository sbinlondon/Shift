{"version":3,"file":"index.mjs","sources":["../src/backend/index.js"],"sourcesContent":["import axios from 'axios'\n\nfunction useBackend(baseURL, timeout = 10000) {\n  // Configure Axios\n  const api = axios.create({ baseURL, timeout })\n\n  // Helper method for Authorization header\n  const auth = (token) => ({\n    headers: { Authorization: 'Bearer ' + token }\n  })\n\n  const backend = {}\n\n  // Oauth\n  backend.initOauth = (data) => api.post('/oauth/init', data) // Init Oauth (to get state)\n  backend.providerLogin = (data) => api.post('/oauth/login', data) // Finalize Oauth login\n\n  // Signup flow\n  backend.signup = (email, password, language) => api.post('/signup', { email, password, language }) // Signup\n  backend.confirm = (confirmId) => api.post('/account', { id: confirmId }) // Confirm\n  backend.createAccount = (confirmId, consent) => api.post('/account', { id: confirmId, consent }) // Create account\n  backend.resendActivationEmail = (email, language) => api.post('/resend', { email, language }) // Re-send activation email\n\n  // Other non-authenticated calls\n  backend.login = (username, password) => api.post('/login', { username, password }) // Login\n  backend.confirmationLogin = (id) => api.post('/confirm/login', { id }) // Confirmation-based login\n  backend.recoverAccount = (username) => api.post('/account/recover', { username: username }) // Ask for a password reset\n  backend.loadPattern = (handle) => api.get('/pattern/' + handle) // Load pattern anonymously\n  backend.loadPatrons = (handle) => api.get('/patrons') // Load patron list\n  backend.newsletterSubscribe = (email) => api.post('/newsletter/subscribe', { email }) // Subscribe email to newsletter\n  backend.newsletterUnsubscribe = (email) => api.post('/newsletter/unsubscribe', { email }) // Unsubscribe email from newsletter\n  // Users\n  backend.profile = (username, token) => api.get('/users/' + username, auth(token)) // Load user profile\n  backend.account = (token) => api.get('/account', auth(token)) // Try to authenticate based on stored token\n  backend.export = (token) => api.get('/account/export', auth(token)) // Export data\n  backend.restrict = (token) => api.get('/account/restrict', auth(token)) // Restrict data processing (freeze account)\n  backend.remove = (token) => api.delete('/account', auth(token)) // Remove account\n  backend.saveAccount = (data, token) => api.put('/account', data, auth(token)) // Update account\n  backend.availableUsername = (data, token) => api.post('/available/username', data, auth(token)) // Check is a username is available\n  backend.setPassword = (data, token) => api.post('/set/password', data, auth(token)) // (re)set a new password\n\n  // People\n  backend.createPerson = (data, token) => api.post('/people', data, auth(token)) // Create person\n  backend.savePerson = (handle, data, token) => api.put('/people/' + handle, data, auth(token)) // Update person\n  backend.removePerson = (handle, token) => api.delete('/people/' + handle, auth(token)) // Remove person\n\n  // Patterns\n  backend.loadPattern = (handle, token) => api.get('/patterns/' + handle, auth(token)) // Load pattern\n  backend.createPattern = (data, token) => api.post('/patterns', data, auth(token)) // Create pattern\n  backend.removePattern = (handle, token) => api.delete('/patterns/' + handle, auth(token)) // Remove pattern\n  backend.savePattern = (handle, data, token) => api.put('/patterns/' + handle, data, auth(token)) // Update pattern\n\n  // Github\n  backend.createGist = (data) => api.post('/github/gist', data) // Export pattern as Github gist\n  backend.createIssue = (data) => api.post('/github/issue', data) // Create Github issue\n\n  // Admin\n  backend.adminSearch = (query, token) => api.post('/admin/search', { query }, auth(token)) // Search users as admin\n  backend.adminSetPatronStatus = (data, token) => api.put('/admin/patron', data, auth(token)) // Set patron status for a user\n  backend.adminSetRole = (data, token) => api.put('/admin/role', data, auth(token)) // Set role for a user\n  backend.adminUnfreeze = (data, token) => api.put('/admin/unfreeze', data, auth(token)) // Unfreeze a user account\n  backend.adminImpersonate = (data, token) => api.post('/admin/impersonate', data, auth(token)) // Impersonate a user\n  backend.adminPatronList = (token) => api.get('/admin/patrons', auth(token)) // Get patron list\n  backend.adminSubscriberList = (token) => api.get('/admin/subscribers', auth(token)) // Get patron list\n  backend.adminStats = (token) => api.get('/admin/stats', auth(token)) // Get stats\n\n  return backend\n}\n\nexport default useBackend\n"],"names":["useBackend","baseURL","timeout","api","axios","create","auth","token","headers","Authorization","backend","initOauth","data","post","providerLogin","signup","email","password","language","confirm","confirmId","id","createAccount","consent","resendActivationEmail","login","username","confirmationLogin","recoverAccount","loadPattern","handle","get","loadPatrons","newsletterSubscribe","newsletterUnsubscribe","profile","account","export","restrict","remove","delete","saveAccount","put","availableUsername","setPassword","createPerson","savePerson","removePerson","createPattern","removePattern","savePattern","createGist","createIssue","adminSearch","query","adminSetPatronStatus","adminSetRole","adminUnfreeze","adminImpersonate","adminPatronList","adminSubscriberList","adminStats"],"mappings":"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"}