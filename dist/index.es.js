/**
 * 18shift | v0.0.1
 * 18th century shift
 * (c) 2021 Zee
 * @license MIT
 */
/**
 * @freesewing/core | v2.17.0
 * A library for creating made-to-measure sewing patterns
 * (c) 2021 Joost De Cock <joost@joost.at> (https://github.com/joostdecock)
 * @license MIT
 */
function e(){this.list={}}function i(t,i,s=!1){this.x=t,this.y=i,this.attributes=new e,Object.defineProperty(this,"debug",{value:s,configurable:!0})}e.prototype.add=function(t,e){return void 0===this.list[t]&&(this.list[t]=[]),this.list[t].push(e),this},e.prototype.set=function(t,e){return this.list[t]=[e],this},e.prototype.remove=function(t){return delete this.list[t],this},e.prototype.get=function(t){return void 0!==this.list[t]&&this.list[t].join(" ")},e.prototype.getAsArray=function(t){return void 0!==this.list[t]&&this.list[t]},e.prototype.render=function(){let t="";for(let e in this.list)t+=` ${e}="${this.list[e].join(" ")}"`;return t},e.prototype.renderAsCss=function(){let t="";for(let e in this.list)t+=` ${e}:${this.list[e].join(" ")};`;return t},e.prototype.renderIfPrefixIs=function(t=""){let e="",i=t.length;for(let s in this.list)s.substr(0,i)===t&&(e+=` ${s.substr(i)}="${this.list[s].join(" ")}"`);return e},e.prototype.asPropsIfPrefixIs=function(t=""){let e={},i=t.length;for(let s in this.list)if(s.substr(0,i)===t){let t=s.substr(i);"class"===t&&(t="className"),e[t]=this.get(s)}return e},e.prototype.clone=function(){let t=new e;return t.list=JSON.parse(JSON.stringify(this.list)),t},i.prototype.withRaise=function(t=!1){return t&&Object.defineProperty(this,"raise",{value:t}),this},i.prototype.check=function(){"number"!=typeof this.x&&this.raise.warning("X value of `Point` is not a number"),"number"!=typeof this.y&&this.raise.warning("Y value of `Point` is not a number")},i.prototype.rad2deg=function(t){return 57.29577951308232*t},i.prototype.deg2rad=function(t){return t/57.29577951308232},i.prototype.attr=function(t,e,i=!1){return this.debug&&this.check(),i?this.attributes.set(t,e):this.attributes.add(t,e),this},i.prototype.dist=function(t){this.debug&&(this.check(),t.check());let e=this.x-t.x,i=this.y-t.y;return Math.sqrt(Math.pow(e,2)+Math.pow(i,2))},i.prototype.slope=function(t){return this.debug&&(this.check(),t.check()),(t.y-this.y)/(t.x-this.x)},i.prototype.dx=function(t){return this.debug&&(this.check(),t.check()),t.x-this.x},i.prototype.dy=function(t){return this.debug&&(this.check(),t.check()),t.y-this.y},i.prototype.angle=function(t){this.debug&&(this.check(),t.check());let e=Math.atan2(-1*this.dy(t),this.dx(t));for(;e<0;)e+=2*Math.PI;return this.rad2deg(e)},i.prototype.rotate=function(t,e){this.debug&&(this.check(),e.check(),"number"!=typeof t&&this.raise.warning("Called `Point.rotate(deg,that)` but `deg` is not a number"),e instanceof i!=!0&&this.raise.warning("Called `Point.rotate(deg,that)` but `that` is not a `Point` object"));let s=this.dist(e),n=this.angle(e);return new i(e.x+s*Math.cos(this.deg2rad(n+t))*-1,e.y+s*Math.sin(this.deg2rad(n+t)),this.debug).withRaise(this.raise)},i.prototype.copy=function(){return this.debug&&this.check(),new i(this.x,this.y,this.debug).withRaise(this.raise)},i.prototype.flipX=function(t=!1){return this.debug&&(this.check(),t&&(t instanceof i!=!0&&this.raise.warning("Called `Point.rotate(deg,that)` but `that` is not a `Point` object"),t.check())),!1===t||0===t.x?new i(-1*this.x,this.y,this.debug).withRaise(this.raise):new i(t.x+this.dx(t),this.y,this.debug).withRaise(this.raise)},i.prototype.flipY=function(t=!1){return this.debug&&(this.check(),t&&(t instanceof i!=!0&&this.raise.warning("Called `Point.flipY(that)` but `that` is not a `Point` object"),t.check())),!1===t||0===t.y?new i(this.x,-1*this.y,this.debug).withRaise(this.raise):new i(this.x,t.y+this.dy(t),this.debug).withRaise(this.raise)},i.prototype.shift=function(t,e){this.debug&&(this.check(),"number"!=typeof e&&this.raise.warning("Called `Point.shift` but `distance` is not a number"));let i=this.copy();return i.x+=e,i.rotate(t,this)},i.prototype.shiftTowards=function(t,e){return this.debug&&("number"!=typeof e&&this.raise.warning("Called `Point.shiftTowards` but `distance` is not a number"),t instanceof i!=!0&&this.raise.warning("Called `Point.shiftTowards(that, distance)` but `that` is not a `Point` object"),this.check(),t.check()),this.debug&&this.check(),this.shift(this.angle(t),e)},i.prototype.sitsOn=function(t){return this.debug&&(t instanceof i!=!0&&this.raise.warning("Called `Point.sitsOn(that)` but `that` is not a `Point` object"),this.check(),t.check()),this.x===t.x&&this.y===t.y},i.prototype.sitsRoughlyOn=function(t){return this.debug&&(t instanceof i!=!0&&this.raise.warning("Called `Point.sitsRoughlyOn(that)` but `that` is not a `Point` object"),this.check(),t.check()),Math.round(this.x)===Math.round(t.x)&&Math.round(this.y)===Math.round(t.y)},i.prototype.shiftFractionTowards=function(t,e){return this.debug&&(t instanceof i!=!0&&this.raise.warning("Called `Point.shiftFractionTowards(that, fraction)` but `that` is not a `Point` object"),"number"!=typeof e&&this.raise.warning("Called `Point.shiftFractionTowards` but `fraction` is not a number"),this.check(),t.check()),this.shiftTowards(t,this.dist(t)*e)},i.prototype.shiftOutwards=function(t,e){return this.debug&&(t instanceof i!=!0&&this.raise.warning("Called `Point.shiftOutwards(that, distance)` but `that` is not a `Point` object"),"number"!=typeof e&&this.raise.warning("Called `Point.shiftOutwards(that, distance)` but `distance` is not a number"),this.check(),t.check()),this.shiftTowards(t,this.dist(t)+e)},i.prototype.clone=function(){this.debug&&this.check();let t=new i(this.x,this.y,this.debug).withRaise(this.raise);return t.attributes=this.attributes.clone(),t},i.prototype.translate=function(t,e){this.debug&&(this.check(),"number"!=typeof t&&this.raise.warning("Called `Point.translate(x,y)` but `x` is not a number"),"number"!=typeof e&&this.raise.warning("Called `Point.translate(x,y)` but `y` is not a number"));let i=this.copy();return i.x+=t,i.y+=e,i};const{abs:s,cos:n,sin:o,acos:r,atan2:a,sqrt:h,pow:p}=Math;function l(t){return t<0?-p(-t,1/3):p(t,1/3)}const c=Math.PI,u=2*c,f=c/2,d=Number.MAX_SAFE_INTEGER||9007199254740991,y=Number.MIN_SAFE_INTEGER||-9007199254740991,x={x:0,y:0,z:0},g={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(t,e){const i=e(t);let s=i.x*i.x+i.y*i.y;return void 0!==i.z&&(s+=i.z*i.z),h(s)},compute:function(t,e,i){if(0===t)return e[0].t=0,e[0];const s=e.length-1;if(1===t)return e[s].t=1,e[s];const n=1-t;let o=e;if(0===s)return e[0].t=t,e[0];if(1===s){const e={x:n*o[0].x+t*o[1].x,y:n*o[0].y+t*o[1].y,t:t};return i&&(e.z=n*o[0].z+t*o[1].z),e}if(s<4){let e,r,a,h=n*n,p=t*t,l=0;2===s?(o=[o[0],o[1],o[2],x],e=h,r=n*t*2,a=p):3===s&&(e=h*n,r=h*t*3,a=n*p*3,l=t*p);const c={x:e*o[0].x+r*o[1].x+a*o[2].x+l*o[3].x,y:e*o[0].y+r*o[1].y+a*o[2].y+l*o[3].y,t:t};return i&&(c.z=e*o[0].z+r*o[1].z+a*o[2].z+l*o[3].z),c}const r=JSON.parse(JSON.stringify(e));for(;r.length>1;){for(let e=0;e<r.length-1;e++)r[e]={x:r[e].x+(r[e+1].x-r[e].x)*t,y:r[e].y+(r[e+1].y-r[e].y)*t},void 0!==r[e].z&&(r[e]=r[e].z+(r[e+1].z-r[e].z)*t);r.splice(r.length-1,1)}return r[0].t=t,r[0]},computeWithRatios:function(t,e,i,s){const n=1-t,o=i,r=e;let a,h=o[0],p=o[1],l=o[2],c=o[3];return h*=n,p*=t,2===r.length?(a=h+p,{x:(h*r[0].x+p*r[1].x)/a,y:(h*r[0].y+p*r[1].y)/a,z:!!s&&(h*r[0].z+p*r[1].z)/a,t:t}):(h*=n,p*=2*n,l*=t*t,3===r.length?(a=h+p+l,{x:(h*r[0].x+p*r[1].x+l*r[2].x)/a,y:(h*r[0].y+p*r[1].y+l*r[2].y)/a,z:!!s&&(h*r[0].z+p*r[1].z+l*r[2].z)/a,t:t}):(h*=n,p*=1.5*n,l*=3*n,c*=t*t*t,4===r.length?(a=h+p+l+c,{x:(h*r[0].x+p*r[1].x+l*r[2].x+c*r[3].x)/a,y:(h*r[0].y+p*r[1].y+l*r[2].y+c*r[3].y)/a,z:!!s&&(h*r[0].z+p*r[1].z+l*r[2].z+c*r[3].z)/a,t:t}):void 0))},derive:function(t,e){const i=[];for(let s=t,n=s.length,o=n-1;n>1;n--,o--){const t=[];for(let i,n=0;n<o;n++)i={x:o*(s[n+1].x-s[n].x),y:o*(s[n+1].y-s[n].y)},e&&(i.z=o*(s[n+1].z-s[n].z)),t.push(i);i.push(t),s=t}return i},between:function(t,e,i){return e<=t&&t<=i||g.approximately(t,e)||g.approximately(t,i)},approximately:function(t,e,i){return s(t-e)<=(i||1e-6)},length:function(t){const e=g.Tvalues.length;let i=0;for(let s,n=0;n<e;n++)s=.5*g.Tvalues[n]+.5,i+=g.Cvalues[n]*g.arcfn(s,t);return.5*i},map:function(t,e,i,s,n){return s+(n-s)*((t-e)/(i-e))},lerp:function(t,e,i){const s={x:e.x+t*(i.x-e.x),y:e.y+t*(i.y-e.y)};return void 0!==e.z&&void 0!==i.z&&(s.z=e.z+t*(i.z-e.z)),s},pointToString:function(t){let e=t.x+"/"+t.y;return void 0!==t.z&&(e+="/"+t.z),e},pointsToString:function(t){return"["+t.map(g.pointToString).join(", ")+"]"},copy:function(t){return JSON.parse(JSON.stringify(t))},angle:function(t,e,i){const s=e.x-t.x,n=e.y-t.y,o=i.x-t.x,r=i.y-t.y;return a(s*r-n*o,s*o+n*r)},round:function(t,e){const i=""+t,s=i.indexOf(".");return parseFloat(i.substring(0,s+1+e))},dist:function(t,e){const i=t.x-e.x,s=t.y-e.y;return h(i*i+s*s)},closest:function(t,e){let i,s,n=p(2,63);return t.forEach((function(t,o){s=g.dist(e,t),s<n&&(n=s,i=o)})),{mdist:n,mpos:i}},abcratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const i=p(t,e)+p(1-t,e);return s((i-1)/i)},projectionratio:function(t,e){if(2!==e&&3!==e)return!1;if(void 0===t)t=.5;else if(0===t||1===t)return t;const i=p(1-t,e);return i/(p(t,e)+i)},lli8:function(t,e,i,s,n,o,r,a){const h=(t-i)*(o-a)-(e-s)*(n-r);return 0!=h&&{x:((t*s-e*i)*(n-r)-(t-i)*(n*a-o*r))/h,y:((t*s-e*i)*(o-a)-(e-s)*(n*a-o*r))/h}},lli4:function(t,e,i,s){const n=t.x,o=t.y,r=e.x,a=e.y,h=i.x,p=i.y,l=s.x,c=s.y;return g.lli8(n,o,r,a,h,p,l,c)},lli:function(t,e){return g.lli4(t,t.c,e,e.c)},makeline:function(t,e){const i=t.x,s=t.y,n=e.x,o=e.y,r=(n-i)/3,a=(o-s)/3;return new R(i,s,i+r,s+a,i+2*r,s+2*a,n,o)},findbbox:function(t){let e=d,i=d,s=y,n=y;return t.forEach((function(t){const o=t.bbox();e>o.x.min&&(e=o.x.min),i>o.y.min&&(i=o.y.min),s<o.x.max&&(s=o.x.max),n<o.y.max&&(n=o.y.max)})),{x:{min:e,mid:(e+s)/2,max:s,size:s-e},y:{min:i,mid:(i+n)/2,max:n,size:n-i}}},shapeintersections:function(t,e,i,s,n){if(!g.bboxoverlap(e,s))return[];const o=[],r=[t.startcap,t.forward,t.back,t.endcap],a=[i.startcap,i.forward,i.back,i.endcap];return r.forEach((function(e){e.virtual||a.forEach((function(s){if(s.virtual)return;const r=e.intersects(s,n);r.length>0&&(r.c1=e,r.c2=s,r.s1=t,r.s2=i,o.push(r))}))})),o},makeshape:function(t,e,i){const s=e.points.length,n=t.points.length,o=g.makeline(e.points[s-1],t.points[0]),r=g.makeline(t.points[n-1],e.points[0]),a={startcap:o,forward:t,back:e,endcap:r,bbox:g.findbbox([o,t,e,r]),intersections:function(t){return g.shapeintersections(a,a.bbox,t,t.bbox,i)}};return a},getminmax:function(t,e,i){if(!i)return{min:0,max:0};let s,n,o=d,r=y;-1===i.indexOf(0)&&(i=[0].concat(i)),-1===i.indexOf(1)&&i.push(1);for(let a=0,h=i.length;a<h;a++)s=i[a],n=t.get(s),n[e]<o&&(o=n[e]),n[e]>r&&(r=n[e]);return{min:o,mid:(o+r)/2,max:r,size:r-o}},align:function(t,e){const i=e.p1.x,s=e.p1.y,r=-a(e.p2.y-s,e.p2.x-i);return t.map((function(t){return{x:(t.x-i)*n(r)-(t.y-s)*o(r),y:(t.x-i)*o(r)+(t.y-s)*n(r)}}))},roots:function(t,e){e=e||{p1:{x:0,y:0},p2:{x:1,y:0}};const i=t.length-1,s=g.align(t,e),o=function(t){return 0<=t&&t<=1};if(2===i){const t=s[0].y,e=s[1].y,i=s[2].y,n=t-2*e+i;if(0!==n){const s=-h(e*e-t*i),r=-t+e;return[-(s+r)/n,-(-s+r)/n].filter(o)}return e!==i&&0===n?[(2*e-i)/(2*e-2*i)].filter(o):[]}const a=s[0].y,p=s[1].y,c=s[2].y;let f=3*p-a-3*c+s[3].y,d=3*a-6*p+3*c,y=-3*a+3*p,x=a;if(g.approximately(f,0)){if(g.approximately(d,0))return g.approximately(y,0)?[]:[-x/y].filter(o);const t=h(y*y-4*d*x),e=2*d;return[(t-y)/e,(-y-t)/e].filter(o)}d/=f,y/=f,x/=f;const m=(3*y-d*d)/3,b=m/3,w=(2*d*d*d-9*d*y+27*x)/27,_=w/2,v=_*_+b*b*b;let k,P,z,M,R;if(v<0){const t=-m/3,e=h(t*t*t),i=-w/(2*e),s=r(i<-1?-1:i>1?1:i),a=2*l(e);return z=a*n(s/3)-d/3,M=a*n((s+u)/3)-d/3,R=a*n((s+2*u)/3)-d/3,[z,M,R].filter(o)}if(0===v)return k=_<0?l(-_):-l(_),z=2*k-d/3,M=-k-d/3,[z,M].filter(o);{const t=h(v);return k=l(-_+t),P=l(_+t),[k-P-d/3].filter(o)}},droots:function(t){if(3===t.length){const e=t[0],i=t[1],s=t[2],n=e-2*i+s;if(0!==n){const t=-h(i*i-e*s),o=-e+i;return[-(t+o)/n,-(-t+o)/n]}return i!==s&&0===n?[(2*i-s)/(2*(i-s))]:[]}if(2===t.length){const e=t[0],i=t[1];return e!==i?[e/(e-i)]:[]}return[]},curvature:function(t,e,i,n,o){let r,a,l,c,u=0,f=0;const d=g.compute(t,e),y=g.compute(t,i),x=d.x*d.x+d.y*d.y;if(n?(r=h(p(d.y*y.z-y.y*d.z,2)+p(d.z*y.x-y.z*d.x,2)+p(d.x*y.y-y.x*d.y,2)),a=p(x+d.z*d.z,1.5)):(r=d.x*y.y-d.y*y.x,a=p(x,1.5)),0===r||0===a)return{k:0,r:0};if(u=r/a,f=a/r,!o){const o=g.curvature(t-.001,e,i,n,!0).k,r=g.curvature(t+.001,e,i,n,!0).k;c=(r-u+(u-o))/2,l=(s(r-u)+s(u-o))/2}return{k:u,r:f,dk:c,adk:l}},inflections:function(t){if(t.length<4)return[];const e=g.align(t,{p1:t[0],p2:t.slice(-1)[0]}),i=e[2].x*e[1].y,s=e[3].x*e[1].y,n=e[1].x*e[2].y,o=18*(-3*i+2*s+3*n-e[3].x*e[2].y),r=18*(3*i-s-3*n),a=18*(n-i);if(g.approximately(o,0)){if(!g.approximately(r,0)){let t=-a/r;if(0<=t&&t<=1)return[t]}return[]}const h=r*r-4*o*a,p=Math.sqrt(h),l=2*o;return g.approximately(l,0)?[]:[(p-r)/l,-(r+p)/l].filter((function(t){return 0<=t&&t<=1}))},bboxoverlap:function(t,e){const i=["x","y"],n=i.length;for(let o,r,a,h,p=0;p<n;p++)if(o=i[p],r=t[o].mid,a=e[o].mid,h=(t[o].size+e[o].size)/2,s(r-a)>=h)return!1;return!0},expandbox:function(t,e){e.x.min<t.x.min&&(t.x.min=e.x.min),e.y.min<t.y.min&&(t.y.min=e.y.min),e.z&&e.z.min<t.z.min&&(t.z.min=e.z.min),e.x.max>t.x.max&&(t.x.max=e.x.max),e.y.max>t.y.max&&(t.y.max=e.y.max),e.z&&e.z.max>t.z.max&&(t.z.max=e.z.max),t.x.mid=(t.x.min+t.x.max)/2,t.y.mid=(t.y.min+t.y.max)/2,t.z&&(t.z.mid=(t.z.min+t.z.max)/2),t.x.size=t.x.max-t.x.min,t.y.size=t.y.max-t.y.min,t.z&&(t.z.size=t.z.max-t.z.min)},pairiteration:function(t,e,i){const s=t.bbox(),n=e.bbox(),o=1e5,r=i||.5;if(s.x.size+s.y.size<r&&n.x.size+n.y.size<r)return[(o*(t._t1+t._t2)/2|0)/o+"/"+(o*(e._t1+e._t2)/2|0)/o];let a=t.split(.5),h=e.split(.5),p=[{left:a.left,right:h.left},{left:a.left,right:h.right},{left:a.right,right:h.right},{left:a.right,right:h.left}];p=p.filter((function(t){return g.bboxoverlap(t.left.bbox(),t.right.bbox())}));let l=[];return 0===p.length||(p.forEach((function(t){l=l.concat(g.pairiteration(t.left,t.right,r))})),l=l.filter((function(t,e){return l.indexOf(t)===e}))),l},getccenter:function(t,e,i){const s=e.x-t.x,r=e.y-t.y,h=i.x-e.x,p=i.y-e.y,l=s*n(f)-r*o(f),c=s*o(f)+r*n(f),d=h*n(f)-p*o(f),y=h*o(f)+p*n(f),x=(t.x+e.x)/2,m=(t.y+e.y)/2,b=(e.x+i.x)/2,w=(e.y+i.y)/2,_=x+l,v=m+c,k=b+d,P=w+y,z=g.lli8(x,m,_,v,b,w,k,P),M=g.dist(z,t);let R,$=a(t.y-z.y,t.x-z.x),L=a(e.y-z.y,e.x-z.x),C=a(i.y-z.y,i.x-z.x);return $<C?(($>L||L>C)&&($+=u),$>C&&(R=C,C=$,$=R)):C<L&&L<$?(R=C,C=$,$=R):C+=u,z.s=$,z.e=C,z.r=M,z},numberSort:function(t,e){return t-e}};class m{constructor(t){this.curves=[],this._3d=!1,t&&(this.curves=t,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map((function(t){return g.pointsToString(t.points)})).join(", ")+"]"}addCurve(t){this.curves.push(t),this._3d=this._3d||t._3d}length(){return this.curves.map((function(t){return t.length()})).reduce((function(t,e){return t+e}))}curve(t){return this.curves[t]}bbox(){const t=this.curves;for(var e=t[0].bbox(),i=1;i<t.length;i++)g.expandbox(e,t[i].bbox());return e}offset(t){const e=[];return this.curves.forEach((function(i){e.push(...i.offset(t))})),new m(e)}}const{abs:b,min:w,max:_,cos:v,sin:k,acos:P,sqrt:z}=Math,M=Math.PI;class R{constructor(t){let e=t&&t.forEach?t:Array.from(arguments).slice(),i=!1;if("object"==typeof e[0]){i=e.length;const t=[];e.forEach((function(e){["x","y","z"].forEach((function(i){void 0!==e[i]&&t.push(e[i])}))})),e=t}let s=!1;const n=e.length;if(i){if(i>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");s=!0}}else if(6!==n&&8!==n&&9!==n&&12!==n&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const o=this._3d=!s&&(9===n||12===n)||t&&t[0]&&void 0!==t[0].z,r=this.points=[];for(let t=0,i=o?3:2;t<n;t+=i){var a={x:e[t],y:e[t+1]};o&&(a.z=e[t+2]),r.push(a)}const h=this.order=r.length-1,p=this.dims=["x","y"];o&&p.push("z"),this.dimlen=p.length;const l=g.align(r,{p1:r[0],p2:r[h]});this._linear=!l.some((t=>b(t.y)>1e-4)),this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(t,e,i,s){if(void 0===s&&(s=.5),0===s)return new R(e,e,i);if(1===s)return new R(t,e,e);const n=R.getABC(2,t,e,i,s);return new R(t,n.A,i)}static cubicFromPoints(t,e,i,s,n){void 0===s&&(s=.5);const o=R.getABC(3,t,e,i,s);void 0===n&&(n=g.dist(e,o.C));const r=n*(1-s)/s,a=g.dist(t,i),h=(i.x-t.x)/a,p=(i.y-t.y)/a,l=n*h,c=n*p,u=r*h,f=r*p,d=e.x-l,y=e.y-c,x=e.x+u,m=e.y+f,b=o.A,w=b.x+(d-b.x)/(1-s),_=b.y+(y-b.y)/(1-s),v=b.x+(x-b.x)/s,k=b.y+(m-b.y)/s,P={x:t.x+(w-t.x)/s,y:t.y+(_-t.y)/s},z={x:i.x+(v-i.x)/(1-s),y:i.y+(k-i.y)/(1-s)};return new R(t,P,z,i)}static getUtils(){return g}getUtils(){return R.getUtils()}static get PolyBezier(){return m}valueOf(){return this.toString()}toString(){return g.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const t=this.points,e=["M",t[0].x,t[0].y,2===this.order?"Q":"C"];for(let i=1,s=t.length;i<s;i++)e.push(t[i].x),e.push(t[i].y);return e.join(" ")}setRatios(t){if(t.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=t,this._lut=[]}verify(){const t=this.coordDigest();t!==this._print&&(this._print=t,this.update())}coordDigest(){return this.points.map((function(t,e){return""+e+t.x+t.y+(t.z?t.z:0)})).join("")}update(){this._lut=[],this.dpoints=g.derive(this.points,this._3d),this.computedirection()}computedirection(){const t=this.points,e=g.angle(t[0],t[this.order],t[1]);this.clockwise=e>0}length(){return g.length(this.derivative.bind(this))}static getABC(t=2,e,i,s,n=.5){const o=g.projectionratio(n,t),r=1-o,a={x:o*e.x+r*s.x,y:o*e.y+r*s.y},h=g.abcratio(n,t);return{A:{x:i.x+(i.x-a.x)/h,y:i.y+(i.y-a.y)/h},B:i,C:a,S:e,E:s}}getABC(t,e){e=e||this.get(t);let i=this.points[0],s=this.points[this.order];return R.getABC(this.order,i,e,s,t)}getLUT(t){if(this.verify(),t=t||100,this._lut.length===t)return this._lut;this._lut=[],t--;for(let e,i,s=0;s<t;s++)i=s/(t-1),e=this.compute(i),e.t=i,this._lut.push(e);return this._lut}on(e,i){i=i||5;const s=this.getLUT(),n=[];for(let t,o=0,r=0;o<s.length;o++)t=s[o],g.dist(t,e)<i&&(n.push(t),r+=o/s.length);return!!n.length&&(t/=n.length)}project(t){const e=this.getLUT(),i=e.length-1,s=g.closest(e,t),n=s.mpos,o=(n-1)/i,r=(n+1)/i,a=.1/i;let h,p,l=s.mdist,c=o,u=c;for(l+=1;c<r+a;c+=a)h=this.compute(c),p=g.dist(t,h),p<l&&(l=p,u=c);return u=u<0?0:u>1?1:u,h=this.compute(u),h.t=u,h.d=l,h}get(t){return this.compute(t)}point(t){return this.points[t]}compute(t){return this.ratios?g.computeWithRatios(t,this.points,this.ratios,this._3d):g.compute(t,this.points,this._3d,this.ratios)}raise(){const t=this.points,e=[t[0]],i=t.length;for(let s,n,o=1;o<i;o++)s=t[o],n=t[o-1],e[o]={x:(i-o)/i*s.x+o/i*n.x,y:(i-o)/i*s.y+o/i*n.y};return e[i]=t[i-1],new R(e)}derivative(t){return g.compute(t,this.dpoints[0],this._3d)}dderivative(t){return g.compute(t,this.dpoints[1],this._3d)}align(){let t=this.points;return new R(g.align(t,{p1:t[0],p2:t[t.length-1]}))}curvature(t){return g.curvature(t,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return g.inflections(this.points)}normal(t){return this._3d?this.__normal3(t):this.__normal2(t)}__normal2(t){const e=this.derivative(t),i=z(e.x*e.x+e.y*e.y);return{x:-e.y/i,y:e.x/i}}__normal3(t){const e=this.derivative(t),i=this.derivative(t+.01),s=z(e.x*e.x+e.y*e.y+e.z*e.z),n=z(i.x*i.x+i.y*i.y+i.z*i.z);e.x/=s,e.y/=s,e.z/=s,i.x/=n,i.y/=n,i.z/=n;const o={x:i.y*e.z-i.z*e.y,y:i.z*e.x-i.x*e.z,z:i.x*e.y-i.y*e.x},r=z(o.x*o.x+o.y*o.y+o.z*o.z);o.x/=r,o.y/=r,o.z/=r;const a=[o.x*o.x,o.x*o.y-o.z,o.x*o.z+o.y,o.x*o.y+o.z,o.y*o.y,o.y*o.z-o.x,o.x*o.z-o.y,o.y*o.z+o.x,o.z*o.z];return{x:a[0]*e.x+a[1]*e.y+a[2]*e.z,y:a[3]*e.x+a[4]*e.y+a[5]*e.z,z:a[6]*e.x+a[7]*e.y+a[8]*e.z}}hull(t){let e=this.points,i=[],s=[],n=0;for(s[n++]=e[0],s[n++]=e[1],s[n++]=e[2],3===this.order&&(s[n++]=e[3]);e.length>1;){i=[];for(let o,r=0,a=e.length-1;r<a;r++)o=g.lerp(t,e[r],e[r+1]),s[n++]=o,i.push(o);e=i}return s}split(t,e){if(0===t&&e)return this.split(e).left;if(1===e)return this.split(t).right;const i=this.hull(t),s={left:2===this.order?new R([i[0],i[3],i[5]]):new R([i[0],i[4],i[7],i[9]]),right:2===this.order?new R([i[5],i[4],i[2]]):new R([i[9],i[8],i[6],i[3]]),span:i};return s.left._t1=g.map(0,0,1,this._t1,this._t2),s.left._t2=g.map(t,0,1,this._t1,this._t2),s.right._t1=g.map(t,0,1,this._t1,this._t2),s.right._t2=g.map(1,0,1,this._t1,this._t2),e?(e=g.map(e,t,1,0,1),s.right.split(e).left):s}extrema(){const t={};let e=[];return this.dims.forEach(function(i){let s=function(t){return t[i]},n=this.dpoints[0].map(s);t[i]=g.droots(n),3===this.order&&(n=this.dpoints[1].map(s),t[i]=t[i].concat(g.droots(n))),t[i]=t[i].filter((function(t){return t>=0&&t<=1})),e=e.concat(t[i].sort(g.numberSort))}.bind(this)),t.values=e.sort(g.numberSort).filter((function(t,i){return e.indexOf(t)===i})),t}bbox(){const t=this.extrema(),e={};return this.dims.forEach(function(i){e[i]=g.getminmax(this,i,t[i])}.bind(this)),e}overlaps(t){const e=this.bbox(),i=t.bbox();return g.bboxoverlap(e,i)}offset(t,e){if(void 0!==e){const i=this.get(t),s=this.normal(t),n={c:i,n:s,x:i.x+s.x*e,y:i.y+s.y*e};return this._3d&&(n.z=i.z+s.z*e),n}if(this._linear){const e=this.normal(0),i=this.points.map((function(i){const s={x:i.x+t*e.x,y:i.y+t*e.y};return i.z&&e.z&&(s.z=i.z+t*e.z),s}));return[new R(i)]}return this.reduce().map((function(e){return e._linear?e.offset(t)[0]:e.scale(t)}))}simple(){if(3===this.order){const t=g.angle(this.points[0],this.points[3],this.points[1]),e=g.angle(this.points[0],this.points[3],this.points[2]);if(t>0&&e<0||t<0&&e>0)return!1}const t=this.normal(0),e=this.normal(1);let i=t.x*e.x+t.y*e.y;return this._3d&&(i+=t.z*e.z),b(P(i))<M/3}reduce(){let t,e,i=0,s=0,n=.01,o=[],r=[],a=this.extrema().values;for(-1===a.indexOf(0)&&(a=[0].concat(a)),-1===a.indexOf(1)&&a.push(1),i=a[0],t=1;t<a.length;t++)s=a[t],e=this.split(i,s),e._t1=i,e._t2=s,o.push(e),i=s;return o.forEach((function(t){for(i=0,s=0;s<=1;)for(s=i+n;s<=1.01;s+=n)if(e=t.split(i,s),!e.simple()){if(s-=n,b(i-s)<n)return[];e=t.split(i,s),e._t1=g.map(i,0,1,t._t1,t._t2),e._t2=g.map(s,0,1,t._t1,t._t2),r.push(e),i=s;break}i<1&&(e=t.split(i,1),e._t1=g.map(i,0,1,t._t1,t._t2),e._t2=t._t2,r.push(e))})),r}scale(t){const e=this.order;let i=!1;if("function"==typeof t&&(i=t),i&&2===e)return this.raise().scale(i);const s=this.clockwise,n=i?i(0):t,o=i?i(1):t,r=[this.offset(0,10),this.offset(1,10)],a=this.points,h=[],p=g.lli4(r[0],r[0].c,r[1],r[1].c);if(!p)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach((function(t){const i=h[t*e]=g.copy(a[t*e]);i.x+=(t?o:n)*r[t].n.x,i.y+=(t?o:n)*r[t].n.y})),i?([0,1].forEach((function(n){if(2!==e||!n){var o=a[n+1],r={x:o.x-p.x,y:o.y-p.y},l=i?i((n+1)/e):t;i&&!s&&(l=-l);var c=z(r.x*r.x+r.y*r.y);r.x/=c,r.y/=c,h[n+1]={x:o.x+l*r.x,y:o.y+l*r.y}}})),new R(h)):([0,1].forEach((t=>{if(2===e&&t)return;const i=h[t*e],s=this.derivative(t),n={x:i.x+s.x,y:i.y+s.y};h[t+1]=g.lli4(i,n,p,a[t+1])})),new R(h))}outline(t,e,i,s){e=void 0===e?t:e;const n=this.reduce(),o=n.length,r=[];let a,h=[],p=0,l=this.length();const c=void 0!==i&&void 0!==s;function u(t,e,i,s,n){return function(o){const r=s/i,a=(s+n)/i,h=e-t;return g.map(o,0,1,t+r*h,t+a*h)}}n.forEach((function(n){const o=n.length();c?(r.push(n.scale(u(t,i,l,p,o))),h.push(n.scale(u(-e,-s,l,p,o)))):(r.push(n.scale(t)),h.push(n.scale(-e))),p+=o})),h=h.map((function(t){return a=t.points,a[3]?t.points=[a[3],a[2],a[1],a[0]]:t.points=[a[2],a[1],a[0]],t})).reverse();const f=r[0].points[0],d=r[o-1].points[r[o-1].points.length-1],y=h[o-1].points[h[o-1].points.length-1],x=h[0].points[0],b=g.makeline(y,f),w=g.makeline(d,x),_=[b].concat(r).concat([w]).concat(h);return _.length,new m(_)}outlineshapes(t,e,i){e=e||t;const s=this.outline(t,e).curves,n=[];for(let t=1,e=s.length;t<e/2;t++){const o=g.makeshape(s[t],s[e-t],i);o.startcap.virtual=t>1,o.endcap.virtual=t<e/2-1,n.push(o)}return n}intersects(t,e){return t?t.p1&&t.p2?this.lineIntersects(t):(t instanceof R&&(t=t.reduce()),this.curveintersects(this.reduce(),t,e)):this.selfintersects(e)}lineIntersects(t){const e=w(t.p1.x,t.p2.x),i=w(t.p1.y,t.p2.y),s=_(t.p1.x,t.p2.x),n=_(t.p1.y,t.p2.y);return g.roots(this.points,t).filter((t=>{var o=this.get(t);return g.between(o.x,e,s)&&g.between(o.y,i,n)}))}selfintersects(t){const e=this.reduce(),i=e.length-2,s=[];for(let n,o,r,a=0;a<i;a++)o=e.slice(a,a+1),r=e.slice(a+2),n=this.curveintersects(o,r,t),s.push(...n);return s}curveintersects(t,e,i){const s=[];t.forEach((function(t){e.forEach((function(e){t.overlaps(e)&&s.push({left:t,right:e})}))}));let n=[];return s.forEach((function(t){const e=g.pairiteration(t.left,t.right,i);e.length>0&&(n=n.concat(e))})),n}arcs(t){return t=t||.5,this._iterate(t,[])}_error(t,e,i,s){const n=(s-i)/4,o=this.get(i+n),r=this.get(s-n),a=g.dist(t,e),h=g.dist(t,o),p=g.dist(t,r);return b(h-a)+b(p-a)}_iterate(t,e){let i,s=0,n=1;do{i=0,n=1;let o,r,a,h,p,l=this.get(s),c=!1,u=!1,f=n,d=1;do{if(u=c,h=a,f=(s+n)/2,o=this.get(f),r=this.get(n),a=g.getccenter(l,o,r),a.interval={start:s,end:n},c=this._error(a,l,s,n)<=t,p=u&&!c,p||(d=n),c){if(n>=1){if(a.interval.end=d=1,h=a,n>1){let t={x:a.x+a.r*v(a.e),y:a.y+a.r*k(a.e)};a.e+=g.angle({x:a.x,y:a.y},t,this.get(1))}break}n+=(n-s)/2}else n=f}while(!p&&i++<100);if(i>=100)break;h=h||a,e.push(h),s=d}while(n<1);return e}}function $(t=!1){this.render=!0,this.topLeft=!1,this.bottomRight=!1,this.attributes=new e,this.ops=[],Object.defineProperty(this,"debug",{value:t,configurable:!0})}function L(t,e,i,s=!1,n=!1){if(t.x===e.x&&t.y===e.y)return!1;let o=t.angle(e)-90;return new $(s).withRaise(n).move(t.shift(o,i)).line(e.shift(o,i))}function C(t,e=!1,s=!1){return new $(e).withRaise(s).move(new i(t.points[0].x,t.points[0].y)).curve(new i(t.points[1].x,t.points[1].y),new i(t.points[2].x,t.points[2].y),new i(t.points[3].x,t.points[3].y))}function T(t,e=!1,i=!1){let s,n=new $(t[0].debug).withRaise(t[0].raise).move(t[0].ops[0].to);for(let e of t)for(let t of e.ops){if("curve"===t.type)n.curve(t.cp1,t.cp2,t.to);else{if("close"===t.type){let t="Cannot join a closed path with another";throw n.raise.error(t),new Error(t)}s&&!t.to.sitsRoughlyOn(s)&&n.line(t.to)}t.to&&(s=t.to)}return e&&n.close(),n}function O(t,e,s=100){let n,o,r,a,h=0;for(let p=0;p<=s;p++){if(r=p/s,o=e.get(r),o=new i(o.x,o.y),p>0){if(a=o.dist(n),h+a>t)return o;h+=a}n=o}}function I(t){let e=t.from,s=t.to;return e.x===s.x?e.y<s.y?{topLeft:e,bottomRight:s}:{topLeft:s,bottomRight:e}:e.y===s.y?e.x<s.x?{topLeft:e,bottomRight:s}:{topLeft:s,bottomRight:e}:e.x<s.x?e.y<s.y?{topLeft:e,bottomRight:s}:{topLeft:new i(e.x,s.y),bottomRight:new i(s.x,e.y)}:e.x>s.x?e.y<s.y?{topLeft:new i(s.x,e.y),bottomRight:new i(e.x,s.y)}:{topLeft:new i(s.x,s.y),bottomRight:new i(e.x,e.y)}:void 0}function j(t){let e=t.bbox();return{topLeft:new i(e.x.min,e.y.min),bottomRight:new i(e.x.max,e.y.max)}}function A(t,e){if(t&&"object"==typeof t)if("number"==typeof t.x)e.push(t);else for(let i of t)e.push(i)}function S(t){return t.charAt(0).toUpperCase()+t.slice(1)}function B(t){return t==t&&"number"==typeof t}function F(t){return`_macro_${t}`}function E(t,e,s,n){let o=t.slope(e),r=s.slope(n);if(o===r)return!1;if(t.x===e.x)return new i(t.x,r*t.x+(s.y-r*s.x));if(s.x===n.x)return new i(s.x,o*s.x+(t.y-o*t.x));{t.x>e.x&&(t=e.copy()),s.x>n.x&&(s=n.copy());let a=t.y-o*t.x,h=(s.y-r*s.x-a)/(o-r);return new i(h,o*h+a)}}function N(t,e,i,s){let n=E(t,e,i,s);if(!n)return!1;let o=t.dist(e),r=i.dist(s),a=t.dist(n)+n.dist(e),h=i.dist(n)+n.dist(s);return Math.round(o)==Math.round(a)&&Math.round(r)==Math.round(h)&&n}function D(t,e,i,s=1e6){if(t.sitsOn(i))return!0;if(e.sitsOn(i))return!0;let n=i.dx(t)*e.dy(t)-i.dy(t)*e.dx(t);return 0===Math.abs(Math.round(n*s)/s)}function H(t,e,i,s=1e6){if(!D(t,e,i,s))return!1;let n=t.dist(e),o=t.dist(i)+i.dist(e);return Math.round(n)==Math.round(o)}function G(t,e,i,s,n){if(t.sitsOn(n))return!0;if(s.sitsOn(n))return!0;let o=new R({x:t.x,y:t.y},{x:e.x,y:e.y},{x:i.x,y:i.y},{x:s.x,y:s.y}),r=o.intersects({p1:{x:n.x-1,y:n.y},p2:{x:n.x+1,y:n.y}});return 0===r.length&&(r=o.intersects({p1:{x:n.x,y:n.y-1},p2:{x:n.x,y:n.y+1}})),r.length>0&&r.shift()}function X(t,e="metric"){return"imperial"===e?V(t/25.4)+"&quot;":V(t/10)+"cm"}function U(t,e,s,n,o,r){let a=[],h=new R({x:s.x,y:s.y},{x:n.x,y:n.y},{x:o.x,y:o.y},{x:r.x,y:r.y}),p={p1:{x:t.x,y:t.y},p2:{x:e.x,y:e.y}};for(let t of h.intersects(p)){let e=h.get(t);a.push(new i(e.x,e.y))}return 0!==a.length&&(1===a.length?a[0]:a)}function Y(t,e,s,n,o,r,a,h){let p=[],l=new R({x:t.x,y:t.y},{x:e.x,y:e.y},{x:s.x,y:s.y},{x:n.x,y:n.y}),c=new R({x:o.x,y:o.y},{x:r.x,y:r.y},{x:a.x,y:a.y},{x:h.x,y:h.y});for(let t of l.intersects(c,.005)){let e=l.get(t.substr(0,t.indexOf("/")));p.push(new i(e.x,e.y))}if(0===p.length)return!1;if(1===p.length)return p.shift();{let t=[];for(let e of p){let i=!1;for(let s of t)e.sitsRoughlyOn(s)&&(i=!0);i||t.push(e)}return t}}function q(t,e,s,n,o="x"){let r=n.x-s.x,a=n.y-s.y,h=Math.pow(r,2)+Math.pow(a,2),p=2*(r*(s.x-t.x)+a*(s.y-t.y)),l=Math.pow(s.x-t.x,2)+Math.pow(s.y-t.y,2)-Math.pow(e,2),c=Math.pow(p,2)-4*h*l;if(h<=1e-7||c<0)return!1;if(0===c){let t=-1*p/(2*h);return[new i(s.x+t*r,s.y+t*a)]}{let t=(-1*p+Math.sqrt(c))/(2*h),e=new i(s.x+t*r,s.y+t*a);t=(-1*p-Math.sqrt(c))/(2*h);let n=new i(s.x+t*r,s.y+t*a);return"x"===o&&e.x<=n.x||"y"===o&&e.y<=n.y?[e,n]:[n,e]}}function J(t,e,s=500){let n,o=1/0,r=1/0;"bottom"===e&&(r=-1/0),"right"===e&&(o=-1/0);for(let i=0;i<s;i++)n=t.get(i/s),("top"===e&&n.y<r||"bottom"===e&&n.y>r||"right"===e&&n.x>o||"left"===e&&n.x<o)&&(o=n.x,r=n.y);return new i(o,r)}function V(t){return Math.round(100*t)/100}function W(t,e,i=!1){return i&&Array.isArray(i)&&i.length>0?i[t%i.length]:`stroke: hsl(${330/e*(t-1)}, 100%, 35%);`}$.prototype.withRaise=function(t=!1){return t&&Object.defineProperty(this,"raise",{value:t}),this},$.prototype.setRender=function(t=!0){return this.render=!!t,this.debug&&this.raise.debug("Setting `Path.render` to "+(t?"`true`":"`false`")),this},$.prototype.move=function(t){return this.debug&&t instanceof i!=!0&&this.raise.warning("Called `Path.rotate(to)` but `to` is not a `Point` object"),this.ops.push({type:"move",to:t}),this},$.prototype.line=function(t){return this.debug&&t instanceof i!=!0&&this.raise.warning("Called `Path.line(to)` but `to` is not a `Point` object"),this.ops.push({type:"line",to:t}),this},$.prototype.curve=function(t,e,s){return this.debug&&(s instanceof i!=!0&&this.raise.warning("Called `Path.curve(cp1, cp2, to)` but `to` is not a `Point` object"),t instanceof i!=!0&&this.raise.warning("Called `Path.curve(cp1, cp2, to)` but `cp1` is not a `Point` object"),e instanceof i!=!0&&this.raise.warning("Called `Path.curve(cp1, cp2, to)` but `cp2` is not a `Point` object")),this.ops.push({type:"curve",cp1:t,cp2:e,to:s}),this},$.prototype._curve=function(t,e){this.debug&&(e instanceof i!=!0&&this.raise.warning("Called `Path._curve(cp2, to)` but `to` is not a `Point` object"),t instanceof i!=!0&&this.raise.warning("Called `Path._curve(cp2, to)` but `cp2` is not a `Point` object"));let s=this.ops.slice(-1).pop().to;return this.ops.push({type:"curve",cp1:s,cp2:t,to:e}),this},$.prototype.curve_=function(t,e){this.debug&&(e instanceof i!=!0&&this.raise.warning("Called `Path.curve_(cp1, to)` but `to` is not a `Point` object"),t instanceof i!=!0&&this.raise.warning("Called `Path.curve_(cp1, to)` but `cp2` is not a `Point` object"));let s=e.copy();return this.ops.push({type:"curve",cp1:t,cp2:s,to:e}),this},$.prototype.close=function(){return this.ops.push({type:"close"}),this},$.prototype.noop=function(t=!1){return this.ops.push({type:"noop",id:t}),this},$.prototype.insop=function(t,e){this.debug&&(t||this.raise.warning("Called `Path.insop(noopId, path)` but `noopId` is undefined or false"),e instanceof $!=!0&&this.raise.warning("Called `Path.insop(noopId, path) but `path` is not a `Path` object"));let i=this.clone();for(let s in i.ops)"noop"===i.ops[s].type&&i.ops[s].id===t&&(i.ops=i.ops.slice(0,s).concat(e.ops).concat(i.ops.slice(Number(s)+1)));return i},$.prototype.attr=function(t,e,i=!1){return this.debug&&(t||this.raise.warning("Called `Path.attr(name, value, overwrite=false)` but `name` is undefined or false"),void 0===e&&this.raise.warning("Called `Path.attr(name, value, overwrite=false)` but `value` is undefined"),i&&this.raise.debug(`Overwriting \`Path.attribute.${t}\` with ${e} (was: ${this.attributes.get(t)})`)),i?this.attributes.set(t,e):this.attributes.add(t,e),this},$.prototype.asPathstring=function(){let t="";for(let e of this.ops)switch(e.type){case"move":t+=`M ${V(e.to.x)},${V(e.to.y)}`;break;case"line":t+=` L ${V(e.to.x)},${V(e.to.y)}`;break;case"curve":t+=` C ${V(e.cp1.x)},${V(e.cp1.y)} ${V(e.cp2.x)},${V(e.cp2.y)} ${V(e.to.x)},${V(e.to.y)}`;break;case"close":t+=" z"}return t},$.prototype.offset=function(t){return"number"!=typeof t&&this.raise.error("Called `Path.offset(distance)` but `distance` is not a number"),function(t,e,i){let s,n=[],o=!1;for(let i in t.ops){let r=t.ops[i];if("line"===r.type){let i=L(s,r.to,e,t.debug,t.raise);i&&n.push(i)}else if("curve"===r.type){let i,o;i=s.sitsRoughlyOn(r.cp1)?new $(t.debug).withRaise(t.raise).move(s).curve(r.cp1,r.cp2,r.to).shiftAlong(2):r.cp1,o=r.cp2.sitsRoughlyOn(r.to)?new $(t.debug).withRaise(t.raise).move(r.to).curve(r.cp2,r.cp1,s).shiftAlong(2):r.cp2;let a=new R({x:s.x,y:s.y},{x:i.x,y:i.y},{x:o.x,y:o.y},{x:r.to.x,y:r.to.y});for(let i of a.offset(e))n.push(C(i,t.debug,t.raise))}else"close"===r.type&&(o=!0);r.to&&(s=r.to)}return T(n,o,i)}(this,t,this.raise)},$.prototype.length=function(){let t,e,i=0;for(let s in this.ops){let n=this.ops[s];"move"===n.type?e=n.to:"line"===n.type?i+=t.dist(n.to):"curve"===n.type?i+=new R({x:t.x,y:t.y},{x:n.cp1.x,y:n.cp1.y},{x:n.cp2.x,y:n.cp2.y},{x:n.to.x,y:n.to.y}).length():"close"===n.type&&(i+=t.dist(e)),n.to&&(t=n.to)}return i},$.prototype.start=function(){return(this.ops.length<1||void 0===this.ops[0].to)&&this.raise.error("Called `Path.start()` but this path has no drawing operations"),this.ops[0].to},$.prototype.end=function(){this.ops.length<1&&this.raise.error("Called `Path.end()` but this path has no drawing operations");let t=this.ops[this.ops.length-1];return"close"===t.type?this.start():t.to},$.prototype.boundary=function(){if(this.topLeft)return this;let t,e=new i(1/0,1/0),s=new i(-1/0,-1/0),n=[];for(let i in this.ops){let o=this.ops[i];if("move"===o.type||"line"===o.type)o.to.x<e.x&&(e.x=o.to.x,n.leftOp=i),o.to.y<e.y&&(e.y=o.to.y,n.topOp=i),o.to.x>s.x&&(s.x=o.to.x,n.rightOp=i),o.to.y>s.y&&(s.y=o.to.y,n.bottomOp=i);else if("curve"===o.type){let r=new R({x:t.x,y:t.y},{x:o.cp1.x,y:o.cp1.y},{x:o.cp2.x,y:o.cp2.y},{x:o.to.x,y:o.to.y}).bbox();r.x.min<e.x&&(e.x=r.x.min,n.leftOp=i),r.y.min<e.y&&(e.y=r.y.min,n.topOp=i),r.x.max>s.x&&(s.x=r.x.max,n.rightOp=i),r.y.max>s.y&&(s.y=r.y.max,n.bottomOp=i)}o.to&&(t=o.to)}this.topLeft=e,this.bottomRight=s;for(let t of["top","left","bottom","right"]){let e=t+"Op";this[e]=this.ops[n[e]],this[e].from="move"===this[e].type?this[e].to:this.ops[n[e]-1].to}return this},$.prototype.clone=function(){let t=new $(this.debug).withRaise(this.raise).setRender(this.render);this.topLeft?t.topLeft=this.topLeft.clone():t.topLeft=!1,this.bottomRight?t.bottomRight=this.bottomRight.clone():t.bottomRight=!1,t.attributes=this.attributes.clone(),t.ops=[];for(let e in this.ops){let i=this.ops[e];t.ops[e]={type:i.type},"move"===i.type||"line"===i.type?t.ops[e].to=i.to.clone():"curve"===i.type?(t.ops[e].to=i.to.clone(),t.ops[e].cp1=i.cp1.clone(),t.ops[e].cp2=i.cp2.clone()):"noop"===i.type&&(t.ops[e].id=i.id)}return t},$.prototype.join=function(t,e=!1){return t instanceof $!=!0&&this.raise.error("Called `Path.join(that)` but `that` is not a `Path` object"),T([this,t],e,this.raise)},$.prototype.shiftAlong=function(t,e=25){"number"!=typeof t&&this.raise.error("Called `Path.shiftAlong(distance)` but `distance` is not a number");let i,s=0;for(let n in this.ops){let o=this.ops[n];if("line"===o.type){let e=o.to.dist(i);if(Math.abs(s+e-t)<.1)return o.to;if(s+e>t)return i.shiftTowards(o.to,t-s);s+=e}else if("curve"===o.type){let n=new R({x:i.x,y:i.y},{x:o.cp1.x,y:o.cp1.y},{x:o.cp2.x,y:o.cp2.y},{x:o.to.x,y:o.to.y}),r=n.length();if(Math.abs(s+r-t)<.1)return o.to;if(s+r>t)return O(t-s,n,r*e);s+=r}i=o.to}this.raise.error(`Called \`Path.shiftAlong(distance)\` with a \`distance\` of \`${t}\` but \`Path.length()\` is only \`${this.length()}\``)},$.prototype.shiftFractionAlong=function(t,e=25){return"number"!=typeof t&&this.raise.error("Called `Path.shiftFractionAlong(fraction)` but `fraction` is not a number"),this.shiftAlong(this.length()*t,e)},$.prototype.bbox=function(){let t,e=[];for(let i in this.ops){let s=this.ops[i];"line"===s.type?e.push(I({from:t,to:s.to})):"curve"===s.type&&e.push(j(new R({x:t.x,y:t.y},{x:s.cp1.x,y:s.cp1.y},{x:s.cp2.x,y:s.cp2.y},{x:s.to.x,y:s.to.y}))),s.to&&(t=s.to)}return function(t){let e=1/0,s=-1/0,n=1/0,o=-1/0;for(let i of t)i.topLeft.x<e&&(e=i.topLeft.x),i.topLeft.y<n&&(n=i.topLeft.y),i.bottomRight.x>s&&(s=i.bottomRight.x),i.bottomRight.y>o&&(o=i.bottomRight.y);return{topLeft:new i(e,n),bottomRight:new i(s,o)}}(e)},$.prototype.reverse=function(){let t,e=[],i=!1;for(let s in this.ops){let n=this.ops[s];"line"===n.type?n.to.sitsOn(t)||e.push(new $(this.debug).withRaise(this.raise).move(n.to).line(t)):"curve"===n.type?e.push(new $(this.debug).withRaise(this.raise).move(n.to).curve(n.cp2,n.cp1,t)):"close"===n.type&&(i=!0),n.to&&(t=n.to)}let s=new $(this.debug).withRaise(this.raise).move(t);for(let t of e.reverse())s.ops.push(t.ops[1]);return i&&s.close(),s},$.prototype.edge=function(t){if(this.boundary(),"topLeft"===t)return this.topLeft;if("bottomRight"===t)return this.bottomRight;if("topRight"===t)return new i(this.bottomRight.x,this.topLeft.y);if("bottomLeft"===t)return new i(this.topLeft.x,this.bottomRight.y);{let i=t+"Op";if("move"===this[i].type)return this[i].to;if("line"===this[i].type){if("top"===t)return this.topOp.to.y<this.topOp.from.y?this.topOp.to:this.topOp.from;if("left"===t)return this.leftOp.to.x<this.leftOp.from.x?this.leftOp.to:this.leftOp.from;if("bottom"===t)return this.bottomOp.to.y>this.bottomOp.from.y?this.bottomOp.to:this.bottomOp.from;if("right"===t)return this.rightOp.to.x>this.rightOp.from.x?this.rightOp.to:this.rightOp.from}else if("curve"===this[i].type){return J((e=this[i],new R({x:e.from.x,y:e.from.y},{x:e.cp1.x,y:e.cp1.y},{x:e.cp2.x,y:e.cp2.y},{x:e.to.x,y:e.to.y})),t)}}var e;this.raise.error(`Unable to find \`Path.edge(side)\` for side ${t}`)},$.prototype.divide=function(){let t,e,i=[];for(let s in this.ops){let n=this.ops[s];"move"===n.type?e=n.to:"line"===n.type?n.to.sitsRoughlyOn(t)||i.push(new $(this.debug).withRaise(this.raise).move(t).line(n.to)):"curve"===n.type?i.push(new $(this.debug).withRaise(this.raise).move(t).curve(n.cp1,n.cp2,n.to)):"close"===n.type&&i.push(new $(this.debug).withRaise(this.raise).move(t).line(e)),n.to&&(t=n.to)}return i},$.prototype.intersectsX=function(t){return"number"!=typeof t&&this.raise.error("Called `Path.intersectsX(x)` but `x` is not a number"),this.intersectsAxis(t,"x")},$.prototype.intersectsY=function(t){return"number"!=typeof t&&this.raise.error("Called `Path.intersectsX(y)` but `y` is not a number"),this.intersectsAxis(t,"y")},$.prototype.intersectsAxis=function(t=!1,e){let s=[],n="x"===e?new i(t,-1e5):new i(-1e4,t),o="x"===e?new i(t,1e5):new i(1e5,t);for(let t of this.divide())"line"===t.ops[1].type?A(N(t.ops[0].to,t.ops[1].to,n,o),s):"curve"===t.ops[1].type&&A(U(n,o,t.ops[0].to,t.ops[1].cp1,t.ops[1].cp2,t.ops[1].to),s);return s},$.prototype.intersects=function(t){this===t&&this.raise.error("You called Path.intersects(path)` but `path` and `this` are the same object");let e=[];for(let i of this.divide())for(let s of t.divide())"line"===i.ops[1].type?"line"===s.ops[1].type?A(N(i.ops[0].to,i.ops[1].to,s.ops[0].to,s.ops[1].to),e):"curve"===s.ops[1].type&&A(U(i.ops[0].to,i.ops[1].to,s.ops[0].to,s.ops[1].cp1,s.ops[1].cp2,s.ops[1].to),e):"curve"===i.ops[1].type&&("line"===s.ops[1].type?A(U(s.ops[0].to,s.ops[1].to,i.ops[0].to,i.ops[1].cp1,i.ops[1].cp2,i.ops[1].to),e):"curve"===s.ops[1].type&&A(Y(i.ops[0].to,i.ops[1].cp1,i.ops[1].cp2,i.ops[1].to,s.ops[0].to,s.ops[1].cp1,s.ops[1].cp2,s.ops[1].to),e));return e},$.prototype.split=function(t){t instanceof i!=!0&&this.raise.error("Called `Path.split(point)` but `point` is not a `Point` object");let e=this.divide(),s=!1,n=!1;for(let o=0;o<e.length;o++){let r=e[o];if("line"===r.ops[1].type)H(r.ops[0].to,r.ops[1].to,t)&&(s=e.slice(0,o),s.push(new $(this.debug).withRaise(this.raise).move(r.ops[0].to).line(t)),o++,n=e.slice(o),n.unshift(new $(this.debug).withRaise(this.raise).move(t).line(r.ops[1].to)));else if("curve"===r.ops[1].type){let a=G(r.ops[0].to,r.ops[1].cp1,r.ops[1].cp2,r.ops[1].to,t);if(!1!==a){let t=new R({x:r.ops[0].to.x,y:r.ops[0].to.y},{x:r.ops[1].cp1.x,y:r.ops[1].cp1.y},{x:r.ops[1].cp2.x,y:r.ops[1].cp2.y},{x:r.ops[1].to.x,y:r.ops[1].to.y}).split(a);s=e.slice(0,o),s.push(new $(this.debug).withRaise(this.raise).move(new i(t.left.points[0].x,t.left.points[0].y)).curve(new i(t.left.points[1].x,t.left.points[1].y),new i(t.left.points[2].x,t.left.points[2].y),new i(t.left.points[3].x,t.left.points[3].y))),o++,n=e.slice(o),n.unshift(new $(this.debug).withRaise(this.raise).move(new i(t.right.points[0].x,t.right.points[0].y)).curve(new i(t.right.points[1].x,t.right.points[1].y),new i(t.right.points[2].x,t.right.points[2].y),new i(t.right.points[3].x,t.right.points[3].y)))}}}return s&&(s=T(s,!1,this.raise)),n&&(n=T(n,!1,this.raise)),[s,n]},$.prototype.trim=function(){let t=this.divide();for(let e=0;e<t.length;e++){let s=parseInt(e)+2,n=parseInt(t.length)-1;for(let o=s;o<n;o++){let s=t[e].intersects(t[o]);if(s.length>0){let n,r=s.pop(),a=t.slice(0,e),h=t.slice(parseInt(o)+1),p=new $(this.debug).withRaise(this.raise),l=!0;for(let s of[e,o]){let e=t[s].ops;if("line"===e[1].type)p.line(r);else if("curve"===e[1].type){let t,s=new R({x:e[0].to.x,y:e[0].to.y},{x:e[1].cp1.x,y:e[1].cp1.y},{x:e[1].cp2.x,y:e[1].cp2.y},{x:e[1].to.x,y:e[1].to.y}),n=G(e[0].to,e[1].cp1,e[1].cp2,e[1].to,r),o=s.split(n);t=l?o.left:o.right,p.curve(new i(t.points[1].x,t.points[1].y),new i(t.points[2].x,t.points[2].y),new i(t.points[3].x,t.points[3].y))}l=!1}return n=a.length>0?T(a,!1,this.raise).join(p):p,h.length>0&&(n=n.join(T(h,!1,this.raise))),n.trim()}}}return this},$.prototype.translate=function(t,e){this.debug&&("number"!=typeof t&&this.raise.warning("Called `Path.translate(x, y)` but `x` is not a number"),"number"!=typeof e&&this.raise.warning("Called `Path.translate(x, y)` but `y` is not a number"));let i=this.clone();for(let s of i.ops)"close"!==s.type&&(s.to=s.to.translate(t,e)),"curve"===s.type&&(s.cp1=s.cp1.translate(t,e),s.cp2=s.cp2.translate(t,e));return i};var Z=Object.freeze({__proto__:null,capitalize:S,isCoord:B,macroName:F,beamsIntersect:E,linesIntersect:N,pointOnBeam:D,pointOnLine:H,pointOnCurve:G,splitCurve:function(t,e,i,s,n){let[o,r]=(new $).move(t).curve(e,i,s).split(n);return[{start:o.ops[0].to,cp1:o.ops[1].cp1,cp2:o.ops[1].cp2,end:o.ops[1].to},{start:r.ops[0].to,cp1:r.ops[1].cp1,cp2:r.ops[1].cp2,end:r.ops[1].to}]},beamIntersectsX:function(t,e,s){return t.x!==e.x&&E(t,e,new i(s,-10),new i(s,10))},beamIntersectsY:function(t,e,s){return t.y!==e.y&&E(t,e,new i(-10,s),new i(10,s))},units:X,lineIntersectsCurve:U,curveIntersectsX:function(t,e,s,n,o){return U(new i(o,-1e4),new i(o,1e4),t,e,s,n)},curveIntersectsY:function(t,e,s,n,o){return U(new i(-1e4,o),new i(1e4,o),t,e,s,n)},curvesIntersect:Y,circlesIntersect:function(t,e,s,n,o="x"){let r=t.dx(s),a=t.dy(s),h=t.dist(s);if(h>parseFloat(e)+parseFloat(n))return!1;if(h<parseFloat(n)-parseFloat(e))return!1;if(0===h&&e===n)return!1;let p=(Math.pow(e,2)-Math.pow(n,2)+Math.pow(h,2))/(2*h),l=Math.sqrt(Math.pow(e,2)-Math.pow(p,2)),c=t.x+p*r/h,u=t.y+p*a/h,f=new i(c+l*a/h,u-l*r/h),d=new i(c-l*a/h,u+l*r/h);return"x"===o&&f.x<=d.x||"y"===o&&f.y<=d.y?[f,d]:[d,f]},beamIntersectsCircle:q,lineIntersectsCircle:function(t,e,i,s,n="x"){let o=q(t,e,i,s,n);if(!1===o)return!1;if(1===o.length)return!!H(i,s,o[0])&&o;{let t=o[0],e=o[1];if(!H(i,s,t,5)&&!H(i,s,e,5))return!1;if(H(i,s,t,5)&&H(i,s,e,5))return"x"===n&&t.x<=e.x||"y"===n&&t.y<=e.y?[t,e]:[e,t];if(H(i,s,t,5))return[t];if(H(i,s,e,5))return[e]}},curveEdge:J,stretchToScale:function(t){return 1/(1+parseFloat(t))},round:V,sampleStyle:W,deg2rad:function(t){return t*(Math.PI/180)},rad2deg:function(t){return t/Math.PI*180},Bezier:R});function Q(t,i,s=!1){return this.def=t,this.anchor=i,this.attributes=new e,Object.defineProperty(this,"debug",{value:s,configurable:!0}),this}function K(){return{preDraft:[],postDraft:[],preSample:[],postSample:[],preRender:[],postRender:[],insertText:[]}}function tt(){return this.attributes=new e,this.points={},this.paths={},this.snippets={},this.freeId=0,this.topLeft=!1,this.bottomRight=!1,this.width=!1,this.height=!1,this.render=!0,this.utils=Z,this.Point=i,this.Path=$,this.Snippet=Q,this.hooks=new K,this}Q.prototype.withRaise=function(t=!1){return t&&Object.defineProperty(this,"raise",{value:t}),this},Q.prototype.attr=function(t,e,i=!1){return i?this.attributes.set(t,e):this.attributes.add(t,e),this},Q.prototype.clone=function(){let t=new Q(this.def,this.anchor.clone(),this.debug).withRaise(this.raise);return t.attributes=this.attributes.clone(),t},tt.prototype.macroClosure=function(t){let e=this;return function(t,i){let s=F(t);"function"==typeof e[s]&&e[s](i)}},tt.prototype.runHooks=function(t,e=!1){!1===e&&(e=this);let i=this.hooks[t];if(i&&i.length>0)for(let t of i)t.method(e,t.data)},tt.prototype.getId=function(t=""){return this.freeId+=1,t+this.freeId},tt.prototype.unitsClosure=function(t){let e=this;return function(t){return e.context.settings.debug&&"number"!=typeof t&&e.context.raise.debug(`Calling \`units(value)\` but \`value\` is not a number (\`${typeof t}\`)`),X(t,e.context.settings.units)}},tt.prototype.boundary=function(){if(this.topLeft)return this;let t=new i(1/0,1/0),e=new i(-1/0,-1/0);for(let i in this.paths)try{let s=this.paths[i].boundary();s.render&&(s.topLeft.x<t.x&&(t.x=s.topLeft.x),s.topLeft.y<t.y&&(t.y=s.topLeft.y),s.bottomRight.x>e.x&&(e.x=s.bottomRight.x),s.bottomRight.y>e.y&&(e.y=s.bottomRight.y))}catch(t){return this.context.raise.error(`Could not calculate boundary of \`paths.${i}\``),this.context.raise.debug(`Since \`paths.${i}\` has no boundary, neither does \`parts.${this.name}\`. Ejecting part`),!1}for(let i in this.points){let s=this.points[i],n=s.attributes.get("data-circle");n&&(n=parseFloat(n),s.x-n<t.x&&(t.x=s.x-n),s.y-n<t.y&&(t.y=s.y-n),s.x+n>e.x&&(e.x=s.x+n),s.y+n>e.y&&(e.y=s.y+n))}t.x===1/0&&(t.x=0),t.y===1/0&&(t.y=0),e.x===-1/0&&(e.x=0),e.y===-1/0&&(e.y=0);let s=this.context.settings.margin;return this.context.settings.paperless&&s<10&&(s=10),this.topLeft=new i(t.x-s,t.y-s),this.bottomRight=new i(e.x+s,e.y+s),this.width=this.bottomRight.x-this.topLeft.x,this.height=this.bottomRight.y-this.topLeft.y,this},tt.prototype.stack=function(){return!1!==this.topLeft?this:(this.boundary(),0==this.topLeft.x&&0==this.topLeft.y||this.attr("transform",`translate(${-1*this.topLeft.x}, ${-1*this.topLeft.y})`),this)},tt.prototype.attr=function(t,e,i=!1){return i?this.attributes.set(t,e):this.attributes.add(t,e),this},tt.prototype.inject=function(t){const e=e=>{for(let i in t.points)if(t.points[i]===e)return i;return!1};for(let e in t.points)this.points[e]=t.points[e].clone();for(let i in t.paths){this.paths[i]=t.paths[i].clone();for(let s in t.paths[i].ops){let n=t.paths[i].ops[s];if("close"!==n.type){let t=e(n.to);t&&(this.paths[i].ops[s].to=this.points[t])}if("curve"===n.type){let t=e(n.cp1);t&&(this.paths[i].ops[s].cp1=this.points[t]);let o=e(n.cp2);o&&(this.paths[i].ops[s].cp2=this.points[o])}}}for(let e in t.snippets)this.snippets[e]=t.snippets[e].clone();return this},tt.prototype.units=function(t){return X(t,this.context.settings.units)},tt.prototype.shorthand=function(){let t=!!this.context.settings.complete,e=!0===this.context.settings.paperless;const s={sa:this.context.settings.complete&&this.context.settings.sa||0,store:this.context.store,macro:this.macroClosure(),units:this.unitsClosure(),utils:Z,complete:t,paperless:e,events:this.context.events,raise:this.context.raise};if(this.context.settings.debug){let t=this;s.Point=function(e,s){i.apply(this,[e,s,!0]),Object.defineProperty(this,"raise",{value:t.context.raise})},s.Point.prototype=Object.create(i.prototype),s.Path=function(){$.apply(this,[!0]),Object.defineProperty(this,"raise",{value:t.context.raise})},s.Path.prototype=Object.create($.prototype),s.Snippet=function(e,i){Q.apply(this,[e,i,!0]),Q.apply(this,arguments),Object.defineProperty(this,"raise",{value:t.context.raise})},s.Snippet.prototype=Object.create(Q.prototype);const e={get:function(){return Reflect.get(...arguments)},set:(e,s,n)=>{n instanceof i!=!0&&t.context.raise.warning(`\`points.${s}\` was set with a value that is not a \`Point\` object`),null!=n.x&&B(n.x)||t.context.raise.warning(`\`points.${s}\` was set with a \`x\` parameter that is not a \`number\``),null!=n.y&&B(n.y)||t.context.raise.warning(`\`points.${s}\` was set with a \`y\` parameter that is not a \`number\``);try{n.name=s}catch(e){t.context.raise.warning(`Could not set \`name\` property on \`points.${s}\``)}return t.points[s]=n}};s.points=new Proxy(this.points||{},e);const n={get:function(){return Reflect.get(...arguments)},set:(e,i,s)=>{s instanceof $!=!0&&t.context.raise.warning(`\`paths.${i}\` was set with a value that is not a \`Path\` object`);try{s.name=i}catch(e){t.context.raise.warning(`Could not set \`name\` property on \`paths.${i}\``)}return t.paths[i]=s}};s.paths=new Proxy(this.paths||{},n);const o={get:function(t,e,i){return Reflect.get(...arguments)},set:(e,s,n)=>{n instanceof Q!=!0&&t.context.raise.warning(`\`snippets.${s}\` was set with a value that is not a \`Snippet\` object`),"string"!=typeof n.def&&t.context.raise.warning(`\`snippets.${s}\` was set with a \`def\` parameter that is not a \`string\``),n.anchor instanceof i!=!0&&t.context.raise.warning(`\`snippets.${s}\` was set with an \`anchor\` parameter that is not a \`Point\``);try{n.name=s}catch(e){t.context.raise.warning(`Could not set \`name\` property on \`snippets.${s}\``)}return t.snippets[s]=n}};s.snippets=new Proxy(this.snippets||{},o);const r={get:function(e,i){return void 0===e[i]&&t.context.raise.warning(`Tried to access \`measurements.${i}\` but it is \`undefined\``),Reflect.get(...arguments)},set:(e,i,s)=>t.context.settings.measurements[i]=s};s.measurements=new Proxy(this.context.settings.measurements||{},r);const a={get:function(e,i){return void 0===e[i]&&t.context.raise.warning(`Tried to access \`options.${i}\` but it is \`undefined\``),Reflect.get(...arguments)},set:(e,i,s)=>t.context.settings.options[i]=s};s.options=new Proxy(this.context.settings.options||{},a)}else s.Point=i,s.Path=$,s.Snippet=Q,s.points=this.points||{},s.paths=this.paths||{},s.snippets=this.snippets||{},s.measurements=this.context.settings.measurements||{},s.options=this.context.settings.options||{};return s};function et(t){this.openGroups=[],this.layout={},this.freeId=0,this.body="",this.style="",this.script="",this.defs="",this.pattern=t,this.prefix='<?xml version="1.0" encoding="UTF-8" standalone="no"?>',this.attributes=new e,this.attributes.add("xmlns","http://www.w3.org/2000/svg"),this.attributes.add("xmlns:svg","http://www.w3.org/2000/svg"),this.attributes.add("xmlns:xlink","http://www.w3.org/1999/xlink"),this.attributes.add("xml:lang",t.settings.locale),this.attributes.add("xmlns:freesewing","http://freesewing.org/namespaces/freesewing"),this.attributes.add("freesewing","2.17.0")}et.prototype.runHooks=function(t,e=!1){!1===e&&(e=this);let i=this.hooks[t];if(i.length>0)for(let t of i)t.method(e,t.data)},et.prototype.insertText=function(t){if(this.hooks.insertText.length>0)for(let e of this.hooks.insertText)t=e.method(this.pattern.settings.locale,t,e.data);return t},et.prototype.render=function(t){this.idPrefix=t.settings.idPrefix,this.runHooks("preRender"),t.settings.embed||(this.attributes.add("width",V(t.width)+"mm"),this.attributes.add("height",V(t.height)+"mm")),this.attributes.add("viewBox",`0 0 ${t.width} ${t.height}`),this.head=this.renderHead(),this.tail=this.renderTail(),this.svg="",this.layout={};for(let e in t.parts){let i=t.parts[e];if(i.render){let t=this.renderPart(i);this.layout[e]={svg:t,transform:i.attributes.getAsArray("transform")},this.svg+=this.openGroup(`${this.idPrefix}part-${e}`,i.attributes),this.svg+=t,this.svg+=this.closeGroup()}}return this.svg=this.prefix+this.renderSvgTag()+this.head+this.svg+this.tail,this.runHooks("postRender"),this.svg},et.prototype.renderHead=function(){let t=this.renderStyle();return t+=this.renderScript(),t+=this.renderDefs(),t+=this.openGroup(this.idPrefix+"container"),t},et.prototype.renderTail=function(){let t="";return t+=this.closeGroup(),t+=this.nl()+"</svg>",t},et.prototype.renderSvgTag=function(){let t="<svg";return this.indent(),t+=this.nl()+this.attributes.render(),this.outdent(),t+=this.nl()+">"+this.nl(),t},et.prototype.renderStyle=function(){let t='<style type="text/css"> <![CDATA[ ';return this.indent(),t+=this.nl()+this.style,this.outdent(),t+=this.nl()+"]]>"+this.nl()+"</style>"+this.nl(),t},et.prototype.renderScript=function(){let t='<script type="text/javascript"> <![CDATA[';return this.indent(),t+=this.nl()+this.script,this.outdent(),t+=this.nl()+"]]>"+this.nl()+"<\/script>"+this.nl(),t},et.prototype.renderDefs=function(){let t="<defs>";return this.indent(),t+=this.nl()+this.defs,this.outdent(),t+=this.nl()+"</defs>"+this.nl(),t},et.prototype.renderPart=function(t){let e="";for(let i in t.paths){let s=t.paths[i];s.render&&(e+=this.renderPath(s))}for(let i in t.points)t.points[i].attributes.get("data-text")&&(e+=this.renderText(t.points[i])),t.points[i].attributes.get("data-circle")&&(e+=this.renderCircle(t.points[i]));for(let i in t.snippets){let s=t.snippets[i];e+=this.renderSnippet(s,t)}return e},et.prototype.renderPath=function(t){return t.attributes.get("id")||t.attributes.add("id",this.idPrefix+this.getId()),t.attributes.set("d",t.asPathstring()),`${this.nl()}<path ${t.attributes.render()} />${this.renderPathText(t)}`},et.prototype.renderPathText=function(t){let e=t.attributes.get("data-text");if(!e)return"";this.text=this.insertText(e);let i=t.attributes.renderIfPrefixIs("data-text-"),s="",n=t.attributes.get("data-text-class");n&&n.indexOf("center")>-1?s=' startOffset="50%" ':n&&n.indexOf("right")>-1&&(s=' startOffset="100%" ');let o=this.nl()+"<text>";return this.indent(),o+=`<textPath xlink:href="#${t.attributes.get("id")}" ${s}><tspan ${i}>${this.escapeText(this.text)}</tspan></textPath>`,this.outdent(),o+=this.nl()+"</text>",o},et.prototype.renderText=function(t){let e=t.attributes.getAsArray("data-text");if(!1!==e){let t="";for(let i of e)this.text=this.insertText(i),t+=this.text+" ";this.text=this.insertText(t)}t.attributes.set("data-text-x",V(t.x)),t.attributes.set("data-text-y",V(t.y));let i=t.attributes.get("data-text-lineheight")||12;t.attributes.remove("data-text-lineheight");let s=`${this.nl()}<text ${t.attributes.renderIfPrefixIs("data-text-")}>`;if(this.indent(),-1!==this.text.indexOf("\n")){let e=this.text.split("\n");s+=`<tspan>${e.shift()}</tspan>`;for(let n of e)s+=`<tspan x="${V(t.x)}" dy="${i}">${n}</tspan>`}else s+=`<tspan>${this.escapeText(this.text)}</tspan>`;return this.outdent(),s+=this.nl()+"</text>",s},et.prototype.escapeText=function(t){return t.replace('"',"&#8220;")},et.prototype.renderCircle=function(t){return`<circle cx="${V(t.x)}" cy="${V(t.y)}" r="${t.attributes.get("data-circle")}" ${t.attributes.renderIfPrefixIs("data-circle-")}></circle>`},et.prototype.renderSnippet=function(t,e){let i=V(t.anchor.x),s=V(t.anchor.y),n=t.attributes.get("data-scale");n&&(t.attributes.add("transform",`translate(${i}, ${s})`),t.attributes.add("transform",`scale(${n})`),t.attributes.add("transform",`translate(${-1*i}, ${-1*s})`));let o=t.attributes.get("data-rotate");o&&t.attributes.add("transform",`rotate(${o}, ${i}, ${s})`);let r=this.nl();return r+=`<use x="${i}" y="${s}" `,r+=`xlink:href="#${t.def}" ${t.attributes.render()}>`,r+="</use>",r},et.prototype.openGroup=function(t,e=!1){let i=this.nl()+this.nl();return i+=`\x3c!-- Start of group #${t} --\x3e`,i+=this.nl(),i+=`<g id="${t}"`,e&&(i+=` ${e.render()}`),i+=">",this.indent(),this.openGroups.push(t),i},et.prototype.closeGroup=function(){return this.outdent(),`${this.nl()}</g>${this.nl()}\x3c!-- end of group #${this.openGroups.pop()} --\x3e`},et.prototype.nl=function(){return"\n"+this.tab()},et.prototype.tab=function(){let t="";for(let e=0;e<this.tabs;e++)t+="  ";return t},et.prototype.indent=function(){this.tabs+=1},et.prototype.outdent=function(){this.tabs-=1},et.prototype.getId=function(){return this.freeId+=1,""+this.freeId};var it=function(){};it.prototype={fit:function(t){var e,i,s,n,o=t.length,r=o>0?t[0].width:0,a=o>0?t[0].height:0;for(this.root={x:0,y:0,width:r,height:a},e=0;e<o;e++)s=t[e],(i=this.findNode(this.root,s.width,s.height))?(n=this.splitNode(i,s.width,s.height),s.x=n.x,s.y=n.y):(n=this.growNode(s.width,s.height),s.x=n.x,s.y=n.y)},findNode:function(t,e,i){return t.used?this.findNode(t.right,e,i)||this.findNode(t.down,e,i):e<=t.width&&i<=t.height?t:null},splitNode:function(t,e,i){return t.used=!0,t.down={x:t.x,y:t.y+i,width:t.width,height:t.height-i},t.right={x:t.x+e,y:t.y,width:t.width-e,height:i},t},growNode:function(t,e){var i=t<=this.root.width,s=e<=this.root.height,n=s&&this.root.height>=this.root.width+t,o=i&&this.root.width>=this.root.height+e;return n?this.growRight(t,e):o?this.growDown(t,e):s?this.growRight(t,e):i?this.growDown(t,e):null},growRight:function(t,e){var i;return this.root={used:!0,x:0,y:0,width:this.root.width+t,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:t,height:this.root.height}},(i=this.findNode(this.root,t,e))?this.splitNode(i,t,e):null},growDown:function(t,e){var i;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+e,down:{x:0,y:this.root.height,width:this.root.width,height:e},right:this.root},(i=this.findNode(this.root,t,e))?this.splitNode(i,t,e):null}};var st=it;function nt(t){this.data=new Map,this.raise=t}function ot(t={options:{}}){this.events={info:[],warning:[],error:[],debug:[]};const s=this.events;this.raise={info:function(t){s.info.push(t)},warning:function(t){s.warning.push(t)},error:function(t){s.error.push(t)},debug:function(t){s.debug.push(t)}},this.raise.debug(`New \`@freesewing/${t.name}:${t.version}\` pattern using \`@freesewing/core:2.17.0\``),this.config=t,this.width=0,this.height=0,this.is="",this.debug=!0,this.store=new nt(this.raise),this.parts={},this.hooks=new K,this.Point=i,this.Path=$,this.Snippet=Q,this.Attributes=e,this.settings={complete:!0,idPrefix:"fs-",locale:"en",units:"metric",margin:2,layout:!0,debug:!0,options:{}},void 0===this.config.dependencies&&(this.config.dependencies={}),void 0===this.config.inject&&(this.config.inject={}),void 0===this.config.hide&&(this.config.hide=[]),this.config.resolvedDependencies=this.resolveDependencies(this.config.dependencies),this.config.draftOrder=this.draftOrder(this.config.resolvedDependencies);for(let e in t.options){let i=t.options[e];if("object"==typeof i)if(void 0!==i.pct)this.settings.options[e]=i.pct/100;else if(void 0!==i.mm)this.settings.options[e]=i.mm;else if(void 0!==i.deg)this.settings.options[e]=i.deg;else if(void 0!==i.count)this.settings.options[e]=i.count;else if(void 0!==i.bool)this.settings.options[e]=i.bool;else{if(void 0===i.dflt){let t="Unknown option type: "+JSON.stringify(i);throw this.raise.error(t),new Error(t)}this.settings.options[e]=i.dflt}else this.settings.options[e]=i}this.macros={};const n={parts:this.parts,config:this.config,settings:this.settings,store:this.store,macros:this.macros,events:this.events,raise:this.raise};this.Part=function(t=!1){let e=new tt;e.context=n;for(let t in n.macros)e[F(t)]=n.macros[t];return t&&(e.name=t),e}}nt.prototype.set=function(t,e){this.data.set(t,e)},nt.prototype.setIfUnset=function(t,e){this.data.has(t)||this.data.set(t,e)},nt.prototype.get=function(t){return this.data.has(t)||this.raise.warning(`Tried to access \`${t}\` in the \`store\` but it is not set`),this.data.get(t)},ot.prototype.apply=function(t){if("object"!=typeof t)return this.raise.warning("Pattern initialized without any settings"),this;for(let e of Object.keys(t))if(Array.isArray(t[e]))if(Array.isArray(this.settings[e]))for(let i of t[e])this.settings[e].push(i);else this.settings[e]=t[e];else"object"==typeof t[e]?this.settings[e]={...this.settings[e],...t[e]}:this.settings[e]=t[e];return this.settings.debug||(this.debug=!1),this},ot.prototype.runHooks=function(t,e=!1){!1===e&&(e=this);let i=this.hooks[t];if(i.length>0){this.debug&&this.raise.debug(`Running \`${t}\` hooks`);for(let t of i)t.method(e,t.data)}},ot.prototype.draft=function(){"sample"!==this.is&&(this.is="draft",this.debug&&this.raise.debug("Drafting pattern")),this.runHooks("preDraft");for(let t of this.config.draftOrder){if(this.debug&&this.raise.debug(`Creating part \`${t}\``),this.parts[t]=new this.Part(t),"string"==typeof this.config.inject[t]){this.debug&&this.raise.debug(`Injecting part \`${this.config.inject[t]}\` into part \`${t}\``);try{this.parts[t].inject(this.parts[this.config.inject[t]])}catch(e){this.raise.error([`Could not inject part \`${this.config.inject[t]}\` into part \`${t}\``,e])}}if(this.needs(t)){let e="draft"+S(t);if("function"!=typeof this[e])throw this.raise.error(`Method \`pattern.${e}\` is callable`),new Error('Method "'+e+'" on pattern object is not callable');try{this.parts[t]=this[e](this.parts[t])}catch(e){this.raise.error([`Unable to draft part \`${t}\``,e])}void 0===this.parts[t]&&this.raise.error(`Result of \`pattern.${e}\` was \`undefined\`. Did you forget to return the \`Part\` object?`);try{this.parts[t].render=!1!==this.parts[t].render&&this.wants(t)}catch(e){this.raise.error([`Unable to set \`render\` property on part \`${t}\``,e])}}else this.debug&&this.raise.debug(`Part \`${t}\` is not needed. Skipping draft and setting render to \`false\``),this.parts[t].render=!1}return this.runHooks("postDraft"),this},ot.prototype.sample=function(){return"option"===this.settings.sample.type?this.sampleOption(this.settings.sample.option):"measurement"===this.settings.sample.type?this.sampleMeasurement(this.settings.sample.measurement):"models"===this.settings.sample.type?this.sampleModels(this.settings.sample.models,this.settings.sample.focus||!1):void 0},ot.prototype.sampleParts=function(){let t={};this.settings.complete=!1,this.settings.paperless=!1,this.draft();for(let e in this.parts)t[e]=new this.Part,t[e].render=this.parts[e].render;return t},ot.prototype.sampleRun=function(t,e,i,s,n=!1){this.draft();for(let o in this.parts){let r=0,a=0;this.parts[o].points.anchor&&(void 0===e[o]?e[o]=this.parts[o].points.anchor:e[o].sitsOn(this.parts[o].points.anchor)||(r=this.parts[o].points.anchor.dx(e[o]),a=this.parts[o].points.anchor.dy(e[o])));for(let e in this.parts[o].paths)t[o].paths[e+"_"+i]=this.parts[o].paths[e].clone().attr("style","sample-focus"===n?this.settings.sample&&this.settings.sample.focusStyle||W(i,s):W(i,s,this.settings.sample&&this.settings.sample.styles||!1)).attr("data-sample-run",i).attr("data-sample-runs",s),this.parts[o].points.anchor&&(t[o].paths[e+"_"+i]=t[o].paths[e+"_"+i].translate(r,a)),!1!==n&&t[o].paths[e+"_"+i].attributes.add("class",n)}},ot.prototype.sampleOption=function(t){let e,i;this.is="sample",this.debug&&this.raise.debug(`Sampling option \`${t}\``),this.runHooks("preSample");let s=1,n={},o=this.sampleParts(),r=this.config.options[t];if("object"==typeof r.list)return this.sampleListOption(t);if(void 0===r.min||void 0===r.max){r={min:.9*r,max:1.1*r}}void 0!==r.pct&&(s=100),i=r.min/s,e=(r.max/s-i)/9;for(let s=1;s<11;s++)this.settings.options[t]=i,this.sampleRun(o,n,s,10),i+=e;return this.parts=o,this.runHooks("postSample"),this},ot.prototype.sampleListOption=function(t){let e=this.sampleParts(),i=this.config.options[t],s={},n=1,o=i.list.length;for(let r of i.list)this.settings.options[t]=r,this.sampleRun(e,s,n,o),n++;return this.parts=e,this},ot.prototype.sampleMeasurement=function(t){this.is="sample",this.debug&&this.raise.debug(`Sampling measurement \`${t}\``),this.runHooks("preSample");let e={},i=this.sampleParts(),s=this.settings.measurements[t];void 0===s&&this.raise.error(`Cannot sample measurement \`${t}\` because it's \`undefined\``);let n=s/50;s*=.9;for(let o=1;o<11;o++)this.settings.measurements[t]=s,this.sampleRun(i,e,o,10),s+=n;return this.parts=i,this.runHooks("postSample"),this},ot.prototype.sampleModels=function(t,e=!1){this.is="sample",this.debug&&this.raise.debug("Sampling models"),this.runHooks("preSample");let i={},s=this.sampleParts();e&&(this.settings.measurements=t[e],this.sampleRun(s,i,-1,-1,"sample-focus"),delete t[e]);let n=-1,o=Object.keys(t).length;for(let e in t)n++,this.settings.measurements=t[e],this.sampleRun(s,i,n,o);return this.parts=s,this.runHooks("postSample"),this},ot.prototype.render=function(){return this.svg=new et(this),this.svg.hooks=this.hooks,this.pack().svg.render(this)},ot.prototype.on=function(t,e,i){this.hooks[t].push({method:e,data:i})},ot.prototype.use=function(t,e){return this.debug&&this.raise.debug(`Loaded plugin \`${t.name}:${t.version}\``),t.hooks&&this.loadPluginHooks(t,e),t.macros&&this.loadPluginMacros(t),this},ot.prototype.useIf=function(t,e){return t.condition(e)?(this.debug&&this.raise.debug(`Condition met: Loaded plugin \`${t.plugin.name}:${t.plugin.version}\``),this.loadPluginHooks(t.plugin,t.data)):this.debug&&this.raise.debug(`Condition not met: Skipped loading plugin \`${t.plugin.name}:${t.plugin.version}\``),this},ot.prototype.loadPluginHooks=function(t,e){for(let i of Object.keys(this.hooks))if("function"==typeof t.hooks[i])this.on(i,t.hooks[i],e);else if(Array.isArray(t.hooks[i]))for(let s of t.hooks[i])this.on(i,s,e)},ot.prototype.loadPluginMacros=function(t){for(let e in t.macros)"function"==typeof t.macros[e]&&this.macro(e,t.macros[e])},ot.prototype.macro=function(t,e){this.macros[t]=e},ot.prototype.pack=function(){if(this.events.error.length>0)return this.raise.warning("One or more errors occured. Not packing pattern parts"),this;let t=[];for(let e in this.parts){let i=this.parts[e];if(i.attributes.remove("transform"),i.render){i.stack();let s=i.bottomRight.x-i.topLeft.x,n=i.bottomRight.y-i.topLeft.y;!0===this.settings.layout?t.push({id:e,width:s,height:n}):(this.width<s&&(this.width=s),this.height<n&&(this.height=n))}}if(!0===this.settings.layout){let e=function(t,e){e=e||{};var i=new st,s=e.inPlace||!1,n=t.map((function(t){return s?t:{width:t.width,height:t.height,item:t}}));n=n.sort((function(t,e){return e.width*e.height-t.width*t.height})),i.fit(n);var o={width:n.reduce((function(t,e){return Math.max(t,e.x+e.width)}),0),height:n.reduce((function(t,e){return Math.max(t,e.y+e.height)}),0)};return s||(o.items=n),o}(t,{inPlace:!0});for(let e of t){let t=this.parts[e.id];0===e.x&&0===e.y||t.attr("transform",`translate(${e.x}, ${e.y})`)}this.width=e.width,this.height=e.height}else if("object"==typeof this.settings.layout){this.width=this.settings.layout.width,this.height=this.settings.layout.height;for(let t of Object.keys(this.settings.layout.parts)){let e=this.settings.layout.parts[t];"object"==typeof e.move&&this.parts[t].attributes.set("transform","translate("+e.move.x+", "+e.move.y+")");let i=this.parts[t].topLeft.shiftFractionTowards(this.parts[t].bottomRight,.5),s={x:0,y:0};if(e.flipX){let e=s.x-i.x,n=`translate(${-1*i.x}, ${-1*i.y})`;n+=" scale(-1, 1)",n+=` translate(${-1*i.x+2*e}, ${i.y})`,this.parts[t].attributes.add("transform",n)}if(e.flipY){let e=s.y-i.y,n=`translate(${-1*i.x}, ${-1*i.y})`;n+=" scale(1, -1)",n+=` translate(${i.x}, ${-1*i.y+2*e})`,this.parts[t].attributes.add("transform",n)}if(e.rotate){let n=`rotate(${e.rotate}, ${i.x-s.x}, ${i.y-s.y})`;this.parts[t].attributes.add("transform",n)}}}return this},ot.prototype.draftOrder=function(t=this.resolveDependencies()){let e=[],i={};return Object.keys(t).forEach((function s(n,o){Array.isArray(o)||(o=[]),o.push(n),i[n]=!0,void 0!==t[n]&&t[n].forEach((function(t){i[t]||s(t,o.slice(0))})),e.indexOf(n)<0&&e.push(n)})),e},ot.prototype.resolveDependency=function(t,e,i=this.config.dependencies,s=[]){if(void 0===t[e]&&(t[e]=!0),"string"==typeof i[e]&&(i[e]=[i[e]]),Array.isArray(i[e])){if(0===i[e].length)return[];-1===s.indexOf(i[e])&&s.push(...i[e]);for(let n of i[e])s.concat(this.resolveDependency(t,n,i,s))}return s},ot.prototype.resolveDependencies=function(t=this.config.dependencies){for(let t in this.config.inject){let e=this.config.inject[t];if(void 0===this.config.dependencies[t])this.config.dependencies[t]=e;else if(this.config.dependencies[t]!==e)if("string"==typeof this.config.dependencies[t])this.config.dependencies[t]=[this.config.dependencies[t],e];else{if(!Array.isArray(this.config.dependencies[t]))throw this.raise.error("Part dependencies should be a string or an array of strings"),new Error("Part dependencies should be a string or an array of strings");-1===this.config.dependencies[t].indexOf(e)&&this.config.dependencies[t].push(e)}if(Array.isArray(this.config.parts)){let e=this.config.parts.indexOf(this.config.inject[t]);-1!==e&&this.config.parts.splice(e,1)}}if(Array.isArray(this.config.parts))for(let t of this.config.parts)void 0===this.config.dependencies[t]&&(this.config.dependencies[t]=[]);let e={},i={};for(let s in t)e[s]=this.resolveDependency(i,s,t);for(let t in i)void 0===e[t]&&(e[t]=[]);return e},ot.prototype.needs=function(t){if(void 0===this.settings.only||!1===this.settings.only)return!0;if("string"==typeof this.settings.only){if(this.settings.only===t)return!0;if(Array.isArray(this.config.resolvedDependencies[this.settings.only]))for(let e of this.config.resolvedDependencies[this.settings.only])if(e===t)return!0}else if(Array.isArray(this.settings.only))for(let e of this.settings.only){if(e===t)return!0;for(let i of this.config.resolvedDependencies[e])if(i===t)return!0}return!1},ot.prototype.isHidden=function(t){return!(!Array.isArray(this.config.hide)||-1===this.config.hide.indexOf(t))},ot.prototype.wants=function(t){if(void 0===this.settings.only||!1===this.settings.only){if(this.isHidden(t))return!1}else{if("string"==typeof this.settings.only)return this.settings.only===t;if(Array.isArray(this.settings.only)){for(let e of this.settings.only)if(e===t)return!0;return!1}}return!0},ot.prototype.getRenderProps=function(){let t=new et(this);t.hooks=this.hooks,t.runHooks("preRender"),this.pack();let e={svg:t};e.width=this.width,e.height=this.height,e.settings=this.settings,e.events={debug:this.events.debug,info:this.events.info,warning:this.events.warning,error:this.events.error},e.parts={};for(let t in this.parts)this.parts[t].render&&(e.parts[t]={paths:this.parts[t].paths,points:this.parts[t].points,snippets:this.parts[t].snippets,attributes:this.parts[t].attributes,height:this.parts[t].height,width:this.parts[t].width,bottomRight:this.parts[t].bottomRight,topLeft:this.parts[t].topLeft});return e};var rt={version:"2.17.0",Design:function(t,e=!1,i=!1){const s=function(s){if(ot.call(this,t),Array.isArray(e))for(let t of e)this.use(t);else e&&this.use(e);if(Array.isArray(i))for(let t of i)this.useIf(t,s);else i.plugin&&i.condition&&this.useIf(i,s);return this.apply(s),this};return(s.prototype=Object.create(ot.prototype)).constructor=s,s.config=t,s},Pattern:ot,Point:i,Path:$,Snippet:Q,utils:Z,patterns:{},plugins:{}};
/**
 * @freesewing/plugin-bundle | v2.17.0
 * An umbrella package of 8 essential FreeSewing build-time plugins
 * (c) 2021 Joost De Cock <joost@joost.at> (https://github.com/joostdecock)
 * @license MIT
 */
/**
 * @freesewing/plugin-buttons | v2.17.0
 * A FreeSewing plugin that provides button, buttonhole, and snap snippets
 * (c) 2021 Joost De Cock <joost@joost.at> (https://github.com/joostdecock)
 * @license MIT
 */const at="__paperless";function ht(t,e,i,s){let n=(new s.Path).move(t).line(e).attr("class","mark").attr("data-text",i.text||s.units(t.dist(e))).attr("data-text-class","fill-mark center");return i.noStartMarker||n.attributes.set("marker-start","url(#dimensionFrom)"),i.noEndMarker||n.attributes.set("marker-end","url(#dimensionTo)"),n}function pt(t,e,i,s){t.paths[s]=(new t.Path).move(e).line(i).attr("class","mark dotted")}function lt(t,e,i,s){let n;return void 0===t.y||t[e].y===t.y?n=t[e]:(n=new i.Point(t[e].x,t.y),pt(i,t[e],n,s)),n}function ct(t,e,i,s){let n;return void 0===t.x||t[e].x===t.x?n=t[e]:(n=new i.Point(t.x,t[e].y),pt(i,t[e],n,s)),n}function ut(t,e,i,s){let n,o,r;return"from"===e?(o=1,r="to"):(o=-1,r="from"),void 0===t.d?n=t[e]:(n=t[e].shiftTowards(t[r],t.d).rotate(90*o,t[e]),pt(i,t[e],n,s)),n}const ft=t=>t.charAt(0).toUpperCase()+t.slice(1);let dt=[{name:"@freesewing/plugin-buttons",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-buttons")&&t.attributes.set("freesewing:plugin-buttons","2.17.0"),t.defs+='<g id="button"><circle cx="0" cy="0" r="3.4" style="stroke:#000000;fill:none;stroke-width:1;"/><circle cx="-1" cy="-1" r="0.5" style="stroke:none;fill:#000000;"/><circle cx="1" cy="-1" r="0.5" style="stroke:none;fill:#000000;" /><circle cx="1" cy="1" r="0.5" style="stroke:none;fill:#000000;" /><circle cx="-1" cy="1" r="0.5" style="stroke:none;fill:#000000;" /></g><g id="buttonhole"><path style="fill:none;stroke:#000000;" d="M -1,-5 L 1,-5 L 1,5 L -1,5 z" /></g><g id="buttonhole-start"><path style="fill:none;stroke:#000000;" d="M -1,-10 L 1,-10 L 1,0 L -1,0 z" /></g><g id="buttonhole-end"><path style="fill:none;stroke:#000000;" d="M -1,0 L 1,0 L 1,10 L -1,10 z" /></g><radialGradient id="snap-stud-grad" cx="50%" cy="50%" r="50%" fx="50%" fy="50%"><stop offset="30%" style="stop-color:rgb(235,235,235); stop-opacity:1"/><stop offset="80%" style="stop-color:rgb(100,100,100);stop-opacity:1" /></radialGradient><g id="snap-stud" ><circle id="snap-stud-circle-edge" cx="0" cy="0" r="3.4" style="stroke:#666;fill:#dddddd;stroke-width:0.3;" /><circle id="snap-stud-circle-middle" cx="0" cy="0" r="1.8" style="stroke:none;fill:url(#snap-stud-grad);"/><path style="fill:none;stroke:#666; stroke-width:0.2;" d="M -2,0 L -3,0 M 2,0 L 3,0 M 0,2 L 0,3 M 0,-2 L 0,-3 M 1.5,1.5 L 2.1,2.1 M -1.5,1.5 L -2.1,2.1 M -1.5,-1.5 L -2.1,-2.1 M 1.5,-1.5 L 2.1,-2.1" id="snap-stud-lines"/></g><g id="snap-socket"><circle id="snap-socket-circle-edge" cx="0" cy="0" r="3.4" style="stroke:#666;fill:#bbbbbb;stroke-width:0.3;"/><circle id="snap-socket-circle-middle" cx="0" cy="0" r="2" style="stroke:#666;fill:#dddddd; stroke-width:0.4;"/><path style="fill:none;stroke:#666; stroke-width:0.5;" d="M -1.7,-1 L -1.7,1 M 1.7,-1 L 1.7,1" id="snap-socket-lines" /></g>'}}},{name:"@freesewing/plugin-cutonfold",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-cutonfold")&&(t.attributes.set("freesewing:plugin-cutonfold","2.17.0"),t.defs+='\n<marker orient="auto" refY="0.0" refX="0.0" id="cutonfoldFrom" style="overflow:visible;" >\n\t<path class="note fill-note" d="M 0,0 L 12,-4 C 10,-2 10,2  12, 4 z" />\n</marker>\n<marker orient="auto" refY="0.0" refX="0.0" id="cutonfoldTo" style="overflow:visible;" >\n\t<path class="note fill-note" d="M 0,0 L -12,-4 C -10,-2 -10,2  -12, 4 z" />\n</marker>\n')}},macros:{cutonfold:function(t){if(!1===t)return delete this.points.cutonfoldFrom,delete this.points.cutonfoldTo,delete this.points.cutonfoldVia1,delete this.points.cutonfoldVia2,delete this.paths.cutonfold,!0;let e=this.points;e["cutonfoldFrom"+(t={offset:15,margin:5,prefix:"",...t}).prefix]=t.from.shiftFractionTowards(t.to,t.margin/100),e["cutonfoldTo"+t.prefix]=t.to.shiftFractionTowards(t.from,t.margin/100),e["cutonfoldVia1"+t.prefix]=e["cutonfoldFrom"+t.prefix].shiftTowards(t.from,t.offset).rotate(-90,e["cutonfoldFrom"+t.prefix]),e["cutonfoldVia2"+t.prefix]=e["cutonfoldTo"+t.prefix].shiftTowards(t.to,t.offset).rotate(90,e["cutonfoldTo"+t.prefix]);let i=t.grainline?"cutOnFoldAndGrainline":"cutOnFold";this.paths["cutonfold"+t.prefix]=(new this.Path).move(e["cutonfoldFrom"+t.prefix]).line(e["cutonfoldVia1"+t.prefix]).line(e["cutonfoldVia2"+t.prefix]).line(e["cutonfoldTo"+t.prefix]).attr("class","note").attr("marker-start","url(#cutonfoldFrom)").attr("marker-end","url(#cutonfoldTo)").attr("data-text",i).attr("data-text-class","center fill-note")}}},{name:"@freesewing/plugin-dimension",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-dimension")&&(t.attributes.set("freesewing:plugin-dimension","2.17.0"),t.defs+='\n<marker orient="auto" refY="0.0" refX="0.0" id="dimensionFrom" style="overflow:visible;"><path class="mark fill-mark" d="M 0,0 L 12,-4 C 10,-2 10,2  12, 4 z" /></marker>\n<marker orient="auto" refY="0.0" refX="0.0" id="dimensionTo" style="overflow:visible;" ><path class="mark fill-mark" d="M 0,0 L -12,-4 C -10,-2 -10,2  -12, 4 z" /></marker>\n')}},macros:{hd:function(t){let e=t.id||this.getId(at),i=lt(t,"from",this,e+"_ls"),s=lt(t,"to",this,e+"_le");this.paths[e]=ht(i,s,t,this)},vd:function(t){let e=t.id||this.getId(at),i=ct(t,"from",this,e+"_ls"),s=ct(t,"to",this,e+"_le");this.paths[e]=ht(i,s,t,this)},ld:function(t){let e=t.id||this.getId(at),i=ut(t,"from",this,e+"_ls"),s=ut(t,"to",this,e+"_le");this.paths[e]=ht(i,s,t,this)},pd:function(t){let e=t.path.offset(t.d).attr("class","mark").attr("marker-start","url(#dimensionFrom)").attr("marker-end","url(#dimensionTo)").attr("data-text",t.text||this.units(t.path.length())).attr("data-text-class","fill-mark center"),i=t.id||this.getId(at);pt(this,t.path.start(),e.start(),i+"_ls"),pt(this,t.path.end(),e.end(),i+"_le"),this.paths[i]=e},rmd:function(t){if(this.paths[t.id]&&delete this.paths[t.id],this.paths[`${t.id}_ls`]&&delete this.paths[`${t.id}_ls`],this.paths[`${t.id}_le`]&&delete this.paths[`${t.id}_le`],Array.isArray(t.ids))for(const e of t.ids)this.paths[e]&&delete this.paths[e],this.paths[`${e}_ls`]&&delete this.paths[`${e}_ls`],this.paths[`${e}_le`]&&delete this.paths[`${e}_le`]},rmad:function(t){for(let t of["paths","points"])for(let e in this[t])e.slice(0,at.length)===at&&delete this[t][e]}}},{name:"@freesewing/plugin-grainline",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-grainline")&&(t.attributes.set("freesewing:plugin-grainline","2.17.0"),t.defs+='\n<marker orient="auto" refY="0.0" refX="0.0" id="grainlineFrom" style="overflow:visible;" >\n\t<path class="note fill-note" d="M 0,0 L 12,-4 C 10,-2 10,2  12, 4 z" />\n</marker>\n<marker orient="auto" refY="0.0" refX="0.0" id="grainlineTo" style="overflow:visible;" >\n\t<path class="note fill-note" d="M 0,0 L -12,-4 C -10,-2 -10,2  -12, 4 z" />\n</marker>\n')}},macros:{grainline:function(t){if(!1===t)return delete this.points.grainlineFrom,delete this.points.grainlineTo,delete this.paths.grainline,!0;let e=this.points;e.grainlineFrom=t.from.shiftFractionTowards(t.to,.05),e.grainlineTo=t.to.shiftFractionTowards(t.from,.05),this.paths.grainline=(new this.Path).move(e.grainlineFrom).line(e.grainlineTo).attr("class","note").attr("marker-start","url(#grainlineFrom)").attr("marker-end","url(#grainlineTo)").attr("data-text","grainline").attr("data-text-class","center fill-note")}}},{name:"@freesewing/plugin-logo",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-logo")&&(t.attributes.set("freesewing:plugin-logo","2.17.0"),t.defs+='<g id="logo" transform="translate(-23 -36)"><path class="logo" stroke="none" fill="currentColor" d="M 35.222,0 C 34.233,0.703 34.284,0.613 33.485,0.874 31.653,1.473 29.896,1.144 27.811,0.97 27.184,0.9 26.562,0.859 25.955,0.855 22.89,0.834 20.287,1.733 19.794,4.243 18.885,4.794 18.049,5.461 17.221,6.129 15.453,7.524 14.122,9.229 13.214,11.284 11.974,14.319 13.094,17.576 13.649,20.652 13.781,21.372 13.919,22.058 13.993,22.323 14.098,22.696 14.283,23.052 14.484,23.372 14.531,23.38 14.779,22.998 14.838,22.829 14.924,22.583 14.915,22.188 14.821,21.848 14.613,21.083 14.415,20.462 14.398,20.15 14.368,19.564 14.482,19.023 14.696,18.755 14.772,18.66 14.946,19.15 14.901,19.332 14.848,19.551 14.808,19.926 14.825,20.099 14.872,20.685 14.958,21.312 15.065,21.86 15.202,22.567 15.261,23.021 15.236,23.197 15.218,23.325 15.158,23.454 14.928,23.85 14.728,24.197 14.624,24.478 14.608,24.726 14.591,24.968 14.664,25.573 14.732,25.721 14.831,25.952 15.129,26.195 15.389,26.255 15.638,26.35 15.763,26.547 15.891,26.768 16.202,27.361 16.442,28.083 16.68,29.171 16.796,29.692 16.893,30.157 16.924,30.401 15.004,30.403 12.545,30.404 10.305,30.404 9.551,30.416 8.189,30.062 6.94,29.98 6.759,28.026 5.901,25.756 4.433,25.624 3.431,25.533 2.6,25.914 1.897,27.497 L 1.917,27.582 C 2.332,27.235 2.77,26.174 4.348,26.247 5.56,26.302 5.964,28.596 6.084,29.976 5.346,30.03 4.718,30.257 4.39,30.824 L 4.383,30.824 C 4.383,30.825 4.383,30.827 4.386,30.829 4.383,30.831 4.383,30.833 4.383,30.835 L 4.39,30.835 C 4.728,31.416 5.379,31.641 6.144,31.686 6.655,46.136 20.238,48 23.95,48 37.798,48 42.646,38.59 43.375,34.863 43.716,36.451 42.642,38.474 42.385,39.967 45.306,36.59 44.778,33.343 44.244,30.077 44.688,30.605 45.289,30.932 46.104,30.751 45.523,30.363 44.735,30.635 44.263,28.998 44.057,28.291 43.879,27.761 43.702,27.316 43.32,25.883 42.778,24.514 42.112,23.18 41.55,21.733 41.921,20.795 41.865,19.553 42.876,22.887 43.508,23.774 44.688,24.123 41.72,20.547 42.736,15.01 41.059,10.068 41.818,10.514 42.684,10.648 43.606,10.103 42.714,9.849 41.824,10.52 40.544,8.639 39.463,6.536 37.897,4.983 35.997,3.613 34.979,2.949 33.849,2.503 32.713,2.089 33.87,1.799 35.162,0.769 35.222,0 z M 33.281,11.107 C 34.805,11.663 36.485,13.775 36.466,15.847 L 36.466,15.933 36.466,15.963 C 36.425,18.777 35.146,20.29 35.2,22.164 35.269,24.371 36.219,25.141 36.408,25.509 36.084,24.148 35.894,22.436 36.322,21.08 36.872,19.336 37.427,17.892 37.387,16.526 37.367,16.206 37.231,15.009 37.14,14.479 38.774,16.837 36.786,20.266 37.358,22.51 38.352,26.419 42.807,26.913 41.481,34.789 40.314,41.713 32.318,46.968 24.122,46.968 18.046,46.968 7.517,43.605 6.997,31.676 8.232,31.588 9.56,31.244 10.305,31.256 12.557,31.256 15.129,31.257 17.067,31.258 17.431,32.9 17.704,33.296 19.085,34.39 20.621,35.598 20.979,35.745 23.251,35.767 25.524,35.79 26.198,35.303 28.403,33.217 28.879,32.659 29.085,31.928 29.316,31.241 31.584,31.22 33.238,31.18 34.865,31.104 36.522,31.029 36.756,31.104 39.426,30.829 36.756,30.554 36.522,30.629 34.865,30.553 33.281,30.481 31.677,30.44 29.508,30.42 29.69,29.603 29.95,28.805 30.227,28.016 30.398,27.551 30.599,27.098 30.805,26.647 L 31.03,26.577 C 31.464,26.423 31.848,26.093 32.001,25.647 32.198,25.056 32.058,24.392 31.677,23.909 31.546,23.728 31.383,23.497 31.316,23.395 31.115,23.077 31.11,22.9 31.28,21.718 31.423,20.728 31.439,20.21 31.34,19.708 31.32,19.421 31.318,18.831 31.309,18.672 31.385,18.714 31.55,19.09 31.717,19.599 31.883,20.11 31.91,20.216 31.948,20.651 31.99,21.145 31.805,21.511 31.653,22.248 31.577,22.628 31.51,22.981 31.51,23.029 31.51,23.08 31.546,23.188 31.584,23.272 31.673,23.46 31.84,23.724 31.871,23.724 32.416,23.123 32.736,22.381 33.021,21.628 33.321,20.776 33.409,19.872 33.619,18.995 33.789,18.231 33.985,17.466 34.046,16.682 34.169,15.152 34.097,14.072 33.759,12.478 33.678,12.118 33.444,11.431 33.281,11.107 z M 27.921,18.644 C 28.506,18.637 29.085,18.708 29.636,18.867 30.385,19.154 30.49,19.823 30.628,20.574 30.705,21.054 30.702,21.399 30.615,21.963 30.554,22.781 30.229,23.414 29.519,23.859 28.448,24.057 27.303,24.248 26.395,23.539 25.633,22.489 25.174,21.162 25.349,19.868 25.46,19.337 25.707,19.061 26.215,18.896 26.762,18.739 27.341,18.653 27.921,18.644 z M 19.038,18.739 C 19.585,18.734 20.138,18.792 20.442,18.986 21.747,19.869 21.328,21.306 20.812,22.567 20.061,24.218 18.437,24.157 16.863,24.144 15.992,23.889 15.912,23.175 15.786,22.412 15.678,21.675 15.448,20.885 15.64,20.144 16.133,18.952 17.935,18.815 19.038,18.739 z M 38.941,18.945 C 38.948,22.118 39.49,23.677 40.578,25.924 39.937,24.701 39.021,24.005 38.68,22.543 38.028,19.72 38.731,19.878 38.941,18.945 z M 23.128,21.243 C 23.3,21.417 23.383,21.657 23.532,21.848 23.647,21.651 23.765,21.455 23.913,21.28 23.99,21.282 24.084,21.434 24.169,21.706 24.533,22.712 24.604,23.819 25.076,24.786 25.517,25.486 24.915,25.894 24.254,25.926 23.772,25.925 23.568,25.596 23.285,25.27 23.212,25.483 23.073,25.62 22.907,25.764 22.485,26.118 21.658,25.987 21.53,25.429 21.7,24.363 22.243,23.384 22.599,22.362 22.776,21.989 22.778,21.703 23.128,21.243 z M 16.936,26.628 C 17.149,26.628 17.734,27.025 17.853,27.249 17.935,27.398 18.122,27.978 18.135,28.119 18.156,28.287 18.105,28.685 18.053,28.793 18.015,28.87 17.986,28.881 17.942,28.831 17.905,28.789 17.415,27.849 17.102,27.227 16.856,26.729 16.83,26.628 16.936,26.628 z M 29.158,26.939 C 29.166,26.94 29.178,26.943 29.189,26.946 29.255,26.973 29.209,27.207 28.961,28.057 28.914,28.313 28.8,28.515 28.633,28.683 28.578,28.683 28.553,28.619 28.467,28.264 28.394,27.961 28.386,27.691 28.437,27.449 28.525,27.146 28.881,27.053 29.158,26.939 z M 27.675,28.792 C 27.696,28.788 27.716,28.799 27.742,28.82 27.832,28.883 27.845,29.049 27.785,29.374 27.712,29.792 27.696,29.838 27.588,29.881 27.541,29.902 27.457,29.917 27.401,29.917 27.3,29.899 27.274,29.817 27.298,29.693 27.298,29.433 27.374,29.207 27.546,28.94 27.611,28.84 27.644,28.797 27.675,28.792 z M 19.042,28.811 C 19.111,28.811 19.319,28.961 19.396,29.065 19.482,29.175 19.58,29.83 19.525,29.943 19.462,30.085 19.154,30.014 19.069,29.837 19.017,29.731 18.894,29.159 18.894,29.023 18.894,28.897 18.955,28.811 19.042,28.811 z M 26.933,28.984 C 27.017,29.104 27.039,29.258 27.021,29.596 L 27.004,29.904 26.916,29.992 C 26.863,30.041 26.773,30.101 26.719,30.126 26.6,30.182 26.509,30.187 26.492,30.142 26.472,30.082 26.506,29.7 26.543,29.571 26.586,29.438 26.779,29.041 26.843,28.957 26.872,28.88 26.906,28.976 26.933,28.984 z M 21.912,28.966 C 22.093,29.012 22.173,29.175 22.272,29.323 L 22.339,29.455 22.245,29.782 C 22.195,29.962 22.142,30.124 22.126,30.142 22.108,30.162 22.041,30.172 21.942,30.171 21.678,30.164 21.648,30.153 21.577,30.045 L 21.511,29.947 21.567,29.672 C 21.648,29.276 21.687,29.157 21.777,29.055 21.824,29 21.871,28.97 21.912,28.966 z M 20.241,29.249 20.39,29.398 20.415,29.735 C 20.428,29.919 20.434,30.09 20.424,30.111 20.415,30.14 20.361,30.148 20.194,30.148 L 19.977,30.148 C 19.861,30.021 19.825,29.866 19.776,29.706 19.662,29.225 19.662,29.006 19.78,28.977 19.973,28.989 20.1,29.129 20.241,29.249 z M 26.041,29.018 C 26.277,29.081 26.23,29.456 26.229,29.724 26.211,30.158 26.194,30.248 26.138,30.304 26.041,30.401 25.771,30.347 25.64,30.203 25.597,30.151 25.593,30.135 25.627,29.924 25.666,29.667 25.716,29.507 25.827,29.287 25.908,29.129 25.984,29.03 26.041,29.018 z M 20.715,29.038 C 20.728,29.037 20.749,29.038 20.769,29.04 20.919,29.052 21.059,29.15 21.183,29.33 L 21.283,29.477 C 21.292,29.718 21.283,29.972 21.24,30.196 21.214,30.209 21.106,30.229 21,30.239 20.816,30.256 20.799,30.252 20.735,30.196 20.646,30.12 20.621,29.979 20.599,29.511 20.586,29.129 20.595,29.044 20.715,29.038 z M 22.984,29.118 C 23.145,29.152 23.247,29.238 23.292,29.379 23.328,29.5 23.35,30.177 23.315,30.224 23.303,30.244 23.227,30.269 23.14,30.28 22.816,30.321 22.53,30.29 22.502,30.213 22.466,30.125 22.707,29.253 22.796,29.145 22.834,29.061 22.926,29.126 22.984,29.118 z M 25.082,29.124 C 25.153,29.117 25.229,29.185 25.303,29.33 25.363,29.451 25.372,29.493 25.372,29.764 25.372,29.98 25.359,30.073 25.336,30.093 25.316,30.109 25.235,30.138 25.149,30.16 24.999,30.199 24.966,30.203 24.919,30.187 L 24.694,30.146 24.711,30.012 C 24.727,29.837 24.842,29.449 24.923,29.281 24.971,29.181 25.026,29.131 25.082,29.124 z M 24.104,29.127 C 24.151,29.125 24.173,29.136 24.203,29.169 24.274,29.253 24.364,29.501 24.421,29.766 24.497,30.139 24.497,30.138 24.334,30.187 24.263,30.209 24.113,30.232 24.006,30.238 23.653,30.256 23.626,30.235 23.669,29.923 23.703,29.645 23.84,29.207 23.899,29.175 23.963,29.141 24.037,29.142 24.104,29.127 z M 6.111,30.536 C 6.114,30.535 6.118,30.536 6.118,30.536 6.127,30.731 6.127,30.928 6.131,31.124 5.636,31.086 5.272,30.968 5.272,30.829 5.272,30.692 5.623,30.575 6.111,30.536 z M 6.976,30.553 C 7.377,30.603 7.654,30.708 7.649,30.829 7.649,30.951 7.381,31.055 6.983,31.104 6.979,30.921 6.979,30.737 6.976,30.553 z M 25.702,31.086 C 25.736,31.083 25.751,31.08 25.803,31.085 26.011,31.106 26.041,31.119 26.041,31.189 26.041,31.281 25.883,31.558 25.776,31.654 25.726,31.702 25.657,31.742 25.633,31.742 25.513,31.742 25.443,31.489 25.499,31.256 25.533,31.13 25.595,31.091 25.702,31.086 z M 24.947,31.169 C 25.04,31.161 25.13,31.186 25.22,31.198 25.194,31.461 25.076,31.676 24.857,31.819 24.803,31.819 24.776,31.716 24.776,31.491 24.776,31.223 24.79,31.172 24.947,31.169 z M 24.119,31.266 C 24.312,31.266 24.482,31.275 24.49,31.286 24.526,31.32 24.422,31.578 24.269,31.84 24.138,32.073 24.119,32.09 24.038,32.096 23.72,32.06 23.729,31.687 23.68,31.431 23.68,31.279 23.714,31.266 24.119,31.266 z M 21.11,31.295 C 21.331,31.299 21.417,31.332 21.417,31.417 21.417,31.525 21.335,31.74 21.288,31.767 21.217,31.806 21.211,31.804 21.071,31.658 20.85,31.41 20.825,31.364 21.11,31.295 z M 22.174,31.306 C 22.178,31.312 22.221,31.39 22.264,31.478 22.358,31.661 22.365,31.741 22.298,31.802 22.14,31.892 22.107,31.841 21.964,31.75 21.798,31.593 21.667,31.382 21.71,31.338 21.858,31.285 22.021,31.305 22.174,31.306 z M 22.596,31.311 22.991,31.318 C 23.145,31.318 23.278,31.326 23.285,31.338 23.312,31.362 23.225,31.876 23.178,31.992 23.124,32.122 22.935,32.123 22.837,31.969 22.697,31.748 22.605,31.562 22.602,31.434 L 22.596,31.311 z" /></g>')}}},{name:"@freesewing/plugin-mirror",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-mirror")&&t.attributes.set("freesewing:plugin-mirror","2.17.0")}},macros:{mirror:function({mirror:t,clone:e=!0,points:i=null,paths:s=null,prefix:n="mirrored",nameFormat:o}){const[r,a]=t,h=((t,e)=>{const[i,s,n]=((t,e)=>{const{x:i,y:s}=t,{x:n,y:o}=e,[r,a]=[-(o-s),n-i];return[r,a,-(r*i+a*s)]})(t,e);return t=>{const{x:e,y:o}=t,r=i**2+s**2;return[((s**2-i**2)*e-2*i*s*o-2*i*n)/r,((i**2-s**2)*o-2*i*s*e-2*s*n)/r]}})(r,a),p=["from","to","cp1","cp2"];null!==s&&s.forEach(((t,i)=>{let s=null;for(let e of Object.keys(this.paths))if(this.paths[e]===t){s=e;break}t=e?t.clone():t,e&&(null===s&&"function"==typeof o?this.paths[o(t)]=t:this.paths[`${n}${ft(s)}`]=t);for(let e in t.ops)for(let i of p){const s=t.ops[e][i];void 0!==s&&([s.x,s.y]=h(s),s.attributes.set("mirrored",!0))}})),null!==i&&i.forEach((t=>{let i=null;for(let e of Object.keys(this.points))if(this.points[e]===t){i=e;break}e&&(t=t.clone(),null===i&&"function"==typeof o?this.points[o(t)]=t:this.points[`${n}${ft(i)}`]=t),[t.x,t.y]=h(t),t.attributes.set("mirrored",!0)}))}}},{name:"@freesewing/plugin-notches",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-notches")&&(t.defs+='<g id="notch"><circle cy="0" cx="0" r="1.4" class="fill-note" /><circle cy="0" cx="0" r="2.8" class="note" /></g><g id="bnotch"><path d="M -1.1 -1.1 L 1.1 1.1 M 1.1 -1.1 L -1.1 1.1" class="note stroke-xl" /><circle cy="0" cx="0" r="2.8" class="note" /></g>',t.attributes.add("freesewing:plugin-notches","2.17.0"))}}},{name:"@freesewing/plugin-title",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-title")&&(t.attributes.set("freesewing:plugin-title","2.17.0"),t.style+="text.title-nr{font-size:24pt;font-weight:700;text-anchor:middle;dominant-baseline:reset-size}text.title-name{font-size:7pt;font-weight:500;text-anchor:middle;dominant-baseline:reset-size}text.title-pattern{font-size:4pt;font-weight:500;dominant-baseline:reset-size;text-anchor:middle;font-style:italic}")}},macros:{title:function(t){const e=function(e){let i=e.x-t.scale*e.x,s=e.y-t.scale*e.y;return`matrix(${t.scale}, 0, 0, ${t.scale}, ${i}, ${s}) rotate(${t.rotation} ${e.x} ${e.y})`};let i=!0;(t={scale:1,rotation:0,...t}).append&&(i=!1);let s="";t.prefix&&(s=t.prefix),this.points[`_${s}_titleNr`]=t.at.clone().attr("data-text",t.nr,i).attr("data-text-class","title-nr note fill-note").attr("data-text-transform",e(t.at));let n=10;if(t.title&&(this.points[`_${s}_titleName`]=t.at.shift(-90-t.rotation,13*t.scale).attr("data-text",t.title).attr("data-text-class","title-name").attr("data-text-transform",e(t.at.shift(-90-t.rotation,13*t.scale))),n+=10),this.points[`_${s}_titlePattern`]=t.at.shift(-90-t.rotation,n*t.scale).attr("data-text",this.context.config.name).attr("data-text","v"+this.context.config.version).attr("data-text-class","title-pattern fill-note").attr("data-text-transform",e(t.at.shift(-90-t.rotation,n*t.scale))),this.context.settings.metadata&&this.context.settings.metadata.for&&(n+=8,this.points[`_${s}_titleFor`]=t.at.shift(-90-t.rotation,n*t.scale).attr("data-text","( "+this.context.settings.metadata.for+" )").attr("data-text-class","title-pattern").attr("data-text-transform",e(t.at.shift(-90-t.rotation,n*t.scale)))),this.context.config.cut&&this.context.config.cut[this.name]){n+=8;let i=`_${s}_titleCut`,o=this.context.config.cut[this.name];if(this.points[i]=t.at.shift(-90-t.rotation,n*t.scale).attr("data-text","cut").attr("data-text-class","title-pattern").attr("data-text-transform",e(t.at.shift(-90-t.rotation,n*t.scale))),"number"==typeof o)this.points[i].attr("data-text",` ${o}x`);else if(Array.isArray(o)){o=Array.from(o),this.points[i].attr("data-text",` ${o.shift()}x`);for(const t of o)this.points[i].attr("data-text",t)}}}}},{name:"@freesewing/plugin-scalebox",version:"2.17.0",hooks:{preRender:function(t){t.attributes.set("freesewing:plugin-scalebox","2.17.0")}},macros:{scalebox:function(t){if(!1===t){for(let t of["__scaleboxMetricTopLeft","__scaleboxMetricTopRight","__scaleboxMetricBottomRight","__scaleboxMetricBottomLeft","__scaleboxImperialTopLeft","__scaleboxImperialTopRight","__scaleboxImperialBottomRight","__scaleboxImperialBottomLeft","__scaleboxLead","__scaleboxTitle","__scaleboxText","__scaleboxLink","__scaleboxMetric","__scaleboxImperial"])delete this.points[t];for(let t of["__scaleboxMetric","__scaleboxImperial"])delete this.paths[t];return!0}if(this.points.__scaleboxMetricTopLeft=new this.Point(t.at.x-50,t.at.y-25),this.points.__scaleboxMetricTopRight=new this.Point(t.at.x+50,t.at.y-25),this.points.__scaleboxMetricBottomLeft=new this.Point(t.at.x-50,t.at.y+25),this.points.__scaleboxMetricBottomRight=new this.Point(t.at.x+50,t.at.y+25),this.points.__scaleboxImperialTopLeft=new this.Point(t.at.x-50.8,t.at.y-25.4),this.points.__scaleboxImperialTopRight=new this.Point(t.at.x+50.8,t.at.y-25.4),this.points.__scaleboxImperialBottomLeft=new this.Point(t.at.x-50.8,t.at.y+25.4),this.points.__scaleboxImperialBottomRight=new this.Point(t.at.x+50.8,t.at.y+25.4),this.points.__scaleboxLead=new this.Point(t.at.x-45,t.at.y-15),this.points.__scaleboxTitle=this.points.__scaleboxLead.shift(-90,10),this.points.__scaleboxText=this.points.__scaleboxTitle.shift(-90,12),this.points.__scaleboxLink=this.points.__scaleboxText.shift(-90,5),this.points.__scaleboxMetric=new this.Point(t.at.x,t.at.y+20),this.points.__scaleboxImperial=new this.Point(t.at.x,t.at.y+24),t.rotate){let e=["__scaleboxMetricTopLeft","__scaleboxMetricTopRight","__scaleboxMetricBottomLeft","__scaleboxMetricBottomRight","__scaleboxImperialTopLeft","__scaleboxImperialTopRight","__scaleboxImperialBottomLeft","__scaleboxImperialBottomRight","__scaleboxLead","__scaleboxTitle","__scaleboxText","__scaleboxLink","__scaleboxMetric","__scaleboxImperial"];for(let i of e)this.points[i]=this.points[i].rotate(t.rotate,t.at);for(let i of e.slice(8))this.points[i].attributes.set("data-text-transform",`rotate(${-1*t.rotate}, ${this.points[i].x}, ${this.points[i].y})`)}this.paths.__scaleboxImperial=(new this.Path).attr("class","scalebox imperial").move(this.points.__scaleboxImperialTopLeft).line(this.points.__scaleboxImperialBottomLeft).line(this.points.__scaleboxImperialBottomRight).line(this.points.__scaleboxImperialTopRight).close(),this.paths.__scaleboxMetric=(new this.Path).attr("class","scalebox metric").move(this.points.__scaleboxMetricTopLeft).line(this.points.__scaleboxMetricBottomLeft).line(this.points.__scaleboxMetricBottomRight).line(this.points.__scaleboxMetricTopRight).close(),this.points.__scaleboxLead=this.points.__scaleboxLead.attr("data-text",t.lead||"FreeSewing").attr("data-text-class","text-sm"),t.title?this.points.__scaleboxTitle.attributes.set("data-text",t.title):this.points.__scaleboxTitle=this.points.__scaleboxTitle.attr("data-text",this.context.config.name).attr("data-text","v"+this.context.config.version),this.points.__scaleboxTitle.attributes.add("data-text-class","text-lg"),"string"==typeof t.text?this.points.__scaleboxText.attr("data-text",t.text):(this.points.__scaleboxText.attr("data-text","supportFreesewingBecomeAPatron"),this.points.__scaleboxLink=this.points.__scaleboxLink.attr("data-text","freesewing.org/patrons/join").attr("data-text-class","text-xs fill-note")),this.points.__scaleboxText.attr("data-text-class","text-xs").attr("data-text-lineheight",4),this.points.__scaleboxMetric=this.points.__scaleboxMetric.attr("data-text","theWhiteInsideOfThisBoxShouldMeasure").attr("data-text","10cm").attr("data-text","x").attr("data-text","5cm").attr("data-text-class","text-xs center"),this.points.__scaleboxImperial=this.points.__scaleboxImperial.attr("data-text","theBlackOutsideOfThisBoxShouldMeasure").attr("data-text",'4"').attr("data-text","x").attr("data-text",'2"').attr("data-text-class","text-xs center ")},miniscale:function(t){if(!1===t){for(let t of["__miniscaleMetricTopLeft","__miniscaleMetricTopRight","__miniscaleMetricBottomRight","__miniscaleMetricBottomLeft","__miniscaleImperialTopLeft","__miniscaleImperialTopRight","__miniscaleImperialBottomRight","__miniscaleImperialBottomLeft","__miniscaleMetric","__miniscaleImperial"])delete this.points[t];for(let t of["__miniscaleMetric","__miniscaleImperial"])delete this.paths[t];return!0}const e=12.5,i=12.7;if(this.points.__miniscaleMetricTopLeft=new this.Point(t.at.x-e,t.at.y-e),this.points.__miniscaleMetricTopRight=new this.Point(t.at.x+e,t.at.y-e),this.points.__miniscaleMetricBottomLeft=new this.Point(t.at.x-e,t.at.y+e),this.points.__miniscaleMetricBottomRight=new this.Point(t.at.x+e,t.at.y+e),this.points.__miniscaleImperialTopLeft=new this.Point(t.at.x-i,t.at.y-i),this.points.__miniscaleImperialTopRight=new this.Point(t.at.x+i,t.at.y-i),this.points.__miniscaleImperialBottomLeft=new this.Point(t.at.x-i,t.at.y+i),this.points.__miniscaleImperialBottomRight=new this.Point(t.at.x+i,t.at.y+i),this.points.__miniscaleMetric=new this.Point(t.at.x,t.at.y-2),this.points.__miniscaleImperial=new this.Point(t.at.x,t.at.y+8),t.rotate){let e=["__miniscaleMetricTopLeft","__miniscaleMetricTopRight","__miniscaleMetricBottomLeft","__miniscaleMetricBottomRight","__miniscaleImperialTopLeft","__miniscaleImperialTopRight","__miniscaleImperialBottomLeft","__miniscaleImperialBottomRight","__miniscaleMetric","__miniscaleImperial"];for(let i of e)this.points[i]=this.points[i].rotate(t.rotate,t.at);for(let i of e.slice(8))this.points[i].attributes.set("data-text-transform",`rotate(${-1*t.rotate}, ${this.points[i].x}, ${this.points[i].y})`)}this.paths.__miniscaleImperial=(new this.Path).attr("class","scalebox imperial").move(this.points.__miniscaleImperialTopLeft).line(this.points.__miniscaleImperialBottomLeft).line(this.points.__miniscaleImperialBottomRight).line(this.points.__miniscaleImperialTopRight).close(),this.paths.__miniscaleMetric=(new this.Path).attr("class","scalebox metric").move(this.points.__miniscaleMetricTopLeft).line(this.points.__miniscaleMetricBottomLeft).line(this.points.__miniscaleMetricBottomRight).line(this.points.__miniscaleMetricTopRight).close(),this.points.__miniscaleMetric=this.points.__miniscaleMetric.attr("data-text","2.5cm x 2.5cm").attr("data-text-class","text-xs center"),this.points.__miniscaleImperial=this.points.__miniscaleImperial.attr("data-text",'1" x 1"').attr("data-text-class","text-xs center ")}}},{name:"@freesewing/plugin-round",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-round")&&t.attributes.set("freesewing:plugin-round","2.17.0")}},macros:{round:function(t){const e=.55191502449;let i=t.from,s=t.to,n=t.via,o=t.radius,r=t.prefix,a=i.angle(n),h=n.angle(s);(Math.round(a)-Math.round(h))%90!=0&&console.log("Warning: The round macro only handles 90 degree angles correctly.");let p=i.dist(n),l=s.dist(n);(o>p||o>l||void 0===o)&&(o=p>l?l:p),this.points[r+"Start"]=n.shiftTowards(i,o),this.points[r+"Cp1"]=n.shiftTowards(i,o*(1-e)),this.points[r+"Cp2"]=n.shiftTowards(s,o*(1-e)),this.points[r+"End"]=n.shiftTowards(s,o),this.paths[r+"Rounded"]=(new this.Path).move(this.points[r+"Start"]).curve(this.points[r+"Cp1"],this.points[r+"Cp2"],this.points[r+"End"]).attr("class",t.class?t.class:""),void 0!==t.render&&t.render?this.paths[r+"Rounded"].render=!0:this.paths[r+"Rounded"].render=!1}}},{name:"@freesewing/plugin-sprinkle",version:"2.17.0",hooks:{preRender:function(t){!1===t.attributes.get("freesewing:plugin-sprinkle")&&t.attributes.set("freesewing:plugin-sprinkle","2.17.0")}},macros:{sprinkle:function(t){for(let e of t.on)this.snippets[e+"-"+t.snippet]=new this.Snippet(t.snippet,this.points[e])}}},{name:"@freesewing/plugin-measurements",version:"2.17.0",hooks:{preDraft:function({settings:t}){void 0!==t.measurements.seatBack&&void 0!==t.measurements.seat&&(t.measurements.seatFront=t.measurements.seat-t.measurements.seatBack,t.measurements.seatBackArc=t.measurements.seatBack/2,t.measurements.seatFrontArc=t.measurements.seatFront/2),void 0!==t.measurements.waist&&void 0!==t.measurements.waistBack&&(t.measurements.waistBackArc=t.measurements.waistBack/2,t.measurements.waistFrontArc=(t.measurements.waist-t.measurements.waistBack)/2),void 0!==t.measurements.crossSeam&&void 0!==t.measurements.crossSeamFront&&(t.measurements.crossSeamBack=t.measurements.crossSeam-t.measurements.crossSeamFront)}}}];var yt={name:"@freesewing/plugin-bundle",version:"2.17.0",hooks:function(){let t={};for(let e of dt)for(let i in e.hooks){void 0===t[i]&&(t[i]=[]);let s=e.hooks[i];if("function"==typeof s)t[i].push(s);else if("object"==typeof s)for(let e of s)t[i].push(e)}return t}(),macros:function(){let t={};for(let e of dt)for(let i in e.macros)t[i]=e.macros[i];return t}()},xt={name:"18shift",version:"0.0.1",design:"Zee",code:"Zee",department:"womenswear",type:"pattern",difficulty:3,tags:["freesewing","design","diy","fashion","made to measure","parametric design","pattern","sewing","sewing pattern"],optionGroups:{fit:["size"]},measurements:[],dependencies:{},inject:{},hide:[],parts:["box"],options:{size:{pct:50,min:10,max:100}}};var gt=new rt.Design(xt,yt);gt.prototype.draftBox=function(t){var e=t.shorthand(),i=e.options,s=e.Point,n=e.Path,o=e.points,r=e.paths,a=e.Snippet,h=e.snippets,p=e.complete,l=e.sa,c=e.paperless,u=e.macro,f=500*i.size;return o.topLeft=new s(0,0),o.topRight=new s(f,0),o.bottomLeft=new s(0,f/2),o.bottomRight=new s(f,f/2),r.seam=(new n).move(o.topLeft).line(o.bottomLeft).line(o.bottomRight).line(o.topRight).line(o.topLeft).close().attr("class","fabric"),p&&(o.logo=o.topLeft.shiftFractionTowards(o.bottomRight,.5),h.logo=new a("logo",o.logo),o.text=o.logo.shift(-90,f/8).attr("data-text","hello").attr("data-text-class","center"),l&&(r.sa=r.seam.offset(l).attr("class","fabric sa"))),c&&(u("hd",{from:o.bottomLeft,to:o.bottomRight,y:o.bottomLeft.y+l+15}),u("vd",{from:o.bottomRight,to:o.topRight,x:o.topRight.x+l+15})),t};export default gt;
//# sourceMappingURL=index.es.js.map
