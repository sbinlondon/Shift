{"version":3,"file":"index.js","sources":["../src/withGist/index.js"],"sourcesContent":["import React from \"react\";\nimport storage from \"@freesewing/utils/storage\";\n\nconst withGist = (WrappedComponent, settings = { gist: {}, store: false }) => {\n  return class extends React.Component {\n    constructor(props) {\n      super(props);\n      this.setGist = this.setGist.bind(this);\n      this.importGist = this.importGist.bind(this);\n      this.updateGist = this.updateGist.bind(this);\n      this.state = { gist: settings.gist || {} };\n    }\n\n    setGist(gist) {\n      this.setState({ gist });\n      if (settings.store) storage.set(this.state.gist.name || \"gist\", gist);\n    }\n\n    importGist(gist) {\n      if (typeof this.state.gist.settings === \"undefined\")\n        this.updateGist({}, \"settings\");\n      if (typeof this.state.gist.settings.options === \"undefined\")\n        this.updateGist({}, \"settings\", \"options\");\n      if (typeof gist.settings !== \"undefined\") {\n        // Load settings\n        for (let key of Object.keys(gist.settings)) {\n          if (key !== \"options\")\n            this.updateGist(gist.settings[key], \"settings\", key);\n        }\n        if (typeof gist.settings.options !== \"undefined\") {\n          // Load options\n          for (let key of Object.keys(gist.settings.options)) {\n            this.updateGist(\n              gist.settings.options[key],\n              \"settings\",\n              \"options\",\n              key\n            );\n          }\n        }\n      }\n      // Load root level keys\n      for (let key of Object.keys(gist)) {\n        if (key !== \"settings\") this.updateGist(gist[key], key);\n      }\n    }\n\n    updateGist(value, l1 = false, l2 = false, l3 = false) {\n      if (!l1) return;\n      let gist = this.state.gist;\n\n      if (l2 && typeof gist[l1] === \"undefined\") gist[l1] = {};\n      if (l3 && typeof gist[l1][l2] === \"undefined\") gist[l1][l2] = {};\n\n      if (l3) gist[l1][l2][l3] = value;\n      else if (l2) gist[l1][l2] = value;\n      else gist[l1] = value;\n      this.setState({ gist });\n      if (settings.store) storage.set(this.state.gist.name || \"gist\", gist);\n    }\n\n    render() {\n      return (\n        <WrappedComponent\n          gist={this.state.gist}\n          importGist={this.importGist}\n          updateGist={this.updateGist}\n          {...this.props}\n        />\n      );\n    }\n  };\n};\n\nexport default withGist;\n"],"names":["withGist","WrappedComponent","settings","gist","store","props","setGist","bind","importGist","updateGist","state","setState","storage","set","name","options","Object","keys","key","value","l1","l2","l3","React","Component"],"mappings":"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"}