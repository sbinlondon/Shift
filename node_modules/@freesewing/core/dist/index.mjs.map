{"version":3,"file":"index.mjs","sources":["../src/attributes.js","../src/point.js","../../../node_modules/bezier-js/src/utils.js","../../../node_modules/bezier-js/src/poly-bezier.js","../../../node_modules/bezier-js/src/bezier.js","../src/path.js","../src/utils.js","../src/snippet.js","../src/hooks.js","../src/part.js","../src/svg.js","../../../node_modules/bin-pack/packer.growing.js","../../../node_modules/bin-pack/index.js","../src/store.js","../src/pattern.js","../src/design.js","../src/index.js"],"sourcesContent":["function Attributes() {\n  this.list = {}\n}\n\n/** Adds an attribute */\nAttributes.prototype.add = function (name, value) {\n  if (typeof this.list[name] === 'undefined') {\n    this.list[name] = []\n  }\n  this.list[name].push(value)\n\n  return this\n}\n\n/** Sets an attribute, overwriting existing value */\nAttributes.prototype.set = function (name, value) {\n  this.list[name] = [value]\n\n  return this\n}\n\n/** Removes an attribute */\nAttributes.prototype.remove = function (name) {\n  delete this.list[name]\n\n  return this\n}\n\n/** Retrieves an attribute */\nAttributes.prototype.get = function (name) {\n  if (typeof this.list[name] === 'undefined') return false\n  else return this.list[name].join(' ')\n}\n\n/** Retrieves an attribute as array*/\nAttributes.prototype.getAsArray = function (name) {\n  if (typeof this.list[name] === 'undefined') return false\n  else return this.list[name]\n}\n\n/** Returns SVG code for attributes */\nAttributes.prototype.render = function () {\n  let svg = ''\n  for (let key in this.list) {\n    svg += ` ${key}=\"${this.list[key].join(' ')}\"`\n  }\n\n  return svg\n}\n\n/** Returns CSS code for attributes */\nAttributes.prototype.renderAsCss = function () {\n  let css = ''\n  for (let key in this.list) {\n    css += ` ${key}:${this.list[key].join(' ')};`\n  }\n\n  return css\n}\n\n/** Returns SVG code for attributes with a fiven prefix\n * typically used for data-text*/\nAttributes.prototype.renderIfPrefixIs = function (prefix = '') {\n  let svg = ''\n  let prefixLen = prefix.length\n  for (let key in this.list) {\n    if (key.substr(0, prefixLen) === prefix) {\n      svg += ` ${key.substr(prefixLen)}=\"${this.list[key].join(' ')}\"`\n    }\n  }\n\n  return svg\n}\n\n/** Returns a props object for attributes with a fiven prefix\n * typically used for data-text*/\nAttributes.prototype.asPropsIfPrefixIs = function (prefix = '') {\n  let props = {}\n  let prefixLen = prefix.length\n  for (let key in this.list) {\n    if (key.substr(0, prefixLen) === prefix) {\n      let propKey = key.substr(prefixLen)\n      if (propKey === 'class') propKey = 'className'\n      props[propKey] = this.get(key)\n    }\n  }\n\n  return props\n}\n\n/** Returns a deep copy of this */\nAttributes.prototype.clone = function () {\n  let clone = new Attributes()\n  clone.list = JSON.parse(JSON.stringify(this.list))\n\n  return clone\n}\n\nexport default Attributes\n","import Attributes from './attributes'\n\nfunction Point(x, y, debug = false) {\n  this.x = x\n  this.y = y\n  this.attributes = new Attributes()\n  Object.defineProperty(this, 'debug', { value: debug, configurable: true })\n}\n\n/** Adds the raise method for a path not created through the proxy **/\nPoint.prototype.withRaise = function (raise = false) {\n  if (raise) Object.defineProperty(this, 'raise', { value: raise })\n\n  return this\n}\n\n/** Debug method to validate point data **/\nPoint.prototype.check = function () {\n  if (typeof this.x !== 'number') this.raise.warning('X value of `Point` is not a number')\n  if (typeof this.y !== 'number') this.raise.warning('Y value of `Point` is not a number')\n}\n\n/** Radians to degrees */\nPoint.prototype.rad2deg = function (radians) {\n  return radians * 57.29577951308232\n}\n\n/** Degrees to radians */\nPoint.prototype.deg2rad = function (degrees) {\n  return degrees / 57.29577951308232\n}\n\n/** Adds an attribute. This is here to make this call chainable in assignment */\nPoint.prototype.attr = function (name, value, overwrite = false) {\n  if (this.debug) this.check()\n  if (overwrite) this.attributes.set(name, value)\n  else this.attributes.add(name, value)\n\n  return this\n}\n\n/** Returns the distance between this point and that point */\nPoint.prototype.dist = function (that) {\n  if (this.debug) {\n    this.check()\n    that.check()\n  }\n  let dx = this.x - that.x\n  let dy = this.y - that.y\n\n  return Math.sqrt(Math.pow(dx, 2) + Math.pow(dy, 2))\n}\n\n/** Returns slope of a line made by this point and that point */\nPoint.prototype.slope = function (that) {\n  if (this.debug) {\n    this.check()\n    that.check()\n  }\n  return (that.y - this.y) / (that.x - this.x)\n}\n\n/** Returns the x-delta between this point and that point */\nPoint.prototype.dx = function (that) {\n  if (this.debug) {\n    this.check()\n    that.check()\n  }\n  return that.x - this.x\n}\n\n/** Returns the y-delta between this point and that point */\nPoint.prototype.dy = function (that) {\n  if (this.debug) {\n    this.check()\n    that.check()\n  }\n  return that.y - this.y\n}\n\n/** Returns the angle between this point and that point */\nPoint.prototype.angle = function (that) {\n  if (this.debug) {\n    this.check()\n    that.check()\n  }\n  let rad = Math.atan2(-1 * this.dy(that), this.dx(that))\n  while (rad < 0) rad += 2 * Math.PI\n\n  return this.rad2deg(rad)\n}\n\n/** Rotate this point deg around that point */\nPoint.prototype.rotate = function (deg, that) {\n  if (this.debug) {\n    this.check()\n    that.check()\n    if (typeof deg !== 'number')\n      this.raise.warning('Called `Point.rotate(deg,that)` but `deg` is not a number')\n    if (that instanceof Point !== true)\n      this.raise.warning('Called `Point.rotate(deg,that)` but `that` is not a `Point` object')\n  }\n  let radius = this.dist(that)\n  let angle = this.angle(that)\n  let x = that.x + radius * Math.cos(this.deg2rad(angle + deg)) * -1\n  let y = that.y + radius * Math.sin(this.deg2rad(angle + deg))\n\n  return new Point(x, y, this.debug).withRaise(this.raise)\n}\n\n/** returns an identical copy of this point */\nPoint.prototype.copy = function () {\n  if (this.debug) this.check()\n  return new Point(this.x, this.y, this.debug).withRaise(this.raise)\n}\n\n/** Mirrors this point around X value of that point */\nPoint.prototype.flipX = function (that = false) {\n  if (this.debug) {\n    this.check()\n    if (that) {\n      if (that instanceof Point !== true)\n        this.raise.warning('Called `Point.rotate(deg,that)` but `that` is not a `Point` object')\n      that.check()\n    }\n  }\n  if (that === false || that.x === 0)\n    return new Point(this.x * -1, this.y, this.debug).withRaise(this.raise)\n  else return new Point(that.x + this.dx(that), this.y, this.debug).withRaise(this.raise)\n}\n\n/** Mirrors this point around Y value of that point */\nPoint.prototype.flipY = function (that = false) {\n  if (this.debug) {\n    this.check()\n    if (that) {\n      if (that instanceof Point !== true)\n        this.raise.warning('Called `Point.flipY(that)` but `that` is not a `Point` object')\n      that.check()\n    }\n  }\n  if (that === false || that.y === 0)\n    return new Point(this.x, this.y * -1, this.debug).withRaise(this.raise)\n  else return new Point(this.x, that.y + this.dy(that), this.debug).withRaise(this.raise)\n}\n\n/** Shifts this point distance in the deg direction */\nPoint.prototype.shift = function (deg, distance) {\n  if (this.debug) {\n    this.check()\n    if (typeof distance !== 'number')\n      this.raise.warning('Called `Point.shift` but `distance` is not a number')\n  }\n  let p = this.copy()\n  p.x += distance\n\n  return p.rotate(deg, this)\n}\n\n/** Shifts this point distance in the direction of that point */\nPoint.prototype.shiftTowards = function (that, distance) {\n  if (this.debug) {\n    if (typeof distance !== 'number')\n      this.raise.warning('Called `Point.shiftTowards` but `distance` is not a number')\n    if (that instanceof Point !== true)\n      this.raise.warning(\n        'Called `Point.shiftTowards(that, distance)` but `that` is not a `Point` object'\n      )\n    this.check()\n    that.check()\n  }\n  if (this.debug) this.check()\n  return this.shift(this.angle(that), distance)\n}\n\n/** Checks whether this has the same coordinates as that */\nPoint.prototype.sitsOn = function (that) {\n  if (this.debug) {\n    if (that instanceof Point !== true)\n      this.raise.warning('Called `Point.sitsOn(that)` but `that` is not a `Point` object')\n    this.check()\n    that.check()\n  }\n  if (this.x === that.x && this.y === that.y) return true\n  else return false\n}\n\n/** Checks whether this has roughly the same coordinates as that */\nPoint.prototype.sitsRoughlyOn = function (that) {\n  if (this.debug) {\n    if (that instanceof Point !== true)\n      this.raise.warning('Called `Point.sitsRoughlyOn(that)` but `that` is not a `Point` object')\n    this.check()\n    that.check()\n  }\n  if (Math.round(this.x) === Math.round(that.x) && Math.round(this.y) === Math.round(that.y))\n    return true\n  else return false\n}\n\n/** Shifts this point fraction of the distance towards that point */\nPoint.prototype.shiftFractionTowards = function (that, fraction) {\n  if (this.debug) {\n    if (that instanceof Point !== true)\n      this.raise.warning(\n        'Called `Point.shiftFractionTowards(that, fraction)` but `that` is not a `Point` object'\n      )\n    if (typeof fraction !== 'number')\n      this.raise.warning('Called `Point.shiftFractionTowards` but `fraction` is not a number')\n    this.check()\n    that.check()\n  }\n  return this.shiftTowards(that, this.dist(that) * fraction)\n}\n\n/** Shifts this point distance beyond that point */\nPoint.prototype.shiftOutwards = function (that, distance) {\n  if (this.debug) {\n    if (that instanceof Point !== true)\n      this.raise.warning(\n        'Called `Point.shiftOutwards(that, distance)` but `that` is not a `Point` object'\n      )\n    if (typeof distance !== 'number')\n      this.raise.warning(\n        'Called `Point.shiftOutwards(that, distance)` but `distance` is not a number'\n      )\n    this.check()\n    that.check()\n  }\n  return this.shiftTowards(that, this.dist(that) + distance)\n}\n\n/** Returns a deep copy of this */\nPoint.prototype.clone = function () {\n  if (this.debug) this.check()\n  let clone = new Point(this.x, this.y, this.debug).withRaise(this.raise)\n  clone.attributes = this.attributes.clone()\n\n  return clone\n}\n\n/** Applies a translate transform */\nPoint.prototype.translate = function (x, y) {\n  if (this.debug) {\n    this.check()\n    if (typeof x !== 'number')\n      this.raise.warning('Called `Point.translate(x,y)` but `x` is not a number')\n    if (typeof y !== 'number')\n      this.raise.warning('Called `Point.translate(x,y)` but `y` is not a number')\n  }\n  let p = this.copy()\n  p.x += x\n  p.y += y\n\n  return p\n}\n\nexport default Point\n","import { Bezier } from \"./bezier.js\";\n\n// math-inlining.\nconst { abs, cos, sin, acos, atan2, sqrt, pow } = Math;\n\n// cube root function yielding real roots\nfunction crt(v) {\n  return v < 0 ? -pow(-v, 1 / 3) : pow(v, 1 / 3);\n}\n\n// trig constants\nconst pi = Math.PI,\n  tau = 2 * pi,\n  quart = pi / 2,\n  // float precision significant decimal\n  epsilon = 0.000001,\n  // extremas used in bbox calculation and similar algorithms\n  nMax = Number.MAX_SAFE_INTEGER || 9007199254740991,\n  nMin = Number.MIN_SAFE_INTEGER || -9007199254740991,\n  // a zero coordinate, which is surprisingly useful\n  ZERO = { x: 0, y: 0, z: 0 };\n\n// Bezier utility functions\nconst utils = {\n  // Legendre-Gauss abscissae with n=24 (x_i values, defined at i=n as the roots of the nth order Legendre polynomial Pn(x))\n  Tvalues: [\n    -0.0640568928626056260850430826247450385909,\n    0.0640568928626056260850430826247450385909,\n    -0.1911188674736163091586398207570696318404,\n    0.1911188674736163091586398207570696318404,\n    -0.3150426796961633743867932913198102407864,\n    0.3150426796961633743867932913198102407864,\n    -0.4337935076260451384870842319133497124524,\n    0.4337935076260451384870842319133497124524,\n    -0.5454214713888395356583756172183723700107,\n    0.5454214713888395356583756172183723700107,\n    -0.6480936519369755692524957869107476266696,\n    0.6480936519369755692524957869107476266696,\n    -0.7401241915785543642438281030999784255232,\n    0.7401241915785543642438281030999784255232,\n    -0.8200019859739029219539498726697452080761,\n    0.8200019859739029219539498726697452080761,\n    -0.8864155270044010342131543419821967550873,\n    0.8864155270044010342131543419821967550873,\n    -0.9382745520027327585236490017087214496548,\n    0.9382745520027327585236490017087214496548,\n    -0.9747285559713094981983919930081690617411,\n    0.9747285559713094981983919930081690617411,\n    -0.9951872199970213601799974097007368118745,\n    0.9951872199970213601799974097007368118745,\n  ],\n\n  // Legendre-Gauss weights with n=24 (w_i values, defined by a function linked to in the Bezier primer article)\n  Cvalues: [\n    0.1279381953467521569740561652246953718517,\n    0.1279381953467521569740561652246953718517,\n    0.1258374563468282961213753825111836887264,\n    0.1258374563468282961213753825111836887264,\n    0.121670472927803391204463153476262425607,\n    0.121670472927803391204463153476262425607,\n    0.1155056680537256013533444839067835598622,\n    0.1155056680537256013533444839067835598622,\n    0.1074442701159656347825773424466062227946,\n    0.1074442701159656347825773424466062227946,\n    0.0976186521041138882698806644642471544279,\n    0.0976186521041138882698806644642471544279,\n    0.086190161531953275917185202983742667185,\n    0.086190161531953275917185202983742667185,\n    0.0733464814110803057340336152531165181193,\n    0.0733464814110803057340336152531165181193,\n    0.0592985849154367807463677585001085845412,\n    0.0592985849154367807463677585001085845412,\n    0.0442774388174198061686027482113382288593,\n    0.0442774388174198061686027482113382288593,\n    0.0285313886289336631813078159518782864491,\n    0.0285313886289336631813078159518782864491,\n    0.0123412297999871995468056670700372915759,\n    0.0123412297999871995468056670700372915759,\n  ],\n\n  arcfn: function (t, derivativeFn) {\n    const d = derivativeFn(t);\n    let l = d.x * d.x + d.y * d.y;\n    if (typeof d.z !== \"undefined\") {\n      l += d.z * d.z;\n    }\n    return sqrt(l);\n  },\n\n  compute: function (t, points, _3d) {\n    // shortcuts\n    if (t === 0) {\n      points[0].t = 0;\n      return points[0];\n    }\n\n    const order = points.length - 1;\n\n    if (t === 1) {\n      points[order].t = 1;\n      return points[order];\n    }\n\n    const mt = 1 - t;\n    let p = points;\n\n    // constant?\n    if (order === 0) {\n      points[0].t = t;\n      return points[0];\n    }\n\n    // linear?\n    if (order === 1) {\n      const ret = {\n        x: mt * p[0].x + t * p[1].x,\n        y: mt * p[0].y + t * p[1].y,\n        t: t,\n      };\n      if (_3d) {\n        ret.z = mt * p[0].z + t * p[1].z;\n      }\n      return ret;\n    }\n\n    // quadratic/cubic curve?\n    if (order < 4) {\n      let mt2 = mt * mt,\n        t2 = t * t,\n        a,\n        b,\n        c,\n        d = 0;\n      if (order === 2) {\n        p = [p[0], p[1], p[2], ZERO];\n        a = mt2;\n        b = mt * t * 2;\n        c = t2;\n      } else if (order === 3) {\n        a = mt2 * mt;\n        b = mt2 * t * 3;\n        c = mt * t2 * 3;\n        d = t * t2;\n      }\n      const ret = {\n        x: a * p[0].x + b * p[1].x + c * p[2].x + d * p[3].x,\n        y: a * p[0].y + b * p[1].y + c * p[2].y + d * p[3].y,\n        t: t,\n      };\n      if (_3d) {\n        ret.z = a * p[0].z + b * p[1].z + c * p[2].z + d * p[3].z;\n      }\n      return ret;\n    }\n\n    // higher order curves: use de Casteljau's computation\n    const dCpts = JSON.parse(JSON.stringify(points));\n    while (dCpts.length > 1) {\n      for (let i = 0; i < dCpts.length - 1; i++) {\n        dCpts[i] = {\n          x: dCpts[i].x + (dCpts[i + 1].x - dCpts[i].x) * t,\n          y: dCpts[i].y + (dCpts[i + 1].y - dCpts[i].y) * t,\n        };\n        if (typeof dCpts[i].z !== \"undefined\") {\n          dCpts[i] = dCpts[i].z + (dCpts[i + 1].z - dCpts[i].z) * t;\n        }\n      }\n      dCpts.splice(dCpts.length - 1, 1);\n    }\n    dCpts[0].t = t;\n    return dCpts[0];\n  },\n\n  computeWithRatios: function (t, points, ratios, _3d) {\n    const mt = 1 - t,\n      r = ratios,\n      p = points;\n\n    let f1 = r[0],\n      f2 = r[1],\n      f3 = r[2],\n      f4 = r[3],\n      d;\n\n    // spec for linear\n    f1 *= mt;\n    f2 *= t;\n\n    if (p.length === 2) {\n      d = f1 + f2;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z) / d,\n        t: t,\n      };\n    }\n\n    // upgrade to quadratic\n    f1 *= mt;\n    f2 *= 2 * mt;\n    f3 *= t * t;\n\n    if (p.length === 3) {\n      d = f1 + f2 + f3;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y) / d,\n        z: !_3d ? false : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z) / d,\n        t: t,\n      };\n    }\n\n    // upgrade to cubic\n    f1 *= mt;\n    f2 *= 1.5 * mt;\n    f3 *= 3 * mt;\n    f4 *= t * t * t;\n\n    if (p.length === 4) {\n      d = f1 + f2 + f3 + f4;\n      return {\n        x: (f1 * p[0].x + f2 * p[1].x + f3 * p[2].x + f4 * p[3].x) / d,\n        y: (f1 * p[0].y + f2 * p[1].y + f3 * p[2].y + f4 * p[3].y) / d,\n        z: !_3d\n          ? false\n          : (f1 * p[0].z + f2 * p[1].z + f3 * p[2].z + f4 * p[3].z) / d,\n        t: t,\n      };\n    }\n  },\n\n  derive: function (points, _3d) {\n    const dpoints = [];\n    for (let p = points, d = p.length, c = d - 1; d > 1; d--, c--) {\n      const list = [];\n      for (let j = 0, dpt; j < c; j++) {\n        dpt = {\n          x: c * (p[j + 1].x - p[j].x),\n          y: c * (p[j + 1].y - p[j].y),\n        };\n        if (_3d) {\n          dpt.z = c * (p[j + 1].z - p[j].z);\n        }\n        list.push(dpt);\n      }\n      dpoints.push(list);\n      p = list;\n    }\n    return dpoints;\n  },\n\n  between: function (v, m, M) {\n    return (\n      (m <= v && v <= M) ||\n      utils.approximately(v, m) ||\n      utils.approximately(v, M)\n    );\n  },\n\n  approximately: function (a, b, precision) {\n    return abs(a - b) <= (precision || epsilon);\n  },\n\n  length: function (derivativeFn) {\n    const z = 0.5,\n      len = utils.Tvalues.length;\n\n    let sum = 0;\n\n    for (let i = 0, t; i < len; i++) {\n      t = z * utils.Tvalues[i] + z;\n      sum += utils.Cvalues[i] * utils.arcfn(t, derivativeFn);\n    }\n    return z * sum;\n  },\n\n  map: function (v, ds, de, ts, te) {\n    const d1 = de - ds,\n      d2 = te - ts,\n      v2 = v - ds,\n      r = v2 / d1;\n    return ts + d2 * r;\n  },\n\n  lerp: function (r, v1, v2) {\n    const ret = {\n      x: v1.x + r * (v2.x - v1.x),\n      y: v1.y + r * (v2.y - v1.y),\n    };\n    if (v1.z !== undefined && v2.z !== undefined) {\n      ret.z = v1.z + r * (v2.z - v1.z);\n    }\n    return ret;\n  },\n\n  pointToString: function (p) {\n    let s = p.x + \"/\" + p.y;\n    if (typeof p.z !== \"undefined\") {\n      s += \"/\" + p.z;\n    }\n    return s;\n  },\n\n  pointsToString: function (points) {\n    return \"[\" + points.map(utils.pointToString).join(\", \") + \"]\";\n  },\n\n  copy: function (obj) {\n    return JSON.parse(JSON.stringify(obj));\n  },\n\n  angle: function (o, v1, v2) {\n    const dx1 = v1.x - o.x,\n      dy1 = v1.y - o.y,\n      dx2 = v2.x - o.x,\n      dy2 = v2.y - o.y,\n      cross = dx1 * dy2 - dy1 * dx2,\n      dot = dx1 * dx2 + dy1 * dy2;\n    return atan2(cross, dot);\n  },\n\n  // round as string, to avoid rounding errors\n  round: function (v, d) {\n    const s = \"\" + v;\n    const pos = s.indexOf(\".\");\n    return parseFloat(s.substring(0, pos + 1 + d));\n  },\n\n  dist: function (p1, p2) {\n    const dx = p1.x - p2.x,\n      dy = p1.y - p2.y;\n    return sqrt(dx * dx + dy * dy);\n  },\n\n  closest: function (LUT, point) {\n    let mdist = pow(2, 63),\n      mpos,\n      d;\n    LUT.forEach(function (p, idx) {\n      d = utils.dist(point, p);\n      if (d < mdist) {\n        mdist = d;\n        mpos = idx;\n      }\n    });\n    return { mdist: mdist, mpos: mpos };\n  },\n\n  abcratio: function (t, n) {\n    // see ratio(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n    const bottom = pow(t, n) + pow(1 - t, n),\n      top = bottom - 1;\n    return abs(top / bottom);\n  },\n\n  projectionratio: function (t, n) {\n    // see u(t) note on http://pomax.github.io/bezierinfo/#abc\n    if (n !== 2 && n !== 3) {\n      return false;\n    }\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    } else if (t === 0 || t === 1) {\n      return t;\n    }\n    const top = pow(1 - t, n),\n      bottom = pow(t, n) + top;\n    return top / bottom;\n  },\n\n  lli8: function (x1, y1, x2, y2, x3, y3, x4, y4) {\n    const nx =\n        (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n      ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n      d = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n    if (d == 0) {\n      return false;\n    }\n    return { x: nx / d, y: ny / d };\n  },\n\n  lli4: function (p1, p2, p3, p4) {\n    const x1 = p1.x,\n      y1 = p1.y,\n      x2 = p2.x,\n      y2 = p2.y,\n      x3 = p3.x,\n      y3 = p3.y,\n      x4 = p4.x,\n      y4 = p4.y;\n    return utils.lli8(x1, y1, x2, y2, x3, y3, x4, y4);\n  },\n\n  lli: function (v1, v2) {\n    return utils.lli4(v1, v1.c, v2, v2.c);\n  },\n\n  makeline: function (p1, p2) {\n    const x1 = p1.x,\n      y1 = p1.y,\n      x2 = p2.x,\n      y2 = p2.y,\n      dx = (x2 - x1) / 3,\n      dy = (y2 - y1) / 3;\n    return new Bezier(\n      x1,\n      y1,\n      x1 + dx,\n      y1 + dy,\n      x1 + 2 * dx,\n      y1 + 2 * dy,\n      x2,\n      y2\n    );\n  },\n\n  findbbox: function (sections) {\n    let mx = nMax,\n      my = nMax,\n      MX = nMin,\n      MY = nMin;\n    sections.forEach(function (s) {\n      const bbox = s.bbox();\n      if (mx > bbox.x.min) mx = bbox.x.min;\n      if (my > bbox.y.min) my = bbox.y.min;\n      if (MX < bbox.x.max) MX = bbox.x.max;\n      if (MY < bbox.y.max) MY = bbox.y.max;\n    });\n    return {\n      x: { min: mx, mid: (mx + MX) / 2, max: MX, size: MX - mx },\n      y: { min: my, mid: (my + MY) / 2, max: MY, size: MY - my },\n    };\n  },\n\n  shapeintersections: function (\n    s1,\n    bbox1,\n    s2,\n    bbox2,\n    curveIntersectionThreshold\n  ) {\n    if (!utils.bboxoverlap(bbox1, bbox2)) return [];\n    const intersections = [];\n    const a1 = [s1.startcap, s1.forward, s1.back, s1.endcap];\n    const a2 = [s2.startcap, s2.forward, s2.back, s2.endcap];\n    a1.forEach(function (l1) {\n      if (l1.virtual) return;\n      a2.forEach(function (l2) {\n        if (l2.virtual) return;\n        const iss = l1.intersects(l2, curveIntersectionThreshold);\n        if (iss.length > 0) {\n          iss.c1 = l1;\n          iss.c2 = l2;\n          iss.s1 = s1;\n          iss.s2 = s2;\n          intersections.push(iss);\n        }\n      });\n    });\n    return intersections;\n  },\n\n  makeshape: function (forward, back, curveIntersectionThreshold) {\n    const bpl = back.points.length;\n    const fpl = forward.points.length;\n    const start = utils.makeline(back.points[bpl - 1], forward.points[0]);\n    const end = utils.makeline(forward.points[fpl - 1], back.points[0]);\n    const shape = {\n      startcap: start,\n      forward: forward,\n      back: back,\n      endcap: end,\n      bbox: utils.findbbox([start, forward, back, end]),\n    };\n    shape.intersections = function (s2) {\n      return utils.shapeintersections(\n        shape,\n        shape.bbox,\n        s2,\n        s2.bbox,\n        curveIntersectionThreshold\n      );\n    };\n    return shape;\n  },\n\n  getminmax: function (curve, d, list) {\n    if (!list) return { min: 0, max: 0 };\n    let min = nMax,\n      max = nMin,\n      t,\n      c;\n    if (list.indexOf(0) === -1) {\n      list = [0].concat(list);\n    }\n    if (list.indexOf(1) === -1) {\n      list.push(1);\n    }\n    for (let i = 0, len = list.length; i < len; i++) {\n      t = list[i];\n      c = curve.get(t);\n      if (c[d] < min) {\n        min = c[d];\n      }\n      if (c[d] > max) {\n        max = c[d];\n      }\n    }\n    return { min: min, mid: (min + max) / 2, max: max, size: max - min };\n  },\n\n  align: function (points, line) {\n    const tx = line.p1.x,\n      ty = line.p1.y,\n      a = -atan2(line.p2.y - ty, line.p2.x - tx),\n      d = function (v) {\n        return {\n          x: (v.x - tx) * cos(a) - (v.y - ty) * sin(a),\n          y: (v.x - tx) * sin(a) + (v.y - ty) * cos(a),\n        };\n      };\n    return points.map(d);\n  },\n\n  roots: function (points, line) {\n    line = line || { p1: { x: 0, y: 0 }, p2: { x: 1, y: 0 } };\n\n    const order = points.length - 1;\n    const aligned = utils.align(points, line);\n    const reduce = function (t) {\n      return 0 <= t && t <= 1;\n    };\n\n    if (order === 2) {\n      const a = aligned[0].y,\n        b = aligned[1].y,\n        c = aligned[2].y,\n        d = a - 2 * b + c;\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n          m2 = -a + b,\n          v1 = -(m1 + m2) / d,\n          v2 = -(-m1 + m2) / d;\n        return [v1, v2].filter(reduce);\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * b - 2 * c)].filter(reduce);\n      }\n      return [];\n    }\n\n    // see http://www.trans4mind.com/personal_development/mathematics/polynomials/cubicAlgebra.htm\n    const pa = aligned[0].y,\n      pb = aligned[1].y,\n      pc = aligned[2].y,\n      pd = aligned[3].y;\n\n    let d = -pa + 3 * pb - 3 * pc + pd,\n      a = 3 * pa - 6 * pb + 3 * pc,\n      b = -3 * pa + 3 * pb,\n      c = pa;\n\n    if (utils.approximately(d, 0)) {\n      // this is not a cubic curve.\n      if (utils.approximately(a, 0)) {\n        // in fact, this is not a quadratic curve either.\n        if (utils.approximately(b, 0)) {\n          // in fact in fact, there are no solutions.\n          return [];\n        }\n        // linear solution:\n        return [-c / b].filter(reduce);\n      }\n      // quadratic solution:\n      const q = sqrt(b * b - 4 * a * c),\n        a2 = 2 * a;\n      return [(q - b) / a2, (-b - q) / a2].filter(reduce);\n    }\n\n    // at this point, we know we need a cubic solution:\n\n    a /= d;\n    b /= d;\n    c /= d;\n\n    const p = (3 * b - a * a) / 3,\n      p3 = p / 3,\n      q = (2 * a * a * a - 9 * a * b + 27 * c) / 27,\n      q2 = q / 2,\n      discriminant = q2 * q2 + p3 * p3 * p3;\n\n    let u1, v1, x1, x2, x3;\n    if (discriminant < 0) {\n      const mp3 = -p / 3,\n        mp33 = mp3 * mp3 * mp3,\n        r = sqrt(mp33),\n        t = -q / (2 * r),\n        cosphi = t < -1 ? -1 : t > 1 ? 1 : t,\n        phi = acos(cosphi),\n        crtr = crt(r),\n        t1 = 2 * crtr;\n      x1 = t1 * cos(phi / 3) - a / 3;\n      x2 = t1 * cos((phi + tau) / 3) - a / 3;\n      x3 = t1 * cos((phi + 2 * tau) / 3) - a / 3;\n      return [x1, x2, x3].filter(reduce);\n    } else if (discriminant === 0) {\n      u1 = q2 < 0 ? crt(-q2) : -crt(q2);\n      x1 = 2 * u1 - a / 3;\n      x2 = -u1 - a / 3;\n      return [x1, x2].filter(reduce);\n    } else {\n      const sd = sqrt(discriminant);\n      u1 = crt(-q2 + sd);\n      v1 = crt(q2 + sd);\n      return [u1 - v1 - a / 3].filter(reduce);\n    }\n  },\n\n  droots: function (p) {\n    // quadratic roots are easy\n    if (p.length === 3) {\n      const a = p[0],\n        b = p[1],\n        c = p[2],\n        d = a - 2 * b + c;\n      if (d !== 0) {\n        const m1 = -sqrt(b * b - a * c),\n          m2 = -a + b,\n          v1 = -(m1 + m2) / d,\n          v2 = -(-m1 + m2) / d;\n        return [v1, v2];\n      } else if (b !== c && d === 0) {\n        return [(2 * b - c) / (2 * (b - c))];\n      }\n      return [];\n    }\n\n    // linear roots are even easier\n    if (p.length === 2) {\n      const a = p[0],\n        b = p[1];\n      if (a !== b) {\n        return [a / (a - b)];\n      }\n      return [];\n    }\n\n    return [];\n  },\n\n  curvature: function (t, d1, d2, _3d, kOnly) {\n    let num,\n      dnm,\n      adk,\n      dk,\n      k = 0,\n      r = 0;\n\n    //\n    // We're using the following formula for curvature:\n    //\n    //              x'y\" - y'x\"\n    //   k(t) = ------------------\n    //           (x'² + y'²)^(3/2)\n    //\n    // from https://en.wikipedia.org/wiki/Radius_of_curvature#Definition\n    //\n    // With it corresponding 3D counterpart:\n    //\n    //          sqrt( (y'z\" - y\"z')² + (z'x\" - z\"x')² + (x'y\" - x\"y')²)\n    //   k(t) = -------------------------------------------------------\n    //                     (x'² + y'² + z'²)^(3/2)\n    //\n\n    const d = utils.compute(t, d1);\n    const dd = utils.compute(t, d2);\n    const qdsum = d.x * d.x + d.y * d.y;\n\n    if (_3d) {\n      num = sqrt(\n        pow(d.y * dd.z - dd.y * d.z, 2) +\n          pow(d.z * dd.x - dd.z * d.x, 2) +\n          pow(d.x * dd.y - dd.x * d.y, 2)\n      );\n      dnm = pow(qdsum + d.z * d.z, 3 / 2);\n    } else {\n      num = d.x * dd.y - d.y * dd.x;\n      dnm = pow(qdsum, 3 / 2);\n    }\n\n    if (num === 0 || dnm === 0) {\n      return { k: 0, r: 0 };\n    }\n\n    k = num / dnm;\n    r = dnm / num;\n\n    // We're also computing the derivative of kappa, because\n    // there is value in knowing the rate of change for the\n    // curvature along the curve. And we're just going to\n    // ballpark it based on an epsilon.\n    if (!kOnly) {\n      // compute k'(t) based on the interval before, and after it,\n      // to at least try to not introduce forward/backward pass bias.\n      const pk = utils.curvature(t - 0.001, d1, d2, _3d, true).k;\n      const nk = utils.curvature(t + 0.001, d1, d2, _3d, true).k;\n      dk = (nk - k + (k - pk)) / 2;\n      adk = (abs(nk - k) + abs(k - pk)) / 2;\n    }\n\n    return { k: k, r: r, dk: dk, adk: adk };\n  },\n\n  inflections: function (points) {\n    if (points.length < 4) return [];\n\n    // FIXME: TODO: add in inflection abstraction for quartic+ curves?\n\n    const p = utils.align(points, { p1: points[0], p2: points.slice(-1)[0] }),\n      a = p[2].x * p[1].y,\n      b = p[3].x * p[1].y,\n      c = p[1].x * p[2].y,\n      d = p[3].x * p[2].y,\n      v1 = 18 * (-3 * a + 2 * b + 3 * c - d),\n      v2 = 18 * (3 * a - b - 3 * c),\n      v3 = 18 * (c - a);\n\n    if (utils.approximately(v1, 0)) {\n      if (!utils.approximately(v2, 0)) {\n        let t = -v3 / v2;\n        if (0 <= t && t <= 1) return [t];\n      }\n      return [];\n    }\n\n    const trm = v2 * v2 - 4 * v1 * v3,\n      sq = Math.sqrt(trm),\n      d2 = 2 * v1;\n\n    if (utils.approximately(d2, 0)) return [];\n\n    return [(sq - v2) / d2, -(v2 + sq) / d2].filter(function (r) {\n      return 0 <= r && r <= 1;\n    });\n  },\n\n  bboxoverlap: function (b1, b2) {\n    const dims = [\"x\", \"y\"],\n      len = dims.length;\n\n    for (let i = 0, dim, l, t, d; i < len; i++) {\n      dim = dims[i];\n      l = b1[dim].mid;\n      t = b2[dim].mid;\n      d = (b1[dim].size + b2[dim].size) / 2;\n      if (abs(l - t) >= d) return false;\n    }\n    return true;\n  },\n\n  expandbox: function (bbox, _bbox) {\n    if (_bbox.x.min < bbox.x.min) {\n      bbox.x.min = _bbox.x.min;\n    }\n    if (_bbox.y.min < bbox.y.min) {\n      bbox.y.min = _bbox.y.min;\n    }\n    if (_bbox.z && _bbox.z.min < bbox.z.min) {\n      bbox.z.min = _bbox.z.min;\n    }\n    if (_bbox.x.max > bbox.x.max) {\n      bbox.x.max = _bbox.x.max;\n    }\n    if (_bbox.y.max > bbox.y.max) {\n      bbox.y.max = _bbox.y.max;\n    }\n    if (_bbox.z && _bbox.z.max > bbox.z.max) {\n      bbox.z.max = _bbox.z.max;\n    }\n    bbox.x.mid = (bbox.x.min + bbox.x.max) / 2;\n    bbox.y.mid = (bbox.y.min + bbox.y.max) / 2;\n    if (bbox.z) {\n      bbox.z.mid = (bbox.z.min + bbox.z.max) / 2;\n    }\n    bbox.x.size = bbox.x.max - bbox.x.min;\n    bbox.y.size = bbox.y.max - bbox.y.min;\n    if (bbox.z) {\n      bbox.z.size = bbox.z.max - bbox.z.min;\n    }\n  },\n\n  pairiteration: function (c1, c2, curveIntersectionThreshold) {\n    const c1b = c1.bbox(),\n      c2b = c2.bbox(),\n      r = 100000,\n      threshold = curveIntersectionThreshold || 0.5;\n\n    if (\n      c1b.x.size + c1b.y.size < threshold &&\n      c2b.x.size + c2b.y.size < threshold\n    ) {\n      return [\n        (((r * (c1._t1 + c1._t2)) / 2) | 0) / r +\n          \"/\" +\n          (((r * (c2._t1 + c2._t2)) / 2) | 0) / r,\n      ];\n    }\n\n    let cc1 = c1.split(0.5),\n      cc2 = c2.split(0.5),\n      pairs = [\n        { left: cc1.left, right: cc2.left },\n        { left: cc1.left, right: cc2.right },\n        { left: cc1.right, right: cc2.right },\n        { left: cc1.right, right: cc2.left },\n      ];\n\n    pairs = pairs.filter(function (pair) {\n      return utils.bboxoverlap(pair.left.bbox(), pair.right.bbox());\n    });\n\n    let results = [];\n\n    if (pairs.length === 0) return results;\n\n    pairs.forEach(function (pair) {\n      results = results.concat(\n        utils.pairiteration(pair.left, pair.right, threshold)\n      );\n    });\n\n    results = results.filter(function (v, i) {\n      return results.indexOf(v) === i;\n    });\n\n    return results;\n  },\n\n  getccenter: function (p1, p2, p3) {\n    const dx1 = p2.x - p1.x,\n      dy1 = p2.y - p1.y,\n      dx2 = p3.x - p2.x,\n      dy2 = p3.y - p2.y,\n      dx1p = dx1 * cos(quart) - dy1 * sin(quart),\n      dy1p = dx1 * sin(quart) + dy1 * cos(quart),\n      dx2p = dx2 * cos(quart) - dy2 * sin(quart),\n      dy2p = dx2 * sin(quart) + dy2 * cos(quart),\n      // chord midpoints\n      mx1 = (p1.x + p2.x) / 2,\n      my1 = (p1.y + p2.y) / 2,\n      mx2 = (p2.x + p3.x) / 2,\n      my2 = (p2.y + p3.y) / 2,\n      // midpoint offsets\n      mx1n = mx1 + dx1p,\n      my1n = my1 + dy1p,\n      mx2n = mx2 + dx2p,\n      my2n = my2 + dy2p,\n      // intersection of these lines:\n      arc = utils.lli8(mx1, my1, mx1n, my1n, mx2, my2, mx2n, my2n),\n      r = utils.dist(arc, p1);\n\n    // arc start/end values, over mid point:\n    let s = atan2(p1.y - arc.y, p1.x - arc.x),\n      m = atan2(p2.y - arc.y, p2.x - arc.x),\n      e = atan2(p3.y - arc.y, p3.x - arc.x),\n      _;\n\n    // determine arc direction (cw/ccw correction)\n    if (s < e) {\n      // if s<m<e, arc(s, e)\n      // if m<s<e, arc(e, s + tau)\n      // if s<e<m, arc(e, s + tau)\n      if (s > m || m > e) {\n        s += tau;\n      }\n      if (s > e) {\n        _ = e;\n        e = s;\n        s = _;\n      }\n    } else {\n      // if e<m<s, arc(e, s)\n      // if m<e<s, arc(s, e + tau)\n      // if e<s<m, arc(s, e + tau)\n      if (e < m && m < s) {\n        _ = e;\n        e = s;\n        s = _;\n      } else {\n        e += tau;\n      }\n    }\n    // assign and done.\n    arc.s = s;\n    arc.e = e;\n    arc.r = r;\n    return arc;\n  },\n\n  numberSort: function (a, b) {\n    return a - b;\n  },\n};\n\nexport { utils };\n","import { utils } from \"./utils.js\";\n\n/**\n * Poly Bezier\n * @param {[type]} curves [description]\n */\nclass PolyBezier {\n  constructor(curves) {\n    this.curves = [];\n    this._3d = false;\n    if (!!curves) {\n      this.curves = curves;\n      this._3d = this.curves[0]._3d;\n    }\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n\n  toString() {\n    return (\n      \"[\" +\n      this.curves\n        .map(function (curve) {\n          return utils.pointsToString(curve.points);\n        })\n        .join(\", \") +\n      \"]\"\n    );\n  }\n\n  addCurve(curve) {\n    this.curves.push(curve);\n    this._3d = this._3d || curve._3d;\n  }\n\n  length() {\n    return this.curves\n      .map(function (v) {\n        return v.length();\n      })\n      .reduce(function (a, b) {\n        return a + b;\n      });\n  }\n\n  curve(idx) {\n    return this.curves[idx];\n  }\n\n  bbox() {\n    const c = this.curves;\n    var bbox = c[0].bbox();\n    for (var i = 1; i < c.length; i++) {\n      utils.expandbox(bbox, c[i].bbox());\n    }\n    return bbox;\n  }\n\n  offset(d) {\n    const offset = [];\n    this.curves.forEach(function (v) {\n      offset.push(...v.offset(d));\n    });\n    return new PolyBezier(offset);\n  }\n}\n\nexport { PolyBezier };\n","/**\n  A javascript Bezier curve library by Pomax.\n\n  Based on http://pomax.github.io/bezierinfo\n\n  This code is MIT licensed.\n**/\n\nimport { utils } from \"./utils.js\";\nimport { PolyBezier } from \"./poly-bezier.js\";\n\n// math-inlining.\nconst { abs, min, max, cos, sin, acos, sqrt } = Math;\nconst pi = Math.PI;\n// a zero coordinate, which is surprisingly useful\nconst ZERO = { x: 0, y: 0, z: 0 };\n\n/**\n * Bezier curve constructor.\n *\n * ...docs pending...\n */\nclass Bezier {\n  constructor(coords) {\n    let args =\n      coords && coords.forEach ? coords : Array.from(arguments).slice();\n    let coordlen = false;\n\n    if (typeof args[0] === \"object\") {\n      coordlen = args.length;\n      const newargs = [];\n      args.forEach(function (point) {\n        [\"x\", \"y\", \"z\"].forEach(function (d) {\n          if (typeof point[d] !== \"undefined\") {\n            newargs.push(point[d]);\n          }\n        });\n      });\n      args = newargs;\n    }\n\n    let higher = false;\n    const len = args.length;\n\n    if (coordlen) {\n      if (coordlen > 4) {\n        if (arguments.length !== 1) {\n          throw new Error(\n            \"Only new Bezier(point[]) is accepted for 4th and higher order curves\"\n          );\n        }\n        higher = true;\n      }\n    } else {\n      if (len !== 6 && len !== 8 && len !== 9 && len !== 12) {\n        if (arguments.length !== 1) {\n          throw new Error(\n            \"Only new Bezier(point[]) is accepted for 4th and higher order curves\"\n          );\n        }\n      }\n    }\n\n    const _3d = (this._3d =\n      (!higher && (len === 9 || len === 12)) ||\n      (coords && coords[0] && typeof coords[0].z !== \"undefined\"));\n\n    const points = (this.points = []);\n    for (let idx = 0, step = _3d ? 3 : 2; idx < len; idx += step) {\n      var point = {\n        x: args[idx],\n        y: args[idx + 1],\n      };\n      if (_3d) {\n        point.z = args[idx + 2];\n      }\n      points.push(point);\n    }\n    const order = (this.order = points.length - 1);\n\n    const dims = (this.dims = [\"x\", \"y\"]);\n    if (_3d) dims.push(\"z\");\n    this.dimlen = dims.length;\n\n    const aligned = utils.align(points, { p1: points[0], p2: points[order] });\n    this._linear = !aligned.some((p) => abs(p.y) > 0.0001);\n\n    this._lut = [];\n\n    this._t1 = 0;\n    this._t2 = 1;\n    this.update();\n  }\n\n  static quadraticFromPoints(p1, p2, p3, t) {\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    }\n    // shortcuts, although they're really dumb\n    if (t === 0) {\n      return new Bezier(p2, p2, p3);\n    }\n    if (t === 1) {\n      return new Bezier(p1, p2, p2);\n    }\n    // real fitting.\n    const abc = Bezier.getABC(2, p1, p2, p3, t);\n    return new Bezier(p1, abc.A, p3);\n  }\n\n  static cubicFromPoints(S, B, E, t, d1) {\n    if (typeof t === \"undefined\") {\n      t = 0.5;\n    }\n    const abc = Bezier.getABC(3, S, B, E, t);\n    if (typeof d1 === \"undefined\") {\n      d1 = utils.dist(B, abc.C);\n    }\n    const d2 = (d1 * (1 - t)) / t;\n\n    const selen = utils.dist(S, E),\n      lx = (E.x - S.x) / selen,\n      ly = (E.y - S.y) / selen,\n      bx1 = d1 * lx,\n      by1 = d1 * ly,\n      bx2 = d2 * lx,\n      by2 = d2 * ly;\n    // derivation of new hull coordinates\n    const e1 = { x: B.x - bx1, y: B.y - by1 },\n      e2 = { x: B.x + bx2, y: B.y + by2 },\n      A = abc.A,\n      v1 = { x: A.x + (e1.x - A.x) / (1 - t), y: A.y + (e1.y - A.y) / (1 - t) },\n      v2 = { x: A.x + (e2.x - A.x) / t, y: A.y + (e2.y - A.y) / t },\n      nc1 = { x: S.x + (v1.x - S.x) / t, y: S.y + (v1.y - S.y) / t },\n      nc2 = {\n        x: E.x + (v2.x - E.x) / (1 - t),\n        y: E.y + (v2.y - E.y) / (1 - t),\n      };\n    // ...done\n    return new Bezier(S, nc1, nc2, E);\n  }\n\n  static getUtils() {\n    return utils;\n  }\n\n  getUtils() {\n    return Bezier.getUtils();\n  }\n\n  static get PolyBezier() {\n    return PolyBezier;\n  }\n\n  valueOf() {\n    return this.toString();\n  }\n\n  toString() {\n    return utils.pointsToString(this.points);\n  }\n\n  toSVG() {\n    if (this._3d) return false;\n    const p = this.points,\n      x = p[0].x,\n      y = p[0].y,\n      s = [\"M\", x, y, this.order === 2 ? \"Q\" : \"C\"];\n    for (let i = 1, last = p.length; i < last; i++) {\n      s.push(p[i].x);\n      s.push(p[i].y);\n    }\n    return s.join(\" \");\n  }\n\n  setRatios(ratios) {\n    if (ratios.length !== this.points.length) {\n      throw new Error(\"incorrect number of ratio values\");\n    }\n    this.ratios = ratios;\n    this._lut = []; //  invalidate any precomputed LUT\n  }\n\n  verify() {\n    const print = this.coordDigest();\n    if (print !== this._print) {\n      this._print = print;\n      this.update();\n    }\n  }\n\n  coordDigest() {\n    return this.points\n      .map(function (c, pos) {\n        return \"\" + pos + c.x + c.y + (c.z ? c.z : 0);\n      })\n      .join(\"\");\n  }\n\n  update() {\n    // invalidate any precomputed LUT\n    this._lut = [];\n    this.dpoints = utils.derive(this.points, this._3d);\n    this.computedirection();\n  }\n\n  computedirection() {\n    const points = this.points;\n    const angle = utils.angle(points[0], points[this.order], points[1]);\n    this.clockwise = angle > 0;\n  }\n\n  length() {\n    return utils.length(this.derivative.bind(this));\n  }\n\n  static getABC(order = 2, S, B, E, t = 0.5) {\n    const u = utils.projectionratio(t, order),\n      um = 1 - u,\n      C = {\n        x: u * S.x + um * E.x,\n        y: u * S.y + um * E.y,\n      },\n      s = utils.abcratio(t, order),\n      A = {\n        x: B.x + (B.x - C.x) / s,\n        y: B.y + (B.y - C.y) / s,\n      };\n    return { A, B, C, S, E };\n  }\n\n  getABC(t, B) {\n    B = B || this.get(t);\n    let S = this.points[0];\n    let E = this.points[this.order];\n    return Bezier.getABC(this.order, S, B, E, t);\n  }\n\n  getLUT(steps) {\n    this.verify();\n    steps = steps || 100;\n    if (this._lut.length === steps) {\n      return this._lut;\n    }\n    this._lut = [];\n    // We want a range from 0 to 1 inclusive, so\n    // we decrement and then use <= rather than <:\n    steps--;\n    for (let i = 0, p, t; i < steps; i++) {\n      t = i / (steps - 1);\n      p = this.compute(t);\n      p.t = t;\n      this._lut.push(p);\n    }\n    return this._lut;\n  }\n\n  on(point, error) {\n    error = error || 5;\n    const lut = this.getLUT(),\n      hits = [];\n    for (let i = 0, c, t = 0; i < lut.length; i++) {\n      c = lut[i];\n      if (utils.dist(c, point) < error) {\n        hits.push(c);\n        t += i / lut.length;\n      }\n    }\n    if (!hits.length) return false;\n    return (t /= hits.length);\n  }\n\n  project(point) {\n    // step 1: coarse check\n    const LUT = this.getLUT(),\n      l = LUT.length - 1,\n      closest = utils.closest(LUT, point),\n      mpos = closest.mpos,\n      t1 = (mpos - 1) / l,\n      t2 = (mpos + 1) / l,\n      step = 0.1 / l;\n\n    // step 2: fine check\n    let mdist = closest.mdist,\n      t = t1,\n      ft = t,\n      p;\n    mdist += 1;\n    for (let d; t < t2 + step; t += step) {\n      p = this.compute(t);\n      d = utils.dist(point, p);\n      if (d < mdist) {\n        mdist = d;\n        ft = t;\n      }\n    }\n    ft = ft < 0 ? 0 : ft > 1 ? 1 : ft;\n    p = this.compute(ft);\n    p.t = ft;\n    p.d = mdist;\n    return p;\n  }\n\n  get(t) {\n    return this.compute(t);\n  }\n\n  point(idx) {\n    return this.points[idx];\n  }\n\n  compute(t) {\n    if (this.ratios) {\n      return utils.computeWithRatios(t, this.points, this.ratios, this._3d);\n    }\n    return utils.compute(t, this.points, this._3d, this.ratios);\n  }\n\n  raise() {\n    const p = this.points,\n      np = [p[0]],\n      k = p.length;\n    for (let i = 1, pi, pim; i < k; i++) {\n      pi = p[i];\n      pim = p[i - 1];\n      np[i] = {\n        x: ((k - i) / k) * pi.x + (i / k) * pim.x,\n        y: ((k - i) / k) * pi.y + (i / k) * pim.y,\n      };\n    }\n    np[k] = p[k - 1];\n    return new Bezier(np);\n  }\n\n  derivative(t) {\n    return utils.compute(t, this.dpoints[0], this._3d);\n  }\n\n  dderivative(t) {\n    return utils.compute(t, this.dpoints[1], this._3d);\n  }\n\n  align() {\n    let p = this.points;\n    return new Bezier(utils.align(p, { p1: p[0], p2: p[p.length - 1] }));\n  }\n\n  curvature(t) {\n    return utils.curvature(t, this.dpoints[0], this.dpoints[1], this._3d);\n  }\n\n  inflections() {\n    return utils.inflections(this.points);\n  }\n\n  normal(t) {\n    return this._3d ? this.__normal3(t) : this.__normal2(t);\n  }\n\n  __normal2(t) {\n    const d = this.derivative(t);\n    const q = sqrt(d.x * d.x + d.y * d.y);\n    return { x: -d.y / q, y: d.x / q };\n  }\n\n  __normal3(t) {\n    // see http://stackoverflow.com/questions/25453159\n    const r1 = this.derivative(t),\n      r2 = this.derivative(t + 0.01),\n      q1 = sqrt(r1.x * r1.x + r1.y * r1.y + r1.z * r1.z),\n      q2 = sqrt(r2.x * r2.x + r2.y * r2.y + r2.z * r2.z);\n    r1.x /= q1;\n    r1.y /= q1;\n    r1.z /= q1;\n    r2.x /= q2;\n    r2.y /= q2;\n    r2.z /= q2;\n    // cross product\n    const c = {\n      x: r2.y * r1.z - r2.z * r1.y,\n      y: r2.z * r1.x - r2.x * r1.z,\n      z: r2.x * r1.y - r2.y * r1.x,\n    };\n    const m = sqrt(c.x * c.x + c.y * c.y + c.z * c.z);\n    c.x /= m;\n    c.y /= m;\n    c.z /= m;\n    // rotation matrix\n    const R = [\n      c.x * c.x,\n      c.x * c.y - c.z,\n      c.x * c.z + c.y,\n      c.x * c.y + c.z,\n      c.y * c.y,\n      c.y * c.z - c.x,\n      c.x * c.z - c.y,\n      c.y * c.z + c.x,\n      c.z * c.z,\n    ];\n    // normal vector:\n    const n = {\n      x: R[0] * r1.x + R[1] * r1.y + R[2] * r1.z,\n      y: R[3] * r1.x + R[4] * r1.y + R[5] * r1.z,\n      z: R[6] * r1.x + R[7] * r1.y + R[8] * r1.z,\n    };\n    return n;\n  }\n\n  hull(t) {\n    let p = this.points,\n      _p = [],\n      q = [],\n      idx = 0;\n    q[idx++] = p[0];\n    q[idx++] = p[1];\n    q[idx++] = p[2];\n    if (this.order === 3) {\n      q[idx++] = p[3];\n    }\n    // we lerp between all points at each iteration, until we have 1 point left.\n    while (p.length > 1) {\n      _p = [];\n      for (let i = 0, pt, l = p.length - 1; i < l; i++) {\n        pt = utils.lerp(t, p[i], p[i + 1]);\n        q[idx++] = pt;\n        _p.push(pt);\n      }\n      p = _p;\n    }\n    return q;\n  }\n\n  split(t1, t2) {\n    // shortcuts\n    if (t1 === 0 && !!t2) {\n      return this.split(t2).left;\n    }\n    if (t2 === 1) {\n      return this.split(t1).right;\n    }\n\n    // no shortcut: use \"de Casteljau\" iteration.\n    const q = this.hull(t1);\n    const result = {\n      left:\n        this.order === 2\n          ? new Bezier([q[0], q[3], q[5]])\n          : new Bezier([q[0], q[4], q[7], q[9]]),\n      right:\n        this.order === 2\n          ? new Bezier([q[5], q[4], q[2]])\n          : new Bezier([q[9], q[8], q[6], q[3]]),\n      span: q,\n    };\n\n    // make sure we bind _t1/_t2 information!\n    result.left._t1 = utils.map(0, 0, 1, this._t1, this._t2);\n    result.left._t2 = utils.map(t1, 0, 1, this._t1, this._t2);\n    result.right._t1 = utils.map(t1, 0, 1, this._t1, this._t2);\n    result.right._t2 = utils.map(1, 0, 1, this._t1, this._t2);\n\n    // if we have no t2, we're done\n    if (!t2) {\n      return result;\n    }\n\n    // if we have a t2, split again:\n    t2 = utils.map(t2, t1, 1, 0, 1);\n    return result.right.split(t2).left;\n  }\n\n  extrema() {\n    const result = {};\n    let roots = [];\n\n    this.dims.forEach(\n      function (dim) {\n        let mfn = function (v) {\n          return v[dim];\n        };\n        let p = this.dpoints[0].map(mfn);\n        result[dim] = utils.droots(p);\n        if (this.order === 3) {\n          p = this.dpoints[1].map(mfn);\n          result[dim] = result[dim].concat(utils.droots(p));\n        }\n        result[dim] = result[dim].filter(function (t) {\n          return t >= 0 && t <= 1;\n        });\n        roots = roots.concat(result[dim].sort(utils.numberSort));\n      }.bind(this)\n    );\n\n    result.values = roots.sort(utils.numberSort).filter(function (v, idx) {\n      return roots.indexOf(v) === idx;\n    });\n\n    return result;\n  }\n\n  bbox() {\n    const extrema = this.extrema(),\n      result = {};\n    this.dims.forEach(\n      function (d) {\n        result[d] = utils.getminmax(this, d, extrema[d]);\n      }.bind(this)\n    );\n    return result;\n  }\n\n  overlaps(curve) {\n    const lbbox = this.bbox(),\n      tbbox = curve.bbox();\n    return utils.bboxoverlap(lbbox, tbbox);\n  }\n\n  offset(t, d) {\n    if (typeof d !== \"undefined\") {\n      const c = this.get(t),\n        n = this.normal(t);\n      const ret = {\n        c: c,\n        n: n,\n        x: c.x + n.x * d,\n        y: c.y + n.y * d,\n      };\n      if (this._3d) {\n        ret.z = c.z + n.z * d;\n      }\n      return ret;\n    }\n    if (this._linear) {\n      const nv = this.normal(0),\n        coords = this.points.map(function (p) {\n          const ret = {\n            x: p.x + t * nv.x,\n            y: p.y + t * nv.y,\n          };\n          if (p.z && nv.z) {\n            ret.z = p.z + t * nv.z;\n          }\n          return ret;\n        });\n      return [new Bezier(coords)];\n    }\n    return this.reduce().map(function (s) {\n      if (s._linear) {\n        return s.offset(t)[0];\n      }\n      return s.scale(t);\n    });\n  }\n\n  simple() {\n    if (this.order === 3) {\n      const a1 = utils.angle(this.points[0], this.points[3], this.points[1]);\n      const a2 = utils.angle(this.points[0], this.points[3], this.points[2]);\n      if ((a1 > 0 && a2 < 0) || (a1 < 0 && a2 > 0)) return false;\n    }\n    const n1 = this.normal(0);\n    const n2 = this.normal(1);\n    let s = n1.x * n2.x + n1.y * n2.y;\n    if (this._3d) {\n      s += n1.z * n2.z;\n    }\n    return abs(acos(s)) < pi / 3;\n  }\n\n  reduce() {\n    // TODO: examine these var types in more detail...\n    let i,\n      t1 = 0,\n      t2 = 0,\n      step = 0.01,\n      segment,\n      pass1 = [],\n      pass2 = [];\n    // first pass: split on extrema\n    let extrema = this.extrema().values;\n    if (extrema.indexOf(0) === -1) {\n      extrema = [0].concat(extrema);\n    }\n    if (extrema.indexOf(1) === -1) {\n      extrema.push(1);\n    }\n\n    for (t1 = extrema[0], i = 1; i < extrema.length; i++) {\n      t2 = extrema[i];\n      segment = this.split(t1, t2);\n      segment._t1 = t1;\n      segment._t2 = t2;\n      pass1.push(segment);\n      t1 = t2;\n    }\n\n    // second pass: further reduce these segments to simple segments\n    pass1.forEach(function (p1) {\n      t1 = 0;\n      t2 = 0;\n      while (t2 <= 1) {\n        for (t2 = t1 + step; t2 <= 1 + step; t2 += step) {\n          segment = p1.split(t1, t2);\n          if (!segment.simple()) {\n            t2 -= step;\n            if (abs(t1 - t2) < step) {\n              // we can never form a reduction\n              return [];\n            }\n            segment = p1.split(t1, t2);\n            segment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n            segment._t2 = utils.map(t2, 0, 1, p1._t1, p1._t2);\n            pass2.push(segment);\n            t1 = t2;\n            break;\n          }\n        }\n      }\n      if (t1 < 1) {\n        segment = p1.split(t1, 1);\n        segment._t1 = utils.map(t1, 0, 1, p1._t1, p1._t2);\n        segment._t2 = p1._t2;\n        pass2.push(segment);\n      }\n    });\n    return pass2;\n  }\n\n  scale(d) {\n    const order = this.order;\n    let distanceFn = false;\n    if (typeof d === \"function\") {\n      distanceFn = d;\n    }\n    if (distanceFn && order === 2) {\n      return this.raise().scale(distanceFn);\n    }\n\n    // TODO: add special handling for degenerate (=linear) curves.\n    const clockwise = this.clockwise;\n    const r1 = distanceFn ? distanceFn(0) : d;\n    const r2 = distanceFn ? distanceFn(1) : d;\n    const v = [this.offset(0, 10), this.offset(1, 10)];\n    const points = this.points;\n    const np = [];\n    const o = utils.lli4(v[0], v[0].c, v[1], v[1].c);\n\n    if (!o) {\n      throw new Error(\"cannot scale this curve. Try reducing it first.\");\n    }\n    // move all points by distance 'd' wrt the origin 'o'\n\n    // move end points by fixed distance along normal.\n    [0, 1].forEach(function (t) {\n      const p = (np[t * order] = utils.copy(points[t * order]));\n      p.x += (t ? r2 : r1) * v[t].n.x;\n      p.y += (t ? r2 : r1) * v[t].n.y;\n    });\n\n    if (!distanceFn) {\n      // move control points to lie on the intersection of the offset\n      // derivative vector, and the origin-through-control vector\n      [0, 1].forEach((t) => {\n        if (order === 2 && !!t) return;\n        const p = np[t * order];\n        const d = this.derivative(t);\n        const p2 = { x: p.x + d.x, y: p.y + d.y };\n        np[t + 1] = utils.lli4(p, p2, o, points[t + 1]);\n      });\n      return new Bezier(np);\n    }\n\n    // move control points by \"however much necessary to\n    // ensure the correct tangent to endpoint\".\n    [0, 1].forEach(function (t) {\n      if (order === 2 && !!t) return;\n      var p = points[t + 1];\n      var ov = {\n        x: p.x - o.x,\n        y: p.y - o.y,\n      };\n      var rc = distanceFn ? distanceFn((t + 1) / order) : d;\n      if (distanceFn && !clockwise) rc = -rc;\n      var m = sqrt(ov.x * ov.x + ov.y * ov.y);\n      ov.x /= m;\n      ov.y /= m;\n      np[t + 1] = {\n        x: p.x + rc * ov.x,\n        y: p.y + rc * ov.y,\n      };\n    });\n    return new Bezier(np);\n  }\n\n  outline(d1, d2, d3, d4) {\n    d2 = typeof d2 === \"undefined\" ? d1 : d2;\n    const reduced = this.reduce(),\n      len = reduced.length,\n      fcurves = [];\n\n    let bcurves = [],\n      p,\n      alen = 0,\n      tlen = this.length();\n\n    const graduated = typeof d3 !== \"undefined\" && typeof d4 !== \"undefined\";\n\n    function linearDistanceFunction(s, e, tlen, alen, slen) {\n      return function (v) {\n        const f1 = alen / tlen,\n          f2 = (alen + slen) / tlen,\n          d = e - s;\n        return utils.map(v, 0, 1, s + f1 * d, s + f2 * d);\n      };\n    }\n\n    // form curve oulines\n    reduced.forEach(function (segment) {\n      const slen = segment.length();\n      if (graduated) {\n        fcurves.push(\n          segment.scale(linearDistanceFunction(d1, d3, tlen, alen, slen))\n        );\n        bcurves.push(\n          segment.scale(linearDistanceFunction(-d2, -d4, tlen, alen, slen))\n        );\n      } else {\n        fcurves.push(segment.scale(d1));\n        bcurves.push(segment.scale(-d2));\n      }\n      alen += slen;\n    });\n\n    // reverse the \"return\" outline\n    bcurves = bcurves\n      .map(function (s) {\n        p = s.points;\n        if (p[3]) {\n          s.points = [p[3], p[2], p[1], p[0]];\n        } else {\n          s.points = [p[2], p[1], p[0]];\n        }\n        return s;\n      })\n      .reverse();\n\n    // form the endcaps as lines\n    const fs = fcurves[0].points[0],\n      fe = fcurves[len - 1].points[fcurves[len - 1].points.length - 1],\n      bs = bcurves[len - 1].points[bcurves[len - 1].points.length - 1],\n      be = bcurves[0].points[0],\n      ls = utils.makeline(bs, fs),\n      le = utils.makeline(fe, be),\n      segments = [ls].concat(fcurves).concat([le]).concat(bcurves),\n      slen = segments.length;\n\n    return new PolyBezier(segments);\n  }\n\n  outlineshapes(d1, d2, curveIntersectionThreshold) {\n    d2 = d2 || d1;\n    const outline = this.outline(d1, d2).curves;\n    const shapes = [];\n    for (let i = 1, len = outline.length; i < len / 2; i++) {\n      const shape = utils.makeshape(\n        outline[i],\n        outline[len - i],\n        curveIntersectionThreshold\n      );\n      shape.startcap.virtual = i > 1;\n      shape.endcap.virtual = i < len / 2 - 1;\n      shapes.push(shape);\n    }\n    return shapes;\n  }\n\n  intersects(curve, curveIntersectionThreshold) {\n    if (!curve) return this.selfintersects(curveIntersectionThreshold);\n    if (curve.p1 && curve.p2) {\n      return this.lineIntersects(curve);\n    }\n    if (curve instanceof Bezier) {\n      curve = curve.reduce();\n    }\n    return this.curveintersects(\n      this.reduce(),\n      curve,\n      curveIntersectionThreshold\n    );\n  }\n\n  lineIntersects(line) {\n    const mx = min(line.p1.x, line.p2.x),\n      my = min(line.p1.y, line.p2.y),\n      MX = max(line.p1.x, line.p2.x),\n      MY = max(line.p1.y, line.p2.y);\n    return utils.roots(this.points, line).filter((t) => {\n      var p = this.get(t);\n      return utils.between(p.x, mx, MX) && utils.between(p.y, my, MY);\n    });\n  }\n\n  selfintersects(curveIntersectionThreshold) {\n    // \"simple\" curves cannot intersect with their direct\n    // neighbour, so for each segment X we check whether\n    // it intersects [0:x-2][x+2:last].\n\n    const reduced = this.reduce(),\n      len = reduced.length - 2,\n      results = [];\n\n    for (let i = 0, result, left, right; i < len; i++) {\n      left = reduced.slice(i, i + 1);\n      right = reduced.slice(i + 2);\n      result = this.curveintersects(left, right, curveIntersectionThreshold);\n      results.push(...result);\n    }\n    return results;\n  }\n\n  curveintersects(c1, c2, curveIntersectionThreshold) {\n    const pairs = [];\n    // step 1: pair off any overlapping segments\n    c1.forEach(function (l) {\n      c2.forEach(function (r) {\n        if (l.overlaps(r)) {\n          pairs.push({ left: l, right: r });\n        }\n      });\n    });\n    // step 2: for each pairing, run through the convergence algorithm.\n    let intersections = [];\n    pairs.forEach(function (pair) {\n      const result = utils.pairiteration(\n        pair.left,\n        pair.right,\n        curveIntersectionThreshold\n      );\n      if (result.length > 0) {\n        intersections = intersections.concat(result);\n      }\n    });\n    return intersections;\n  }\n\n  arcs(errorThreshold) {\n    errorThreshold = errorThreshold || 0.5;\n    return this._iterate(errorThreshold, []);\n  }\n\n  _error(pc, np1, s, e) {\n    const q = (e - s) / 4,\n      c1 = this.get(s + q),\n      c2 = this.get(e - q),\n      ref = utils.dist(pc, np1),\n      d1 = utils.dist(pc, c1),\n      d2 = utils.dist(pc, c2);\n    return abs(d1 - ref) + abs(d2 - ref);\n  }\n\n  _iterate(errorThreshold, circles) {\n    let t_s = 0,\n      t_e = 1,\n      safety;\n    // we do a binary search to find the \"good `t` closest to no-longer-good\"\n    do {\n      safety = 0;\n\n      // step 1: start with the maximum possible arc\n      t_e = 1;\n\n      // points:\n      let np1 = this.get(t_s),\n        np2,\n        np3,\n        arc,\n        prev_arc;\n\n      // booleans:\n      let curr_good = false,\n        prev_good = false,\n        done;\n\n      // numbers:\n      let t_m = t_e,\n        prev_e = 1,\n        step = 0;\n\n      // step 2: find the best possible arc\n      do {\n        prev_good = curr_good;\n        prev_arc = arc;\n        t_m = (t_s + t_e) / 2;\n        step++;\n\n        np2 = this.get(t_m);\n        np3 = this.get(t_e);\n\n        arc = utils.getccenter(np1, np2, np3);\n\n        //also save the t values\n        arc.interval = {\n          start: t_s,\n          end: t_e,\n        };\n\n        let error = this._error(arc, np1, t_s, t_e);\n        curr_good = error <= errorThreshold;\n\n        done = prev_good && !curr_good;\n        if (!done) prev_e = t_e;\n\n        // this arc is fine: we can move 'e' up to see if we can find a wider arc\n        if (curr_good) {\n          // if e is already at max, then we're done for this arc.\n          if (t_e >= 1) {\n            // make sure we cap at t=1\n            arc.interval.end = prev_e = 1;\n            prev_arc = arc;\n            // if we capped the arc segment to t=1 we also need to make sure that\n            // the arc's end angle is correct with respect to the bezier end point.\n            if (t_e > 1) {\n              let d = {\n                x: arc.x + arc.r * cos(arc.e),\n                y: arc.y + arc.r * sin(arc.e),\n              };\n              arc.e += utils.angle({ x: arc.x, y: arc.y }, d, this.get(1));\n            }\n            break;\n          }\n          // if not, move it up by half the iteration distance\n          t_e = t_e + (t_e - t_s) / 2;\n        } else {\n          // this is a bad arc: we need to move 'e' down to find a good arc\n          t_e = t_m;\n        }\n      } while (!done && safety++ < 100);\n\n      if (safety >= 100) {\n        break;\n      }\n\n      // console.log(\"L835: [F] arc found\", t_s, prev_e, prev_arc.x, prev_arc.y, prev_arc.s, prev_arc.e);\n\n      prev_arc = prev_arc ? prev_arc : arc;\n      circles.push(prev_arc);\n      t_s = prev_e;\n    } while (t_e < 1);\n    return circles;\n  }\n}\n\nexport { Bezier };\n","import Attributes from './attributes'\nimport Point from './point'\nimport { Bezier } from 'bezier-js'\nimport {\n  linesIntersect,\n  lineIntersectsCurve,\n  curvesIntersect,\n  pointOnLine,\n  pointOnCurve,\n  curveEdge,\n  round,\n} from './utils'\n\nfunction Path(debug = false) {\n  this.render = true\n  this.topLeft = false\n  this.bottomRight = false\n  this.attributes = new Attributes()\n  this.ops = []\n  Object.defineProperty(this, 'debug', { value: debug, configurable: true })\n}\n\n/** Adds the raise method for a path not created through the proxy **/\nPath.prototype.withRaise = function (raise = false) {\n  if (raise) Object.defineProperty(this, 'raise', { value: raise })\n\n  return this\n}\n\n/** Chainable way to set the render property */\nPath.prototype.setRender = function (render = true) {\n  if (render) this.render = true\n  else this.render = false\n  if (this.debug) this.raise.debug('Setting `Path.render` to ' + (render ? '`true`' : '`false`'))\n\n  return this\n}\n\n/** Adds a move operation to Point to */\nPath.prototype.move = function (to) {\n  if (this.debug && to instanceof Point !== true)\n    this.raise.warning('Called `Path.rotate(to)` but `to` is not a `Point` object')\n  this.ops.push({ type: 'move', to })\n\n  return this\n}\n\n/** Adds a line operation to Point to */\nPath.prototype.line = function (to) {\n  if (this.debug && to instanceof Point !== true)\n    this.raise.warning('Called `Path.line(to)` but `to` is not a `Point` object')\n  this.ops.push({ type: 'line', to })\n\n  return this\n}\n\n/** Adds a curve operation via cp1 & cp2 to Point to */\nPath.prototype.curve = function (cp1, cp2, to) {\n  if (this.debug) {\n    if (to instanceof Point !== true)\n      this.raise.warning('Called `Path.curve(cp1, cp2, to)` but `to` is not a `Point` object')\n    if (cp1 instanceof Point !== true)\n      this.raise.warning('Called `Path.curve(cp1, cp2, to)` but `cp1` is not a `Point` object')\n    if (cp2 instanceof Point !== true)\n      this.raise.warning('Called `Path.curve(cp1, cp2, to)` but `cp2` is not a `Point` object')\n  }\n  this.ops.push({ type: 'curve', cp1, cp2, to })\n\n  return this\n}\n\n/** Adds a curve operation without cp1 via cp2 to Point to */\nPath.prototype._curve = function (cp2, to) {\n  if (this.debug) {\n    if (to instanceof Point !== true)\n      this.raise.warning('Called `Path._curve(cp2, to)` but `to` is not a `Point` object')\n    if (cp2 instanceof Point !== true)\n      this.raise.warning('Called `Path._curve(cp2, to)` but `cp2` is not a `Point` object')\n  }\n  let cp1 = this.ops.slice(-1).pop().to\n  this.ops.push({ type: 'curve', cp1, cp2, to })\n\n  return this\n}\n\n/** Adds a curve operation via cp1 with no cp2 to Point to */\nPath.prototype.curve_ = function (cp1, to) {\n  if (this.debug) {\n    if (to instanceof Point !== true)\n      this.raise.warning('Called `Path.curve_(cp1, to)` but `to` is not a `Point` object')\n    if (cp1 instanceof Point !== true)\n      this.raise.warning('Called `Path.curve_(cp1, to)` but `cp2` is not a `Point` object')\n  }\n  let cp2 = to.copy()\n  this.ops.push({ type: 'curve', cp1, cp2, to })\n\n  return this\n}\n\n/** Adds a close operation */\nPath.prototype.close = function () {\n  this.ops.push({ type: 'close' })\n\n  return this\n}\n\n/** Adds a noop operation */\nPath.prototype.noop = function (id = false) {\n  this.ops.push({ type: 'noop', id })\n\n  return this\n}\n\n/** Replace a noop operation with the ops from path */\nPath.prototype.insop = function (noopId, path) {\n  if (this.debug) {\n    if (!noopId)\n      this.raise.warning('Called `Path.insop(noopId, path)` but `noopId` is undefined or false')\n    if (path instanceof Path !== true)\n      this.raise.warning('Called `Path.insop(noopId, path) but `path` is not a `Path` object')\n  }\n  let newPath = this.clone()\n  for (let i in newPath.ops) {\n    if (newPath.ops[i].type === 'noop' && newPath.ops[i].id === noopId) {\n      newPath.ops = newPath.ops\n        .slice(0, i)\n        .concat(path.ops)\n        .concat(newPath.ops.slice(Number(i) + 1))\n    }\n  }\n\n  return newPath\n}\n\n/** Adds an attribute. This is here to make this call chainable in assignment */\nPath.prototype.attr = function (name, value, overwrite = false) {\n  if (this.debug) {\n    if (!name)\n      this.raise.warning(\n        'Called `Path.attr(name, value, overwrite=false)` but `name` is undefined or false'\n      )\n    if (typeof value === 'undefined')\n      this.raise.warning(\n        'Called `Path.attr(name, value, overwrite=false)` but `value` is undefined'\n      )\n    if (overwrite)\n      this.raise.debug(\n        `Overwriting \\`Path.attribute.${name}\\` with ${value} (was: ${this.attributes.get(name)})`\n      )\n  }\n  if (overwrite) this.attributes.set(name, value)\n  else this.attributes.add(name, value)\n\n  return this\n}\n\n/** Returns SVG pathstring for this path */\nPath.prototype.asPathstring = function () {\n  let d = ''\n  for (let op of this.ops) {\n    switch (op.type) {\n      case 'move':\n        d += `M ${round(op.to.x)},${round(op.to.y)}`\n        break\n      case 'line':\n        d += ` L ${round(op.to.x)},${round(op.to.y)}`\n        break\n      case 'curve':\n        d += ` C ${round(op.cp1.x)},${round(op.cp1.y)} ${round(op.cp2.x)},${round(\n          op.cp2.y\n        )} ${round(op.to.x)},${round(op.to.y)}`\n        break\n      case 'close':\n        d += ' z'\n        break\n    }\n  }\n\n  return d\n}\n\n/** Returns offset of this path as a new path */\nPath.prototype.offset = function (distance) {\n  if (typeof distance !== 'number')\n    this.raise.error('Called `Path.offset(distance)` but `distance` is not a number')\n  return pathOffset(this, distance, this.raise)\n}\n\n/** Returns the length of this path */\nPath.prototype.length = function () {\n  let current, start\n  let length = 0\n  for (let i in this.ops) {\n    let op = this.ops[i]\n    if (op.type === 'move') {\n      start = op.to\n    } else if (op.type === 'line') {\n      length += current.dist(op.to)\n    } else if (op.type === 'curve') {\n      length += new Bezier(\n        { x: current.x, y: current.y },\n        { x: op.cp1.x, y: op.cp1.y },\n        { x: op.cp2.x, y: op.cp2.y },\n        { x: op.to.x, y: op.to.y }\n      ).length()\n    } else if (op.type === 'close') {\n      length += current.dist(start)\n    }\n    if (op.to) current = op.to\n  }\n\n  return length\n}\n\n/** Returns the startpoint of the path */\nPath.prototype.start = function () {\n  if (this.ops.length < 1 || typeof this.ops[0].to === 'undefined')\n    this.raise.error('Called `Path.start()` but this path has no drawing operations')\n  return this.ops[0].to\n}\n\n/** Returns the endpoint of the path */\nPath.prototype.end = function () {\n  if (this.ops.length < 1)\n    this.raise.error('Called `Path.end()` but this path has no drawing operations')\n  let op = this.ops[this.ops.length - 1]\n\n  if (op.type === 'close') return this.start()\n  else return op.to\n}\n\n/** Finds the bounding box of a path */\nPath.prototype.boundary = function () {\n  if (this.topLeft) return this // Cached\n\n  let current\n  let topLeft = new Point(Infinity, Infinity)\n  let bottomRight = new Point(-Infinity, -Infinity)\n  let edges = []\n  for (let i in this.ops) {\n    let op = this.ops[i]\n    if (op.type === 'move' || op.type === 'line') {\n      if (op.to.x < topLeft.x) {\n        topLeft.x = op.to.x\n        edges['leftOp'] = i\n      }\n      if (op.to.y < topLeft.y) {\n        topLeft.y = op.to.y\n        edges['topOp'] = i\n      }\n      if (op.to.x > bottomRight.x) {\n        bottomRight.x = op.to.x\n        edges['rightOp'] = i\n      }\n      if (op.to.y > bottomRight.y) {\n        bottomRight.y = op.to.y\n        edges['bottomOp'] = i\n      }\n    } else if (op.type === 'curve') {\n      let bb = new Bezier(\n        { x: current.x, y: current.y },\n        { x: op.cp1.x, y: op.cp1.y },\n        { x: op.cp2.x, y: op.cp2.y },\n        { x: op.to.x, y: op.to.y }\n      ).bbox()\n      if (bb.x.min < topLeft.x) {\n        topLeft.x = bb.x.min\n        edges['leftOp'] = i\n      }\n      if (bb.y.min < topLeft.y) {\n        topLeft.y = bb.y.min\n        edges['topOp'] = i\n      }\n      if (bb.x.max > bottomRight.x) {\n        bottomRight.x = bb.x.max\n        edges['rightOp'] = i\n      }\n      if (bb.y.max > bottomRight.y) {\n        bottomRight.y = bb.y.max\n        edges['bottomOp'] = i\n      }\n    }\n    if (op.to) current = op.to\n  }\n\n  this.topLeft = topLeft\n  this.bottomRight = bottomRight\n\n  for (let side of ['top', 'left', 'bottom', 'right']) {\n    let s = side + 'Op'\n    this[s] = this.ops[edges[s]]\n    this[s].from = this[s].type === 'move' ? this[s].to : this.ops[edges[s] - 1].to\n  }\n\n  return this\n}\n\n/** Returns a deep copy of this */\nPath.prototype.clone = function () {\n  let clone = new Path(this.debug).withRaise(this.raise).setRender(this.render)\n  if (this.topLeft) clone.topLeft = this.topLeft.clone()\n  else clone.topLeft = false\n  if (this.bottomRight) clone.bottomRight = this.bottomRight.clone()\n  else clone.bottomRight = false\n  clone.attributes = this.attributes.clone()\n  clone.ops = []\n  for (let i in this.ops) {\n    let op = this.ops[i]\n    clone.ops[i] = { type: op.type }\n    if (op.type === 'move' || op.type === 'line') {\n      clone.ops[i].to = op.to.clone()\n    } else if (op.type === 'curve') {\n      clone.ops[i].to = op.to.clone()\n      clone.ops[i].cp1 = op.cp1.clone()\n      clone.ops[i].cp2 = op.cp2.clone()\n    } else if (op.type === 'noop') {\n      clone.ops[i].id = op.id\n    }\n  }\n\n  return clone\n}\n\n/** Joins this with that path, closes them if wanted */\nPath.prototype.join = function (that, closed = false) {\n  if (that instanceof Path !== true)\n    this.raise.error('Called `Path.join(that)` but `that` is not a `Path` object')\n  return joinPaths([this, that], closed, this.raise)\n}\n\n/** Offsets a path by distance */\nfunction pathOffset(path, distance, raise) {\n  let offset = []\n  let current\n  let start = false\n  let closed = false\n  for (let i in path.ops) {\n    let op = path.ops[i]\n    if (op.type === 'line') {\n      let segment = offsetLine(current, op.to, distance, path.debug, path.raise)\n      if (segment) offset.push(segment)\n    } else if (op.type === 'curve') {\n      // We need to avoid a control point sitting on top of start or end\n      // because that will break the offset in bezier-js\n      let cp1, cp2\n      if (current.sitsRoughlyOn(op.cp1)) {\n        cp1 = new Path(path.debug)\n          .withRaise(path.raise)\n          .move(current)\n          .curve(op.cp1, op.cp2, op.to)\n          .shiftAlong(2)\n      } else cp1 = op.cp1\n      if (op.cp2.sitsRoughlyOn(op.to)) {\n        cp2 = new Path(path.debug)\n          .withRaise(path.raise)\n          .move(op.to)\n          .curve(op.cp2, op.cp1, current)\n          .shiftAlong(2)\n      } else cp2 = op.cp2\n      let b = new Bezier(\n        { x: current.x, y: current.y },\n        { x: cp1.x, y: cp1.y },\n        { x: cp2.x, y: cp2.y },\n        { x: op.to.x, y: op.to.y }\n      )\n      for (let bezier of b.offset(distance)) offset.push(asPath(bezier, path.debug, path.raise))\n    } else if (op.type === 'close') closed = true\n    if (op.to) current = op.to\n    if (!start) start = current\n  }\n\n  return joinPaths(offset, closed, raise)\n}\n\n/** Offsets a line by distance */\nfunction offsetLine(from, to, distance, debug = false, raise = false) {\n  if (from.x === to.x && from.y === to.y) return false\n  let angle = from.angle(to) - 90\n\n  return new Path(debug)\n    .withRaise(raise)\n    .move(from.shift(angle, distance))\n    .line(to.shift(angle, distance))\n}\n\n/** Converts a bezier-js instance to a path */\nfunction asPath(bezier, debug = false, raise = false) {\n  return new Path(debug)\n    .withRaise(raise)\n    .move(new Point(bezier.points[0].x, bezier.points[0].y))\n    .curve(\n      new Point(bezier.points[1].x, bezier.points[1].y),\n      new Point(bezier.points[2].x, bezier.points[2].y),\n      new Point(bezier.points[3].x, bezier.points[3].y)\n    )\n}\n\n/** Joins path segments together into one path */\nfunction joinPaths(paths, closed = false, raise = false) {\n  let joint = new Path(paths[0].debug).withRaise(paths[0].raise).move(paths[0].ops[0].to)\n  let current\n  for (let p of paths) {\n    for (let op of p.ops) {\n      if (op.type === 'curve') {\n        joint.curve(op.cp1, op.cp2, op.to)\n      } else if (op.type !== 'close') {\n        // We're using sitsRoughlyOn here to avoid miniscule line segments\n        if (current && !op.to.sitsRoughlyOn(current)) joint.line(op.to)\n      } else {\n        let err = 'Cannot join a closed path with another'\n        joint.raise.error(err)\n        throw new Error(err)\n      }\n      if (op.to) current = op.to\n    }\n  }\n  if (closed) joint.close()\n\n  return joint\n}\n\n/** Returns a point that lies at distance along this */\nPath.prototype.shiftAlong = function (distance, stepsPerMm = 25) {\n  if (typeof distance !== 'number')\n    this.raise.error('Called `Path.shiftAlong(distance)` but `distance` is not a number')\n  let len = 0\n  let current\n  for (let i in this.ops) {\n    let op = this.ops[i]\n    if (op.type === 'line') {\n      let thisLen = op.to.dist(current)\n      if (Math.abs((len + thisLen) - distance) < 0.1) return op.to\n      if (len + thisLen > distance) return current.shiftTowards(op.to, distance - len)\n      len += thisLen\n    } else if (op.type === 'curve') {\n      let bezier = new Bezier(\n        { x: current.x, y: current.y },\n        { x: op.cp1.x, y: op.cp1.y },\n        { x: op.cp2.x, y: op.cp2.y },\n        { x: op.to.x, y: op.to.y }\n      )\n      let thisLen = bezier.length()\n      if (Math.abs((len + thisLen) - distance) < 0.1) return op.to\n      if (len + thisLen > distance) return shiftAlongBezier(distance - len, bezier, thisLen * stepsPerMm)\n      len += thisLen\n    }\n    current = op.to\n  }\n  this.raise.error(\n    `Called \\`Path.shiftAlong(distance)\\` with a \\`distance\\` of \\`${distance}\\` but \\`Path.length()\\` is only \\`${this.length()}\\``\n  )\n}\n\n/** Returns a point that lies at fraction along this */\nPath.prototype.shiftFractionAlong = function (fraction, stepsPerMm = 25) {\n  if (typeof fraction !== 'number')\n    this.raise.error('Called `Path.shiftFractionAlong(fraction)` but `fraction` is not a number')\n  return this.shiftAlong(this.length() * fraction, stepsPerMm)\n}\n\n/** Returns a point that lies at distance along bezier */\nfunction shiftAlongBezier(distance, bezier, steps = 100) {\n  let previous, next, t, thisLen\n  let len = 0\n  for (let i = 0; i <= steps; i++) {\n    t = i / steps\n    next = bezier.get(t)\n    next = new Point(next.x, next.y)\n    if (i > 0) {\n      thisLen = next.dist(previous)\n      if (len + thisLen > distance) return next\n      else len += thisLen\n    }\n    previous = next\n  }\n}\n\n/** Returns a point at the top edge of a bounding box of this */\nPath.prototype.bbox = function () {\n  let bbs = []\n  let current\n  for (let i in this.ops) {\n    let op = this.ops[i]\n    if (op.type === 'line') {\n      bbs.push(lineBoundingBox({ from: current, to: op.to }))\n    } else if (op.type === 'curve') {\n      bbs.push(\n        curveBoundingBox(\n          new Bezier(\n            { x: current.x, y: current.y },\n            { x: op.cp1.x, y: op.cp1.y },\n            { x: op.cp2.x, y: op.cp2.y },\n            { x: op.to.x, y: op.to.y }\n          )\n        )\n      )\n    }\n    if (op.to) current = op.to\n  }\n\n  return bbbbox(bbs)\n}\n\nfunction lineBoundingBox(line) {\n  let from = line.from\n  let to = line.to\n  if (from.x === to.x) {\n    if (from.y < to.y) return { topLeft: from, bottomRight: to }\n    else return { topLeft: to, bottomRight: from }\n  } else if (from.y === to.y) {\n    if (from.x < to.x) return { topLeft: from, bottomRight: to }\n    else return { topLeft: to, bottomRight: from }\n  } else if (from.x < to.x) {\n    if (from.y < to.y) return { topLeft: from, bottomRight: to }\n    else\n      return {\n        topLeft: new Point(from.x, to.y),\n        bottomRight: new Point(to.x, from.y),\n      }\n  } else if (from.x > to.x) {\n    if (from.y < to.y)\n      return {\n        topLeft: new Point(to.x, from.y),\n        bottomRight: new Point(from.x, to.y),\n      }\n    else\n      return {\n        topLeft: new Point(to.x, to.y),\n        bottomRight: new Point(from.x, from.y),\n      }\n  }\n}\n\nfunction curveBoundingBox(curve) {\n  let bb = curve.bbox()\n\n  return {\n    topLeft: new Point(bb.x.min, bb.y.min),\n    bottomRight: new Point(bb.x.max, bb.y.max),\n  }\n}\n\nfunction bbbbox(boxes) {\n  let minX = Infinity\n  let maxX = -Infinity\n  let minY = Infinity\n  let maxY = -Infinity\n  for (let box of boxes) {\n    if (box.topLeft.x < minX) minX = box.topLeft.x\n    if (box.topLeft.y < minY) minY = box.topLeft.y\n    if (box.bottomRight.x > maxX) maxX = box.bottomRight.x\n    if (box.bottomRight.y > maxY) maxY = box.bottomRight.y\n  }\n\n  return { topLeft: new Point(minX, minY), bottomRight: new Point(maxX, maxY) }\n}\n\n/** Returns a reversed version of this */\nPath.prototype.reverse = function () {\n  let sections = []\n  let current\n  let closed = false\n  for (let i in this.ops) {\n    let op = this.ops[i]\n    if (op.type === 'line') {\n      if (!op.to.sitsOn(current))\n        sections.push(new Path(this.debug).withRaise(this.raise).move(op.to).line(current))\n    } else if (op.type === 'curve') {\n      sections.push(\n        new Path(this.debug).withRaise(this.raise).move(op.to).curve(op.cp2, op.cp1, current)\n      )\n    } else if (op.type === 'close') {\n      closed = true\n    }\n    if (op.to) current = op.to\n  }\n  let rev = new Path(this.debug).withRaise(this.raise).move(current)\n  for (let section of sections.reverse()) rev.ops.push(section.ops[1])\n  if (closed) rev.close()\n\n  return rev\n}\n\n/** Returns the point at an edge of this path */\nPath.prototype.edge = function (side) {\n  this.boundary()\n  if (side === 'topLeft') return this.topLeft\n  else if (side === 'bottomRight') return this.bottomRight\n  else if (side === 'topRight') return new Point(this.bottomRight.x, this.topLeft.y)\n  else if (side === 'bottomLeft') return new Point(this.topLeft.x, this.bottomRight.y)\n  else {\n    let s = side + 'Op'\n    if (this[s].type === 'move') return this[s].to\n    else if (this[s].type === 'line') {\n      if (side === 'top') {\n        if (this.topOp.to.y < this.topOp.from.y) return this.topOp.to\n        else return this.topOp.from\n      } else if (side === 'left') {\n        if (this.leftOp.to.x < this.leftOp.from.x) return this.leftOp.to\n        else return this.leftOp.from\n      } else if (side === 'bottom') {\n        if (this.bottomOp.to.y > this.bottomOp.from.y) return this.bottomOp.to\n        else return this.bottomOp.from\n      } else if (side === 'right') {\n        if (this.rightOp.to.x > this.rightOp.from.x) return this.rightOp.to\n        else return this.rightOp.from\n      }\n    } else if (this[s].type === 'curve') {\n      let curve = edgeCurveAsBezier(this[s])\n      return curveEdge(curve, side)\n    }\n  }\n  this.raise.error(`Unable to find \\`Path.edge(side)\\` for side ${side}`)\n}\n\nfunction edgeCurveAsBezier(op) {\n  return new Bezier(\n    { x: op.from.x, y: op.from.y },\n    { x: op.cp1.x, y: op.cp1.y },\n    { x: op.cp2.x, y: op.cp2.y },\n    { x: op.to.x, y: op.to.y }\n  )\n}\n\n/** Divides a path into atomic paths */\nPath.prototype.divide = function () {\n  let paths = []\n  let current, start\n  for (let i in this.ops) {\n    let op = this.ops[i]\n    if (op.type === 'move') {\n      start = op.to\n    } else if (op.type === 'line') {\n      if (!op.to.sitsRoughlyOn(current))\n        paths.push(new Path(this.debug).withRaise(this.raise).move(current).line(op.to))\n    } else if (op.type === 'curve') {\n      paths.push(\n        new Path(this.debug).withRaise(this.raise).move(current).curve(op.cp1, op.cp2, op.to)\n      )\n    } else if (op.type === 'close') {\n      paths.push(new Path(this.debug).withRaise(this.raise).move(current).line(start))\n    }\n    if (op.to) current = op.to\n  }\n\n  return paths\n}\n\n/** Finds intersections between this path and an X value */\nPath.prototype.intersectsX = function (x) {\n  if (typeof x !== 'number')\n    this.raise.error('Called `Path.intersectsX(x)` but `x` is not a number')\n  return this.intersectsAxis(x, 'x')\n}\n\n/** Finds intersections between this path and an Y value */\nPath.prototype.intersectsY = function (y) {\n  if (typeof y !== 'number')\n    this.raise.error('Called `Path.intersectsX(y)` but `y` is not a number')\n  return this.intersectsAxis(y, 'y')\n}\n\n/** Finds intersections between this path and a X or Y value */\nPath.prototype.intersectsAxis = function (val = false, mode) {\n  let intersections = []\n  let lineStart = mode === 'x' ? new Point(val, -100000) : new Point(-10000, val)\n  let lineEnd = mode === 'x' ? new Point(val, 100000) : new Point(100000, val)\n  for (let path of this.divide()) {\n    if (path.ops[1].type === 'line') {\n      addIntersectionsToArray(\n        linesIntersect(path.ops[0].to, path.ops[1].to, lineStart, lineEnd),\n        intersections\n      )\n    } else if (path.ops[1].type === 'curve') {\n      addIntersectionsToArray(\n        lineIntersectsCurve(\n          lineStart,\n          lineEnd,\n          path.ops[0].to,\n          path.ops[1].cp1,\n          path.ops[1].cp2,\n          path.ops[1].to\n        ),\n        intersections\n      )\n    }\n  }\n\n  return intersections\n}\n\n/** Finds intersections between this path and another path */\nPath.prototype.intersects = function (path) {\n  if (this === path)\n    this.raise.error('You called Path.intersects(path)` but `path` and `this` are the same object')\n  let intersections = []\n  for (let pathA of this.divide()) {\n    for (let pathB of path.divide()) {\n      if (pathA.ops[1].type === 'line') {\n        if (pathB.ops[1].type === 'line') {\n          addIntersectionsToArray(\n            linesIntersect(pathA.ops[0].to, pathA.ops[1].to, pathB.ops[0].to, pathB.ops[1].to),\n            intersections\n          )\n        } else if (pathB.ops[1].type === 'curve') {\n          addIntersectionsToArray(\n            lineIntersectsCurve(\n              pathA.ops[0].to,\n              pathA.ops[1].to,\n              pathB.ops[0].to,\n              pathB.ops[1].cp1,\n              pathB.ops[1].cp2,\n              pathB.ops[1].to\n            ),\n            intersections\n          )\n        }\n      } else if (pathA.ops[1].type === 'curve') {\n        if (pathB.ops[1].type === 'line') {\n          addIntersectionsToArray(\n            lineIntersectsCurve(\n              pathB.ops[0].to,\n              pathB.ops[1].to,\n              pathA.ops[0].to,\n              pathA.ops[1].cp1,\n              pathA.ops[1].cp2,\n              pathA.ops[1].to\n            ),\n            intersections\n          )\n        } else if (pathB.ops[1].type === 'curve') {\n          addIntersectionsToArray(\n            curvesIntersect(\n              pathA.ops[0].to,\n              pathA.ops[1].cp1,\n              pathA.ops[1].cp2,\n              pathA.ops[1].to,\n              pathB.ops[0].to,\n              pathB.ops[1].cp1,\n              pathB.ops[1].cp2,\n              pathB.ops[1].to\n            ),\n            intersections\n          )\n        }\n      }\n    }\n  }\n\n  return intersections\n}\n\nfunction addIntersectionsToArray(candidates, intersections) {\n  if (!candidates) return\n  if (typeof candidates === 'object') {\n    if (typeof candidates.x === 'number') intersections.push(candidates)\n    else {\n      for (let candidate of candidates) intersections.push(candidate)\n    }\n  }\n}\n\n/** Splits path on point, and retuns both halves */\nPath.prototype.split = function (point) {\n  if (point instanceof Point !== true)\n    this.raise.error('Called `Path.split(point)` but `point` is not a `Point` object')\n  let divided = this.divide()\n  let firstHalf = false\n  let secondHalf = false\n  for (let pi = 0; pi < divided.length; pi++) {\n    let path = divided[pi]\n    if (path.ops[1].type === 'line') {\n      if (pointOnLine(path.ops[0].to, path.ops[1].to, point)) {\n        firstHalf = divided.slice(0, pi)\n        firstHalf.push(new Path(this.debug).withRaise(this.raise).move(path.ops[0].to).line(point))\n        pi++\n        secondHalf = divided.slice(pi)\n        secondHalf.unshift(\n          new Path(this.debug).withRaise(this.raise).move(point).line(path.ops[1].to)\n        )\n      }\n    } else if (path.ops[1].type === 'curve') {\n      let t = pointOnCurve(path.ops[0].to, path.ops[1].cp1, path.ops[1].cp2, path.ops[1].to, point)\n      if (t !== false) {\n        let curve = new Bezier(\n          { x: path.ops[0].to.x, y: path.ops[0].to.y },\n          { x: path.ops[1].cp1.x, y: path.ops[1].cp1.y },\n          { x: path.ops[1].cp2.x, y: path.ops[1].cp2.y },\n          { x: path.ops[1].to.x, y: path.ops[1].to.y }\n        )\n        let split = curve.split(t)\n        firstHalf = divided.slice(0, pi)\n        firstHalf.push(\n          new Path(this.debug)\n            .withRaise(this.raise)\n            .move(new Point(split.left.points[0].x, split.left.points[0].y))\n            .curve(\n              new Point(split.left.points[1].x, split.left.points[1].y),\n              new Point(split.left.points[2].x, split.left.points[2].y),\n              new Point(split.left.points[3].x, split.left.points[3].y)\n            )\n        )\n        pi++\n        secondHalf = divided.slice(pi)\n        secondHalf.unshift(\n          new Path(this.debug)\n            .withRaise(this.raise)\n            .move(new Point(split.right.points[0].x, split.right.points[0].y))\n            .curve(\n              new Point(split.right.points[1].x, split.right.points[1].y),\n              new Point(split.right.points[2].x, split.right.points[2].y),\n              new Point(split.right.points[3].x, split.right.points[3].y)\n            )\n        )\n      }\n    }\n  }\n  if (firstHalf) firstHalf = joinPaths(firstHalf, false, this.raise)\n  if (secondHalf) secondHalf = joinPaths(secondHalf, false, this.raise)\n\n  return [firstHalf, secondHalf]\n}\n\n/** Removes self-intersections (overlap) from the path */\nPath.prototype.trim = function () {\n  let chunks = this.divide()\n  for (let i = 0; i < chunks.length; i++) {\n    let firstCandidate = parseInt(i) + 2\n    let lastCandidate = parseInt(chunks.length) - 1\n    for (let j = firstCandidate; j < lastCandidate; j++) {\n      let intersections = chunks[i].intersects(chunks[j])\n      if (intersections.length > 0) {\n        let intersection = intersections.pop()\n        let trimmedStart = chunks.slice(0, i)\n        let trimmedEnd = chunks.slice(parseInt(j) + 1)\n        let glue = new Path(this.debug).withRaise(this.raise)\n        let first = true\n        for (let k of [i, j]) {\n          let ops = chunks[k].ops\n          if (ops[1].type === 'line') {\n            glue.line(intersection)\n          } else if (ops[1].type === 'curve') {\n            // handle curve\n            let curve = new Bezier(\n              { x: ops[0].to.x, y: ops[0].to.y },\n              { x: ops[1].cp1.x, y: ops[1].cp1.y },\n              { x: ops[1].cp2.x, y: ops[1].cp2.y },\n              { x: ops[1].to.x, y: ops[1].to.y }\n            )\n            let t = pointOnCurve(ops[0].to, ops[1].cp1, ops[1].cp2, ops[1].to, intersection)\n            let split = curve.split(t)\n            let side\n            if (first) side = split.left\n            else side = split.right\n            glue.curve(\n              new Point(side.points[1].x, side.points[1].y),\n              new Point(side.points[2].x, side.points[2].y),\n              new Point(side.points[3].x, side.points[3].y)\n            )\n          }\n          first = false\n        }\n        let joint\n        if (trimmedStart.length > 0) joint = joinPaths(trimmedStart, false, this.raise).join(glue)\n        else joint = glue\n        if (trimmedEnd.length > 0) joint = joint.join(joinPaths(trimmedEnd, false, this.raise))\n\n        return joint.trim()\n      }\n    }\n  }\n\n  return this\n}\n\n/** Applies a path translate transform */\nPath.prototype.translate = function (x, y) {\n  if (this.debug) {\n    if (typeof x !== 'number')\n      this.raise.warning('Called `Path.translate(x, y)` but `x` is not a number')\n    if (typeof y !== 'number')\n      this.raise.warning('Called `Path.translate(x, y)` but `y` is not a number')\n  }\n  let clone = this.clone()\n  for (let op of clone.ops) {\n    if (op.type !== 'close') {\n      op.to = op.to.translate(x, y)\n    }\n    if (op.type === 'curve') {\n      op.cp1 = op.cp1.translate(x, y)\n      op.cp2 = op.cp2.translate(x, y)\n    }\n  }\n\n  return clone\n}\n\nexport default Path\n","import Path from './path'\nimport Point from './point'\nimport { Bezier } from 'bezier-js'\n\nexport function capitalize(string) {\n  return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\n/** Checks for a valid coordinate value **/\nexport function isCoord(value) {\n  return value === value // NaN does not equal itself\n    ? typeof value === 'number'\n    : false\n}\n\n/** Returns internal hook name for a macro */\nexport function macroName(name) {\n  return `_macro_${name}`\n}\n\n/** Find intersection of two (endless) lines */\nexport function beamsIntersect(a1, a2, b1, b2) {\n  let slopeA = a1.slope(a2)\n  let slopeB = b1.slope(b2)\n  if (slopeA === slopeB) return false // Parallel lines\n\n  if (a1.x === a2.x) return new Point(a1.x, slopeB * a1.x + (b1.y - slopeB * b1.x))\n  // Vertical line A\n  else if (b1.x === b2.x) return new Point(b1.x, slopeA * b1.x + (a1.y - slopeA * a1.x))\n  // Vertical line B\n  else {\n    // Swap points if line A or B goes from right to left\n    if (a1.x > a2.x) a1 = a2.copy()\n    if (b1.x > b2.x) b1 = b2.copy()\n    // Find y intercept\n    let iA = a1.y - slopeA * a1.x\n    let iB = b1.y - slopeB * b1.x\n\n    // Find intersection\n    let x = (iB - iA) / (slopeA - slopeB)\n    let y = slopeA * x + iA\n\n    return new Point(x, y)\n  }\n}\n\n/** Find intersection of two line segments */\nexport function linesIntersect(a1, a2, b1, b2) {\n  let p = beamsIntersect(a1, a2, b1, b2)\n  if (!p) return false\n  let lenA = a1.dist(a2)\n  let lenB = b1.dist(b2)\n  let lenC = a1.dist(p) + p.dist(a2)\n  let lenD = b1.dist(p) + p.dist(b2)\n  if (Math.round(lenA) == Math.round(lenC) && Math.round(lenB) == Math.round(lenD)) return p\n  else return false\n}\n\n/** Finds out whether a point lies on an endless line */\nexport function pointOnBeam(from, to, check, precision = 1e6) {\n  if (from.sitsOn(check)) return true\n  if (to.sitsOn(check)) return true\n  let cross = check.dx(from) * to.dy(from) - check.dy(from) * to.dx(from)\n\n  if (Math.abs(Math.round(cross * precision) / precision) === 0) return true\n  else return false\n}\n\n/** Finds out whether a point lies on a line segment */\nexport function pointOnLine(from, to, check, precision = 1e6) {\n  if (!pointOnBeam(from, to, check, precision)) return false\n  let lenA = from.dist(to)\n  let lenB = from.dist(check) + check.dist(to)\n  if (Math.round(lenA) == Math.round(lenB)) return true\n  else return false\n}\n\n/** Finds out whether a point lies on a curve */\nexport function pointOnCurve(start, cp1, cp2, end, check) {\n  if (start.sitsOn(check)) return true\n  if (end.sitsOn(check)) return true\n  let curve = new Bezier(\n    { x: start.x, y: start.y },\n    { x: cp1.x, y: cp1.y },\n    { x: cp2.x, y: cp2.y },\n    { x: end.x, y: end.y }\n  )\n  let intersections = curve.intersects({\n    p1: { x: check.x - 1, y: check.y },\n    p2: { x: check.x + 1, y: check.y },\n  })\n  if (intersections.length === 0) {\n    // Handle edge case of a curve that's a perfect horizontal line\n    intersections = curve.intersects({\n      p1: { x: check.x, y: check.y - 1 },\n      p2: { x: check.x, y: check.y + 1 },\n    })\n  }\n\n  if (intersections.length > 0) return intersections.shift()\n  else return false\n}\n\n/** Splits a curve on a point */\nexport function splitCurve(start, cp1, cp2, end, split) {\n  let [c1, c2] = new Path().move(start).curve(cp1, cp2, end).split(split)\n\n  return [\n    {\n      start: c1.ops[0].to,\n      cp1: c1.ops[1].cp1,\n      cp2: c1.ops[1].cp2,\n      end: c1.ops[1].to,\n    },\n    {\n      start: c2.ops[0].to,\n      cp1: c2.ops[1].cp1,\n      cp2: c2.ops[1].cp2,\n      end: c2.ops[1].to,\n    },\n  ]\n}\n\n/** Find where an (endless) line intersects with a certain X-value */\nexport function beamIntersectsX(from, to, x) {\n  if (from.x === to.x) return false // Vertical line\n  let top = new Point(x, -10)\n  let bottom = new Point(x, 10)\n\n  return beamsIntersect(from, to, top, bottom)\n}\n\n/** Find where an (endless) line intersects with a certain Y-value */\nexport function beamIntersectsY(from, to, y) {\n  if (from.y === to.y) return false // Horizontal line\n  let left = new Point(-10, y)\n  let right = new Point(10, y)\n\n  return beamsIntersect(from, to, left, right)\n}\n\n/** Convert value in mm to cm or imperial units */\nexport function units(value, to = 'metric') {\n  if (to === 'imperial') return round(value / 25.4) + '&quot;'\n  else return round(value / 10) + 'cm'\n}\n\n/** Find where a curve intersects with line */\nexport function lineIntersectsCurve(start, end, from, cp1, cp2, to) {\n  let intersections = []\n  let bz = new Bezier(\n    { x: from.x, y: from.y },\n    { x: cp1.x, y: cp1.y },\n    { x: cp2.x, y: cp2.y },\n    { x: to.x, y: to.y }\n  )\n  let line = {\n    p1: { x: start.x, y: start.y },\n    p2: { x: end.x, y: end.y },\n  }\n  for (let t of bz.intersects(line)) {\n    let isect = bz.get(t)\n    intersections.push(new Point(isect.x, isect.y))\n  }\n\n  if (intersections.length === 0) return false\n  else if (intersections.length === 1) return intersections[0]\n  else return intersections\n}\n\n/** Find where a curve intersects with a given X-value */\nexport function curveIntersectsX(from, cp1, cp2, to, x) {\n  let start = new Point(x, -10000)\n  let end = new Point(x, 10000)\n  return lineIntersectsCurve(start, end, from, cp1, cp2, to)\n}\n\n/** Find where a curve intersects with a given Y-value */\nexport function curveIntersectsY(from, cp1, cp2, to, y) {\n  let start = new Point(-10000, y)\n  let end = new Point(10000, y)\n  return lineIntersectsCurve(start, end, from, cp1, cp2, to)\n}\n\n/** Find where a curve intersects with another curve */\nexport function curvesIntersect(fromA, cp1A, cp2A, toA, fromB, cp1B, cp2B, toB) {\n  let precision = 0.005 // See https://github.com/Pomax/bezierjs/issues/99\n  let intersections = []\n  let curveA = new Bezier(\n    { x: fromA.x, y: fromA.y },\n    { x: cp1A.x, y: cp1A.y },\n    { x: cp2A.x, y: cp2A.y },\n    { x: toA.x, y: toA.y }\n  )\n  let curveB = new Bezier(\n    { x: fromB.x, y: fromB.y },\n    { x: cp1B.x, y: cp1B.y },\n    { x: cp2B.x, y: cp2B.y },\n    { x: toB.x, y: toB.y }\n  )\n\n  for (let tvalues of curveA.intersects(curveB, precision)) {\n    let intersection = curveA.get(tvalues.substr(0, tvalues.indexOf('/')))\n    intersections.push(new Point(intersection.x, intersection.y))\n  }\n\n  if (intersections.length === 0) return false\n  else if (intersections.length === 1) return intersections.shift()\n  else {\n    let unique = []\n    for (let i of intersections) {\n      let dupe = false\n      for (let u of unique) {\n        if (i.sitsRoughlyOn(u)) dupe = true\n      }\n      if (!dupe) unique.push(i)\n    }\n    return unique\n  }\n}\n\n/** Find the intersections between two circles */\nexport function circlesIntersect(c1, r1, c2, r2, sort = 'x') {\n  let dx = c1.dx(c2)\n  let dy = c1.dy(c2)\n  let dist = c1.dist(c2)\n  // Check for edge cases\n  if (dist > parseFloat(r1) + parseFloat(r2)) return false // Circles do not intersect\n  if (dist < parseFloat(r2) - parseFloat(r1)) return false // One circle is contained in the other\n  if (dist === 0 && r1 === r2) return false // Two circles are identical\n  let chorddistance = (Math.pow(r1, 2) - Math.pow(r2, 2) + Math.pow(dist, 2)) / (2 * dist)\n  let halfchordlength = Math.sqrt(Math.pow(r1, 2) - Math.pow(chorddistance, 2))\n  let chordmidpointx = c1.x + (chorddistance * dx) / dist\n  let chordmidpointy = c1.y + (chorddistance * dy) / dist\n  let i1 = new Point(\n    chordmidpointx + (halfchordlength * dy) / dist,\n    chordmidpointy - (halfchordlength * dx) / dist\n  )\n  let i2 = new Point(\n    chordmidpointx - (halfchordlength * dy) / dist,\n    chordmidpointy + (halfchordlength * dx) / dist\n  )\n\n  if ((sort === 'x' && i1.x <= i2.x) || (sort === 'y' && i1.y <= i2.y)) return [i1, i2]\n  else return [i2, i1]\n}\n\n/** Find the intersections between a beam and a circle */\nexport function beamIntersectsCircle(c, r, p1, p2, sort = 'x') {\n  let dx = p2.x - p1.x\n  let dy = p2.y - p1.y\n  let A = Math.pow(dx, 2) + Math.pow(dy, 2)\n  let B = 2 * (dx * (p1.x - c.x) + dy * (p1.y - c.y))\n  let C = Math.pow(p1.x - c.x, 2) + Math.pow(p1.y - c.y, 2) - Math.pow(r, 2)\n\n  let det = Math.pow(B, 2) - 4 * A * C\n\n  if (A <= 0.0000001 || det < 0) return false\n  // No real solutions\n  else if (det === 0) {\n    // One solution\n    let t = (-1 * B) / (2 * A)\n    let i1 = new Point(p1.x + t * dx, p1.y + t * dy)\n    return [i1]\n  } else {\n    // Two solutions\n    let t = (-1 * B + Math.sqrt(det)) / (2 * A)\n    let i1 = new Point(p1.x + t * dx, p1.y + t * dy)\n    t = (-1 * B - Math.sqrt(det)) / (2 * A)\n    let i2 = new Point(p1.x + t * dx, p1.y + t * dy)\n    if ((sort === 'x' && i1.x <= i2.x) || (sort === 'y' && i1.y <= i2.y)) return [i1, i2]\n    else return [i2, i1]\n  }\n}\n/** Find the intersections between a line and a circle */\nexport function lineIntersectsCircle(c, r, p1, p2, sort = 'x') {\n  let intersections = beamIntersectsCircle(c, r, p1, p2, sort)\n  if (intersections === false) return false\n  else {\n    if (intersections.length === 1) {\n      if (pointOnLine(p1, p2, intersections[0])) return intersections\n      else return false\n    } else {\n      let i1 = intersections[0]\n      let i2 = intersections[1]\n      if (!pointOnLine(p1, p2, i1, 5) && !pointOnLine(p1, p2, i2, 5)) return false\n      else if (pointOnLine(p1, p2, i1, 5) && pointOnLine(p1, p2, i2, 5)) {\n        if ((sort === 'x' && i1.x <= i2.x) || (sort === 'y' && i1.y <= i2.y)) return [i1, i2]\n        else return [i2, i1]\n      } else if (pointOnLine(p1, p2, i1, 5)) return [i1]\n      else if (pointOnLine(p1, p2, i2, 5)) return [i2]\n    }\n  }\n}\n\nexport function curveEdge(curve, edge, steps = 500) {\n  let x = Infinity\n  let y = Infinity\n  let p\n  if (edge === 'bottom') y = -Infinity\n  if (edge === 'right') x = -Infinity\n  for (let i = 0; i < steps; i++) {\n    p = curve.get(i / steps)\n    if (\n      (edge === 'top' && p.y < y) ||\n      (edge === 'bottom' && p.y > y) ||\n      (edge === 'right' && p.x > x) ||\n      (edge === 'left' && p.x < x)\n    ) {\n      x = p.x\n      y = p.y\n    }\n  }\n\n  return new Point(x, y)\n}\n\n/**\n * Calculates scale factor based on stretch factor\n *\n * The way people measure stretch intuitively is\n * different from the way we handle stretch in code.\n * When people say '25% stretch' they mean that\n * 10cm fabric should get stretched to 12.5cm fabric.\n * In our code, that means we need to scale things by 80%.\n *\n * This method does that calculation.\n */\nexport function stretchToScale(stretch) {\n  return 1 / (1 + parseFloat(stretch))\n}\n\nexport function round(value) {\n  return Math.round(value * 1e2) / 1e2\n}\n\nexport function sampleStyle(run, runs, styles = false) {\n  return styles && Array.isArray(styles) && styles.length > 0\n    ? styles[run % styles.length]\n    : `stroke: hsl(${(run - 1) * (330 / runs)}, 100%, 35%);`\n}\n\nexport function deg2rad(degrees) {\n  return degrees * (Math.PI / 180)\n}\n\nexport function rad2deg(radians) {\n  return (radians / Math.PI) * 180\n}\n\n// Export bezier-js so plugins can use it\nexport { Bezier }\n","import Attributes from './attributes'\n\nfunction Snippet(def, anchor, debug = false) {\n  this.def = def\n  this.anchor = anchor\n  this.attributes = new Attributes()\n  Object.defineProperty(this, 'debug', { value: debug, configurable: true })\n\n  return this\n}\n\n/** Adds the raise method for a snippet not created through the proxy **/\nSnippet.prototype.withRaise = function (raise = false) {\n  if (raise) Object.defineProperty(this, 'raise', { value: raise })\n\n  return this\n}\n/** Adds an attribute. This is here to make this call chainable in assignment */\nSnippet.prototype.attr = function (name, value, overwrite = false) {\n  if (overwrite) this.attributes.set(name, value)\n  else this.attributes.add(name, value)\n\n  return this\n}\n\n/** Returns a deep copy of this */\nSnippet.prototype.clone = function () {\n  let clone = new Snippet(this.def, this.anchor.clone(), this.debug).withRaise(this.raise)\n  clone.attributes = this.attributes.clone()\n\n  return clone\n}\n\nexport default Snippet\n","export default function Hooks() {\n  return {\n    preDraft: [],\n    postDraft: [],\n    preSample: [],\n    postSample: [],\n    preRender: [],\n    postRender: [],\n    insertText: [],\n  }\n}\n","import * as utils from './utils'\nimport Point from './point'\nimport Path from './path'\nimport Snippet from './snippet'\nimport Attributes from './attributes'\nimport Hooks from './hooks'\n\nfunction Part() {\n  this.attributes = new Attributes()\n  this.points = {}\n  this.paths = {}\n  this.snippets = {}\n  this.freeId = 0\n  this.topLeft = false\n  this.bottomRight = false\n  this.width = false\n  this.height = false\n  this.render = true\n  this.utils = utils\n\n  this.Point = Point\n  this.Path = Path\n  this.Snippet = Snippet\n\n  this.hooks = new Hooks() // Hooks container\n\n  return this\n}\n\nPart.prototype.macroClosure = function (args) {\n  let self = this\n  let method = function (key, args) {\n    let macro = utils.macroName(key)\n    if (typeof self[macro] === 'function') self[macro](args)\n  }\n\n  return method\n}\n\nPart.prototype.runHooks = function (hookName, data = false) {\n  if (data === false) data = this\n  let hooks = this.hooks[hookName]\n  if (hooks && hooks.length > 0) {\n    for (let hook of hooks) {\n      hook.method(data, hook.data)\n    }\n  }\n}\n\n/** Returns an unused ID */\nPart.prototype.getId = function (prefix = '') {\n  this.freeId += 1\n\n  return prefix + this.freeId\n}\n\n/** Returns a value formatted for units provided in settings */\nPart.prototype.unitsClosure = function (value) {\n  let self = this\n  let method = function (value) {\n    if (self.context.settings.debug && typeof value !== 'number')\n      self.context.raise.debug(\n        `Calling \\`units(value)\\` but \\`value\\` is not a number (\\`${typeof value}\\`)`\n      )\n    return utils.units(value, self.context.settings.units)\n  }\n\n  return method\n}\n\n/** Calculates the part's bounding box and sets it */\nPart.prototype.boundary = function () {\n  if (this.topLeft) return this // Cached\n\n  let topLeft = new Point(Infinity, Infinity)\n  let bottomRight = new Point(-Infinity, -Infinity)\n  for (let key in this.paths) {\n    try {\n      let path = this.paths[key].boundary()\n      if (path.render) {\n        if (path.topLeft.x < topLeft.x) topLeft.x = path.topLeft.x\n        if (path.topLeft.y < topLeft.y) topLeft.y = path.topLeft.y\n        if (path.bottomRight.x > bottomRight.x) bottomRight.x = path.bottomRight.x\n        if (path.bottomRight.y > bottomRight.y) bottomRight.y = path.bottomRight.y\n      }\n    } catch (err) {\n      this.context.raise.error(`Could not calculate boundary of \\`paths.${key}\\``)\n      this.context.raise.debug(\n        `Since \\`paths.${key}\\` has no boundary, neither does \\`parts.${this.name}\\`. Ejecting part`\n      )\n      return false\n    }\n  }\n  for (let key in this.points) {\n    let point = this.points[key]\n    let radius = point.attributes.get('data-circle')\n    if (radius) {\n      radius = parseFloat(radius)\n      if (point.x - radius < topLeft.x) topLeft.x = point.x - radius\n      if (point.y - radius < topLeft.y) topLeft.y = point.y - radius\n      if (point.x + radius > bottomRight.x) bottomRight.x = point.x + radius\n      if (point.y + radius > bottomRight.y) bottomRight.y = point.y + radius\n    }\n  }\n  // Fix infinity if part has no paths\n  if (topLeft.x === Infinity) topLeft.x = 0\n  if (topLeft.y === Infinity) topLeft.y = 0\n  if (bottomRight.x === -Infinity) bottomRight.x = 0\n  if (bottomRight.y === -Infinity) bottomRight.y = 0\n  // Add margin\n  let margin = this.context.settings.margin\n  if (this.context.settings.paperless && margin < 10) margin = 10\n  this.topLeft = new Point(topLeft.x - margin, topLeft.y - margin)\n  this.bottomRight = new Point(bottomRight.x + margin, bottomRight.y + margin)\n  this.width = this.bottomRight.x - this.topLeft.x\n  this.height = this.bottomRight.y - this.topLeft.y\n\n  return this\n}\n\n/** Stacks part so that its top left corner is in (0,0) */\nPart.prototype.stack = function () {\n  if (this.topLeft !== false) return this\n  else this.boundary()\n  if (this.topLeft.x == 0 && this.topLeft.y == 0) return this\n  else this.attr('transform', `translate(${this.topLeft.x * -1}, ${this.topLeft.y * -1})`)\n\n  return this\n}\n\n/** Adds an attribute. This is here to make this call chainable in assignment */\nPart.prototype.attr = function (name, value, overwrite = false) {\n  if (overwrite) this.attributes.set(name, value)\n  else this.attributes.add(name, value)\n\n  return this\n}\n\n/** Copies point/path/snippet data from part orig into this */\nPart.prototype.inject = function (orig) {\n  const findBasePoint = (p) => {\n    for (let i in orig.points) {\n      if (orig.points[i] === p) return i\n    }\n\n    return false\n  }\n\n  for (let i in orig.points) this.points[i] = orig.points[i].clone()\n  for (let i in orig.paths) {\n    this.paths[i] = orig.paths[i].clone()\n    // Keep link between points and path ops where possible\n    for (let j in orig.paths[i].ops) {\n      let op = orig.paths[i].ops[j]\n      if (op.type !== 'close') {\n        let toPoint = findBasePoint(op.to)\n        if (toPoint) this.paths[i].ops[j].to = this.points[toPoint]\n      }\n      if (op.type === 'curve') {\n        let cp1Point = findBasePoint(op.cp1)\n        if (cp1Point) this.paths[i].ops[j].cp1 = this.points[cp1Point]\n        let cp2Point = findBasePoint(op.cp2)\n        if (cp2Point) this.paths[i].ops[j].cp2 = this.points[cp2Point]\n      }\n    }\n  }\n  for (let i in orig.snippets) {\n    this.snippets[i] = orig.snippets[i].clone()\n  }\n\n  return this\n}\n\nPart.prototype.units = function (input) {\n  return utils.units(input, this.context.settings.units)\n}\n\n/** Returns an object with shorthand access for pattern design */\nPart.prototype.shorthand = function () {\n  let complete = this.context.settings.complete ? true : false\n  let paperless = this.context.settings.paperless === true ? true : false\n  let sa = this.context.settings.complete ? this.context.settings.sa || 0 : 0\n  const shorthand = {\n    sa,\n    store: this.context.store,\n    macro: this.macroClosure(),\n    units: this.unitsClosure(),\n    utils: utils,\n    complete,\n    paperless,\n    events: this.context.events,\n    raise: this.context.raise,\n  }\n\n  if (this.context.settings.debug) {\n    // We'll need this\n    let self = this\n\n    // Wrap the Point constructor so objects can raise events\n    shorthand.Point = function (x, y) {\n      Point.apply(this, [x, y, true])\n      Object.defineProperty(this, 'raise', { value: self.context.raise })\n    }\n    shorthand.Point.prototype = Object.create(Point.prototype)\n    // Wrap the Path constructor so objects can raise events\n    shorthand.Path = function () {\n      Path.apply(this, [true])\n      Object.defineProperty(this, 'raise', { value: self.context.raise })\n    }\n    shorthand.Path.prototype = Object.create(Path.prototype)\n    // Wrap the Snippet constructor so objects can raise events\n    shorthand.Snippet = function (def, anchor) {\n      Snippet.apply(this, [def, anchor, true])\n      Snippet.apply(this, arguments)\n      Object.defineProperty(this, 'raise', { value: self.context.raise })\n    }\n    shorthand.Snippet.prototype = Object.create(Snippet.prototype)\n\n    // Proxy the points object\n    const pointsProxy = {\n      get: function () {\n        return Reflect.get(...arguments)\n      },\n      set: (points, name, value) => {\n        // Constructor checks\n        if (value instanceof Point !== true)\n          self.context.raise.warning(\n            `\\`points.${name}\\` was set with a value that is not a \\`Point\\` object`\n          )\n        if (value.x == null || !utils.isCoord(value.x))\n          self.context.raise.warning(\n            `\\`points.${name}\\` was set with a \\`x\\` parameter that is not a \\`number\\``\n          )\n        if (value.y == null || !utils.isCoord(value.y))\n          self.context.raise.warning(\n            `\\`points.${name}\\` was set with a \\`y\\` parameter that is not a \\`number\\``\n          )\n        try {\n          value.name = name\n        } catch (err) {\n          self.context.raise.warning(`Could not set \\`name\\` property on \\`points.${name}\\``)\n        }\n        return (self.points[name] = value)\n      },\n    }\n    shorthand.points = new Proxy(this.points || {}, pointsProxy)\n    // Proxy the paths object\n    const pathsProxy = {\n      get: function () {\n        return Reflect.get(...arguments)\n      },\n      set: (paths, name, value) => {\n        // Constructor checks\n        if (value instanceof Path !== true)\n          self.context.raise.warning(\n            `\\`paths.${name}\\` was set with a value that is not a \\`Path\\` object`\n          )\n        try {\n          value.name = name\n        } catch (err) {\n          self.context.raise.warning(`Could not set \\`name\\` property on \\`paths.${name}\\``)\n        }\n        return (self.paths[name] = value)\n      },\n    }\n    shorthand.paths = new Proxy(this.paths || {}, pathsProxy)\n    // Proxy the snippets object\n    const snippetsProxy = {\n      get: function (target, prop, receiver) {\n        return Reflect.get(...arguments)\n      },\n      set: (snippets, name, value) => {\n        // Constructor checks\n        if (value instanceof Snippet !== true)\n          self.context.raise.warning(\n            `\\`snippets.${name}\\` was set with a value that is not a \\`Snippet\\` object`\n          )\n        if (typeof value.def !== 'string')\n          self.context.raise.warning(\n            `\\`snippets.${name}\\` was set with a \\`def\\` parameter that is not a \\`string\\``\n          )\n        if (value.anchor instanceof Point !== true)\n          self.context.raise.warning(\n            `\\`snippets.${name}\\` was set with an \\`anchor\\` parameter that is not a \\`Point\\``\n          )\n        try {\n          value.name = name\n        } catch (err) {\n          self.context.raise.warning(`Could not set \\`name\\` property on \\`snippets.${name}\\``)\n        }\n        return (self.snippets[name] = value)\n      },\n    }\n    shorthand.snippets = new Proxy(this.snippets || {}, snippetsProxy)\n    // Proxy the measurements object\n    const measurementsProxy = {\n      get: function (measurements, name) {\n        if (typeof measurements[name] === 'undefined')\n          self.context.raise.warning(\n            `Tried to access \\`measurements.${name}\\` but it is \\`undefined\\``\n          )\n        return Reflect.get(...arguments)\n      },\n      set: (measurements, name, value) => (self.context.settings.measurements[name] = value),\n    }\n    shorthand.measurements = new Proxy(this.context.settings.measurements || {}, measurementsProxy)\n    // Proxy the options object\n    const optionsProxy = {\n      get: function (options, name) {\n        if (typeof options[name] === 'undefined')\n          self.context.raise.warning(`Tried to access \\`options.${name}\\` but it is \\`undefined\\``)\n        return Reflect.get(...arguments)\n      },\n      set: (options, name, value) => (self.context.settings.options[name] = value),\n    }\n    shorthand.options = new Proxy(this.context.settings.options || {}, optionsProxy)\n  } else {\n    shorthand.Point = Point\n    shorthand.Path = Path\n    shorthand.Snippet = Snippet\n    shorthand.points = this.points || {}\n    shorthand.paths = this.paths || {}\n    shorthand.snippets = this.snippets || {}\n    shorthand.measurements = this.context.settings.measurements || {}\n    shorthand.options = this.context.settings.options || {}\n  }\n\n  return shorthand\n}\n\nexport default Part\n","import Attributes from './attributes'\nimport { round } from './utils'\nimport { version } from '../package.json'\n\nfunction Svg(pattern) {\n  this.openGroups = []\n  this.layout = {}\n  this.freeId = 0\n  this.body = ''\n  this.style = ''\n  this.script = ''\n  this.defs = ''\n  this.pattern = pattern // Needed to expose pattern to hooks\n  this.prefix = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>'\n  this.attributes = new Attributes()\n  this.attributes.add('xmlns', 'http://www.w3.org/2000/svg')\n  this.attributes.add('xmlns:svg', 'http://www.w3.org/2000/svg')\n  this.attributes.add('xmlns:xlink', 'http://www.w3.org/1999/xlink')\n  this.attributes.add('xml:lang', pattern.settings.locale)\n  this.attributes.add('xmlns:freesewing', 'http://freesewing.org/namespaces/freesewing')\n  this.attributes.add('freesewing', version)\n}\n\nSvg.prototype.runHooks = function (hookName, data = false) {\n  if (data === false) data = this\n  let hooks = this.hooks[hookName]\n  if (hooks.length > 0) {\n    for (let hook of hooks) {\n      hook.method(data, hook.data)\n    }\n  }\n}\n\n/** Runs insertText hooks */\nSvg.prototype.insertText = function (text) {\n  if (this.hooks.insertText.length > 0) {\n    for (let hook of this.hooks.insertText)\n      text = hook.method(this.pattern.settings.locale, text, hook.data)\n  }\n\n  return text\n}\n\n/** Renders a draft object as SVG */\nSvg.prototype.render = function (pattern) {\n  this.idPrefix = pattern.settings.idPrefix\n  this.runHooks('preRender')\n  if (!pattern.settings.embed) {\n    this.attributes.add('width', round(pattern.width) + 'mm')\n    this.attributes.add('height', round(pattern.height) + 'mm')\n  }\n  this.attributes.add('viewBox', `0 0 ${pattern.width} ${pattern.height}`)\n  this.head = this.renderHead()\n  this.tail = this.renderTail()\n  this.svg = ''\n  this.layout = {} // Reset layout\n  for (let partId in pattern.parts) {\n    let part = pattern.parts[partId]\n    if (part.render) {\n      let partSvg = this.renderPart(part)\n      this.layout[partId] = {\n        svg: partSvg,\n        transform: part.attributes.getAsArray('transform'),\n      }\n      this.svg += this.openGroup(`${this.idPrefix}part-${partId}`, part.attributes)\n      this.svg += partSvg\n      this.svg += this.closeGroup()\n    }\n  }\n  this.svg = this.prefix + this.renderSvgTag() + this.head + this.svg + this.tail\n  this.runHooks('postRender')\n\n  return this.svg\n}\n\n/** Renders SVG head section */\nSvg.prototype.renderHead = function () {\n  let svg = this.renderStyle()\n  svg += this.renderScript()\n  svg += this.renderDefs()\n  svg += this.openGroup(this.idPrefix + 'container')\n\n  return svg\n}\n\n/** Renders SVG closing section */\nSvg.prototype.renderTail = function () {\n  let svg = ''\n  svg += this.closeGroup()\n  svg += this.nl() + '</svg>'\n\n  return svg\n}\n\n/** Returns SVG code for the opening SVG tag */\nSvg.prototype.renderSvgTag = function () {\n  let svg = '<svg'\n  this.indent()\n  svg += this.nl() + this.attributes.render()\n  this.outdent()\n  svg += this.nl() + '>' + this.nl()\n\n  return svg\n}\n\n/** Returns SVG code for the style block */\nSvg.prototype.renderStyle = function () {\n  let svg = '<style type=\"text/css\"> <![CDATA[ '\n  this.indent()\n  svg += this.nl() + this.style\n  this.outdent()\n  svg += this.nl() + ']]>' + this.nl() + '</style>' + this.nl()\n  return svg\n}\n\n/** Returns SVG code for the script block */\nSvg.prototype.renderScript = function () {\n  let svg = '<script type=\"text/javascript\"> <![CDATA['\n  this.indent()\n  svg += this.nl() + this.script\n  this.outdent()\n  svg += this.nl() + ']]>' + this.nl() + '</script>' + this.nl()\n\n  return svg\n}\n\n/** Returns SVG code for the defs block */\nSvg.prototype.renderDefs = function () {\n  let svg = '<defs>'\n  this.indent()\n  svg += this.nl() + this.defs\n  this.outdent()\n  svg += this.nl() + '</defs>' + this.nl()\n\n  return svg\n}\n\n/** Returns SVG code for a Part object */\nSvg.prototype.renderPart = function (part) {\n  let svg = ''\n  for (let key in part.paths) {\n    let path = part.paths[key]\n    if (path.render) svg += this.renderPath(path)\n  }\n  for (let key in part.points) {\n    if (part.points[key].attributes.get('data-text')) {\n      svg += this.renderText(part.points[key])\n    }\n    if (part.points[key].attributes.get('data-circle')) {\n      svg += this.renderCircle(part.points[key])\n    }\n  }\n  for (let key in part.snippets) {\n    let snippet = part.snippets[key]\n    svg += this.renderSnippet(snippet, part)\n  }\n\n  return svg\n}\n\n/** Returns SVG code for a Path object */\nSvg.prototype.renderPath = function (path) {\n  if (!path.attributes.get('id')) path.attributes.add('id', this.idPrefix + this.getId())\n  path.attributes.set('d', path.asPathstring())\n\n  return `${this.nl()}<path ${path.attributes.render()} />${this.renderPathText(path)}`\n}\n\nSvg.prototype.renderPathText = function (path) {\n  let text = path.attributes.get('data-text')\n  if (!text) return ''\n  else this.text = this.insertText(text)\n  let attributes = path.attributes.renderIfPrefixIs('data-text-')\n  // Sadly aligning text along a patch can't be done in CSS only\n  let offset = ''\n  let align = path.attributes.get('data-text-class')\n  if (align && align.indexOf('center') > -1) offset = ' startOffset=\"50%\" '\n  else if (align && align.indexOf('right') > -1) offset = ' startOffset=\"100%\" '\n  let svg = this.nl() + '<text>'\n  this.indent()\n  svg += `<textPath xlink:href=\"#${path.attributes.get(\n    'id'\n  )}\" ${offset}><tspan ${attributes}>${this.escapeText(this.text)}</tspan></textPath>`\n  this.outdent()\n  svg += this.nl() + '</text>'\n\n  return svg\n}\n\nSvg.prototype.renderText = function (point) {\n  let text = point.attributes.getAsArray('data-text')\n  if (text !== false) {\n    let joint = ''\n    for (let string of text) {\n      this.text = this.insertText(string)\n      joint += this.text + ' '\n    }\n    this.text = this.insertText(joint)\n  }\n  point.attributes.set('data-text-x', round(point.x))\n  point.attributes.set('data-text-y', round(point.y))\n  let lineHeight = point.attributes.get('data-text-lineheight') || 12\n  point.attributes.remove('data-text-lineheight')\n  let svg = `${this.nl()}<text ${point.attributes.renderIfPrefixIs('data-text-')}>`\n  this.indent()\n  // Multi-line text?\n  if (this.text.indexOf('\\n') !== -1) {\n    let lines = this.text.split('\\n')\n    svg += `<tspan>${lines.shift()}</tspan>`\n    for (let line of lines) {\n      svg += `<tspan x=\"${round(point.x)}\" dy=\"${lineHeight}\">${line}</tspan>`\n    }\n  } else {\n    svg += `<tspan>${this.escapeText(this.text)}</tspan>`\n  }\n  this.outdent()\n  svg += this.nl() + '</text>'\n\n  return svg\n}\n\nSvg.prototype.escapeText = function (text) {\n  return text.replace('\"', '&#8220;')\n}\n\nSvg.prototype.renderCircle = function (point) {\n  return `<circle cx=\"${round(point.x)}\" cy=\"${round(point.y)}\" r=\"${point.attributes.get(\n    'data-circle'\n  )}\" ${point.attributes.renderIfPrefixIs('data-circle-')}></circle>`\n}\n\n/** Returns SVG code for a snippet */\nSvg.prototype.renderSnippet = function (snippet, part) {\n  let x = round(snippet.anchor.x)\n  let y = round(snippet.anchor.y)\n  let scale = snippet.attributes.get('data-scale')\n  if (scale) {\n    snippet.attributes.add('transform', `translate(${x}, ${y})`)\n    snippet.attributes.add('transform', `scale(${scale})`)\n    snippet.attributes.add('transform', `translate(${x * -1}, ${y * -1})`)\n  }\n  let rotate = snippet.attributes.get('data-rotate')\n  if (rotate) {\n    snippet.attributes.add('transform', `rotate(${rotate}, ${x}, ${y})`)\n  }\n  let svg = this.nl()\n  svg += `<use x=\"${x}\" y=\"${y}\" `\n  svg += `xlink:href=\"#${snippet.def}\" ${snippet.attributes.render()}>`\n  svg += '</use>'\n\n  return svg\n}\n\n/** Returns SVG code to open a group */\nSvg.prototype.openGroup = function (id, attributes = false) {\n  let svg = this.nl() + this.nl()\n  svg += `<!-- Start of group #${id} -->`\n  svg += this.nl()\n  svg += `<g id=\"${id}\"`\n  if (attributes) svg += ` ${attributes.render()}`\n  svg += '>'\n  this.indent()\n  this.openGroups.push(id)\n\n  return svg\n}\n\n/** Returns SVG code to close a group */\nSvg.prototype.closeGroup = function () {\n  this.outdent()\n\n  return `${this.nl()}</g>${this.nl()}<!-- end of group #${this.openGroups.pop()} -->`\n}\n\n/** Returns a linebreak + identation */\nSvg.prototype.nl = function () {\n  return '\\n' + this.tab()\n}\n\n/** Returns indentation */\nSvg.prototype.tab = function () {\n  let space = ''\n  for (let i = 0; i < this.tabs; i++) {\n    space += '  '\n  }\n\n  return space\n}\n\n/** Increases indentation by 1 */\nSvg.prototype.indent = function () {\n  this.tabs += 1\n}\n\n/** Decreases indentation by 1 */\nSvg.prototype.outdent = function () {\n  this.tabs -= 1\n}\n\n/** Returns an unused ID */\nSvg.prototype.getId = function () {\n  this.freeId += 1\n\n  return '' + this.freeId\n}\n\nexport default Svg\n","/******************************************************************************\n\nThis is a binary tree based bin packing algorithm that is more complex than\nthe simple Packer (packer.js). Instead of starting off with a fixed width and\nheight, it starts with the width and height of the first block passed and then\ngrows as necessary to accomodate each subsequent block. As it grows it attempts\nto maintain a roughly square ratio by making 'smart' choices about whether to\ngrow right or down.\n\nWhen growing, the algorithm can only grow to the right OR down. Therefore, if\nthe new block is BOTH wider and taller than the current target then it will be\nrejected. This makes it very important to initialize with a sensible starting\nwidth and height. If you are providing sorted input (largest first) then this\nwill not be an issue.\n\nA potential way to solve this limitation would be to allow growth in BOTH\ndirections at once, but this requires maintaining a more complex tree\nwith 3 children (down, right and center) and that complexity can be avoided\nby simply chosing a sensible starting block.\n\nBest results occur when the input blocks are sorted by height, or even better\nwhen sorted by max(width,height).\n\nInputs:\n------\n\n\tblocks: array of any objects that have .w and .h attributes\n\nOutputs:\n-------\n\n\tmarks each block that fits with a .fit attribute pointing to a\n\tnode with .x and .y coordinates\n\nExample:\n-------\n\n\tvar blocks = [\n\t\t{ w: 100, h: 100 },\n\t\t{ w: 100, h: 100 },\n\t\t{ w:  80, h:  80 },\n\t\t{ w:  80, h:  80 },\n\t\tetc\n\t\tetc\n\t];\n\n\tvar packer = new GrowingPacker();\n\tpacker.fit(blocks);\n\n\tfor(var n = 0 ; n < blocks.length ; n++) {\n\t\tvar block = blocks[n];\n\t\tif (block.fit) {\n\t\t\tDraw(block.fit.x, block.fit.y, block.w, block.h);\n\t\t}\n\t}\n\n\n******************************************************************************/\n\nvar GrowingPacker = function() { };\n\nGrowingPacker.prototype = {\n\n\tfit: function(blocks) {\n\t\tvar n, node, block, len = blocks.length, fit;\n\t\tvar width  = len > 0 ? blocks[0].width : 0;\n\t\tvar height = len > 0 ? blocks[0].height : 0;\n\t\tthis.root = { x: 0, y: 0, width: width, height: height };\n\t\tfor (n = 0; n < len ; n++) {\n\t\t\tblock = blocks[n];\n\t\t\tif (node = this.findNode(this.root, block.width, block.height)) {\n\t\t\t\tfit = this.splitNode(node, block.width, block.height);\n\t\t\t\tblock.x = fit.x;\n\t\t\t\tblock.y = fit.y;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfit = this.growNode(block.width, block.height);\n\t\t\t\tblock.x = fit.x;\n\t\t\t\tblock.y = fit.y;\n\t\t\t}\n\t\t}\n\t},\n\n\tfindNode: function(root, width, height) {\n\t\tif (root.used)\n\t\t\treturn this.findNode(root.right, width, height) || this.findNode(root.down, width, height);\n\t\telse if ((width <= root.width) && (height <= root.height))\n\t\t\treturn root;\n\t\telse\n\t\t\treturn null;\n\t},\n\n\tsplitNode: function(node, width, height) {\n\t\tnode.used = true;\n\t\tnode.down  = { x: node.x,         y: node.y + height, width: node.width,         height: node.height - height };\n\t\tnode.right = { x: node.x + width, y: node.y,          width: node.width - width, height: height               };\n\t\treturn node;\n\t},\n\n\tgrowNode: function(width, height) {\n\t\tvar canGrowDown  = (width  <= this.root.width);\n\t\tvar canGrowRight = (height <= this.root.height);\n\n\t\tvar shouldGrowRight = canGrowRight && (this.root.height >= (this.root.width  + width )); // attempt to keep square-ish by growing right when height is much greater than width\n\t\tvar shouldGrowDown  = canGrowDown  && (this.root.width  >= (this.root.height + height)); // attempt to keep square-ish by growing down  when width  is much greater than height\n\n\t\tif (shouldGrowRight)\n\t\t\treturn this.growRight(width, height);\n\t\telse if (shouldGrowDown)\n\t\t\treturn this.growDown(width, height);\n\t\telse if (canGrowRight)\n\t\t\treturn this.growRight(width, height);\n\t\telse if (canGrowDown)\n\t\t\treturn this.growDown(width, height);\n\t\telse\n\t\t\treturn null; // need to ensure sensible root starting size to avoid this happening\n\t},\n\n\tgrowRight: function(width, height) {\n\t\tthis.root = {\n\t\t\tused: true,\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\twidth: this.root.width + width,\n\t\t\theight: this.root.height,\n\t\t\tdown: this.root,\n\t\t\tright: { x: this.root.width, y: 0, width: width, height: this.root.height }\n\t\t};\n\t\tvar node;\n\t\tif (node = this.findNode(this.root, width, height))\n\t\t\treturn this.splitNode(node, width, height);\n\t\telse\n\t\t\treturn null;\n\t},\n\n\tgrowDown: function(width, height) {\n\t\tthis.root = {\n\t\t\tused: true,\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\twidth: this.root.width,\n\t\t\theight: this.root.height + height,\n\t\t\tdown:  { x: 0, y: this.root.height, width: this.root.width, height: height },\n\t\t\tright: this.root\n\t\t};\n\t\tvar node;\n\t\tif (node = this.findNode(this.root, width, height))\n\t\t\treturn this.splitNode(node, width, height);\n\t\telse\n\t\t\treturn null;\n\t}\n\n};\n\nmodule.exports = GrowingPacker;\n\n","\"use strict\";\n\nvar GrowingPacker = require('./packer.growing.js');\n\nmodule.exports = function(items, options) {\n\toptions = options || {};\n\tvar packer = new GrowingPacker();\n\tvar inPlace = options.inPlace || false;\n\n\t// Clone the items.\n\tvar newItems = items.map(function(item) { return inPlace ? item : { width: item.width, height: item.height, item: item }; });\n\n\tnewItems = newItems.sort(function(a, b) {\n\t\t// TODO: check that each actually HAS a width and a height.\n\t\t// Sort based on the size (area) of each block.\n\t\treturn (b.width * b.height) - (a.width * a.height);\n\t});\n\n\tpacker.fit(newItems);\n\n\tvar w = newItems.reduce(function(curr, item) { return Math.max(curr, item.x + item.width); }, 0);\n\tvar h = newItems.reduce(function(curr, item) { return Math.max(curr, item.y + item.height); }, 0);\n\n\tvar ret = {\n\t\twidth: w,\n\t\theight: h\n\t};\n\n\tif (!inPlace) {\n\t\tret.items = newItems;\n\t}\n\n\treturn ret;\n};\n","function Store(raise) {\n  this.data = new Map()\n  this.raise = raise\n}\n\n/** Sets a value under index key */\nStore.prototype.set = function (key, value) {\n  this.data.set(key, value)\n}\n\n/** Sets a value under index key */\nStore.prototype.setIfUnset = function (key, value) {\n  if (!this.data.has(key)) this.data.set(key, value)\n}\n\n/** Gets a value under index key */\nStore.prototype.get = function (key) {\n  if (!this.data.has(key))\n    this.raise.warning(`Tried to access \\`${key}\\` in the \\`store\\` but it is not set`)\n  return this.data.get(key)\n}\n\nexport default Store\n","import { macroName, sampleStyle, capitalize } from './utils'\nimport Part from './part'\nimport Point from './point'\nimport Path from './path'\nimport Snippet from './snippet'\nimport Svg from './svg'\nimport pack from 'bin-pack'\nimport Store from './store'\nimport Hooks from './hooks'\nimport Attributes from './attributes'\nimport { version } from '../package.json'\n\nexport default function Pattern(config = { options: {} }) {\n  // Events store and raise methods\n  this.events = {\n    info: [],\n    warning: [],\n    error: [],\n    debug: [],\n  }\n  const events = this.events\n  this.raise = {\n    info: function (data) {\n      events.info.push(data)\n    },\n    warning: function (data) {\n      events.warning.push(data)\n    },\n    error: function (data) {\n      events.error.push(data)\n    },\n    debug: function (data) {\n      events.debug.push(data)\n    },\n  }\n  this.raise.debug(\n    `New \\`@freesewing/${config.name}:${config.version}\\` pattern using \\`@freesewing/core:${version}\\``\n  )\n\n  this.config = config // Pattern configuration\n  this.width = 0 // Will be set after render\n  this.height = 0 // Will be set after render\n  this.is = '' // Will be set when drafting/sampling\n  this.debug = true // Will be set when applying settings\n\n  this.store = new Store(this.raise) // Store for sharing data across parts\n  this.parts = {} // Parts container\n  this.hooks = new Hooks() // Hooks container\n  this.Point = Point // Point constructor\n  this.Path = Path // Path constructor\n  this.Snippet = Snippet // Snippet constructor\n  this.Attributes = Attributes // Attributes constructor\n\n  // Default settings\n  this.settings = {\n    complete: true,\n    idPrefix: 'fs-',\n    locale: 'en',\n    units: 'metric',\n    margin: 2,\n    layout: true,\n    debug: true,\n    options: {},\n  }\n\n  if (typeof this.config.dependencies === 'undefined') this.config.dependencies = {}\n  if (typeof this.config.inject === 'undefined') this.config.inject = {}\n  if (typeof this.config.hide === 'undefined') this.config.hide = []\n  this.config.resolvedDependencies = this.resolveDependencies(this.config.dependencies)\n  this.config.draftOrder = this.draftOrder(this.config.resolvedDependencies)\n\n  // Convert options\n  for (let i in config.options) {\n    let option = config.options[i]\n    if (typeof option === 'object') {\n      if (typeof option.pct !== 'undefined') this.settings.options[i] = option.pct / 100\n      else if (typeof option.mm !== 'undefined') this.settings.options[i] = option.mm\n      else if (typeof option.deg !== 'undefined') this.settings.options[i] = option.deg\n      else if (typeof option.count !== 'undefined') this.settings.options[i] = option.count\n      else if (typeof option.bool !== 'undefined') this.settings.options[i] = option.bool\n      else if (typeof option.dflt !== 'undefined') this.settings.options[i] = option.dflt\n      else {\n        let err = 'Unknown option type: ' + JSON.stringify(option)\n        this.raise.error(err)\n        throw new Error(err)\n      }\n    } else {\n      this.settings.options[i] = option\n    }\n  }\n\n  // Macros\n  this.macros = {}\n\n  // Context object to add to Part closure\n  const context = {\n    parts: this.parts,\n    config: this.config,\n    settings: this.settings,\n    store: this.store,\n    macros: this.macros,\n    events: this.events,\n    raise: this.raise,\n  }\n\n  // Part closure\n  this.Part = function (name = false) {\n    let part = new Part()\n    part.context = context\n    for (let macro in context.macros) {\n      part[macroName(macro)] = context.macros[macro]\n    }\n    if (name) part.name = name\n\n    return part\n  }\n}\n\n// Merges settings object with this.settings\nPattern.prototype.apply = function (settings) {\n  if (typeof settings !== 'object') {\n    this.raise.warning('Pattern initialized without any settings')\n    return this\n  }\n  for (let key of Object.keys(settings)) {\n    if (Array.isArray(settings[key])) {\n      if (Array.isArray(this.settings[key])) {\n        for (let entry of settings[key]) this.settings[key].push(entry)\n      } else this.settings[key] = settings[key]\n    } else if (typeof settings[key] === 'object') {\n      this.settings[key] = {\n        ...this.settings[key],\n        ...settings[key],\n      }\n    } else this.settings[key] = settings[key]\n  }\n  if (!this.settings.debug) this.debug = false\n\n  return this\n}\n\nPattern.prototype.runHooks = function (hookName, data = false) {\n  if (data === false) data = this\n  let hooks = this.hooks[hookName]\n  if (hooks.length > 0) {\n    if (this.debug) this.raise.debug(`Running \\`${hookName}\\` hooks`)\n    for (let hook of hooks) {\n      hook.method(data, hook.data)\n    }\n  }\n}\n\n/**\n *  The default draft method with pre- and postDraft hooks\n */\nPattern.prototype.draft = function () {\n  if (this.is !== 'sample') {\n    this.is = 'draft'\n    if (this.debug) this.raise.debug(`Drafting pattern`)\n  }\n  this.runHooks('preDraft')\n  for (let partName of this.config.draftOrder) {\n    if (this.debug) this.raise.debug(`Creating part \\`${partName}\\``)\n    this.parts[partName] = new this.Part(partName)\n    if (typeof this.config.inject[partName] === 'string') {\n      if (this.debug)\n        this.raise.debug(\n          `Injecting part \\`${this.config.inject[partName]}\\` into part \\`${partName}\\``\n        )\n      try {\n        this.parts[partName].inject(this.parts[this.config.inject[partName]])\n      } catch (err) {\n        this.raise.error([\n          `Could not inject part \\`${this.config.inject[partName]}\\` into part \\`${partName}\\``,\n          err,\n        ])\n      }\n    }\n    if (this.needs(partName)) {\n      let method = 'draft' + capitalize(partName)\n      if (typeof this[method] !== 'function') {\n        this.raise.error(`Method \\`pattern.${method}\\` is callable`)\n        throw new Error('Method \"' + method + '\" on pattern object is not callable')\n      }\n      try {\n        this.parts[partName] = this[method](this.parts[partName])\n      } catch (err) {\n        this.raise.error([`Unable to draft part \\`${partName}\\``, err])\n      }\n      if (typeof this.parts[partName] === 'undefined') {\n        this.raise.error(\n          `Result of \\`pattern.${method}\\` was \\`undefined\\`. Did you forget to return the \\`Part\\` object?`\n        )\n      }\n      try {\n        this.parts[partName].render =\n          this.parts[partName].render === false ? false : this.wants(partName)\n      } catch (err) {\n        this.raise.error([`Unable to set \\`render\\` property on part \\`${partName}\\``, err])\n      }\n    } else {\n      if (this.debug)\n        this.raise.debug(\n          `Part \\`${partName}\\` is not needed. Skipping draft and setting render to \\`false\\``\n        )\n      this.parts[partName].render = false\n    }\n  }\n  this.runHooks('postDraft')\n\n  return this\n}\n\n/**\n * Handles pattern sampling\n */\nPattern.prototype.sample = function () {\n  if (this.settings.sample.type === 'option') {\n    return this.sampleOption(this.settings.sample.option)\n  } else if (this.settings.sample.type === 'measurement') {\n    return this.sampleMeasurement(this.settings.sample.measurement)\n  } else if (this.settings.sample.type === 'models') {\n    return this.sampleModels(this.settings.sample.models, this.settings.sample.focus || false)\n  }\n}\n\nPattern.prototype.sampleParts = function () {\n  let parts = {}\n  this.settings.complete = false\n  this.settings.paperless = false\n  this.draft()\n  for (let i in this.parts) {\n    parts[i] = new this.Part()\n    parts[i].render = this.parts[i].render\n  }\n  return parts\n}\n\nPattern.prototype.sampleRun = function (parts, anchors, run, runs, extraClass = false) {\n  this.draft()\n  for (let i in this.parts) {\n    let anchor = false\n    let dx = 0\n    let dy = 0\n    if (this.parts[i].points.anchor) {\n      if (typeof anchors[i] === 'undefined') anchors[i] = this.parts[i].points.anchor\n      else {\n        if (!anchors[i].sitsOn(this.parts[i].points.anchor)) {\n          dx = this.parts[i].points.anchor.dx(anchors[i])\n          dy = this.parts[i].points.anchor.dy(anchors[i])\n        }\n      }\n    }\n    for (let j in this.parts[i].paths) {\n      parts[i].paths[j + '_' + run] = this.parts[i].paths[j]\n        .clone()\n        .attr(\n          'style',\n          extraClass === 'sample-focus'\n            ? this.settings.sample\n              ? this.settings.sample.focusStyle || sampleStyle(run, runs)\n              : sampleStyle(run, runs)\n            : sampleStyle(\n                run,\n                runs,\n                this.settings.sample ? this.settings.sample.styles || false : false\n              )\n        )\n        .attr('data-sample-run', run)\n        .attr('data-sample-runs', runs)\n      if (this.parts[i].points.anchor)\n        parts[i].paths[j + '_' + run] = parts[i].paths[j + '_' + run].translate(dx, dy)\n      if (extraClass !== false) parts[i].paths[j + '_' + run].attributes.add('class', extraClass)\n    }\n  }\n}\n\n/**\n * Handles option sampling\n */\nPattern.prototype.sampleOption = function (optionName) {\n  this.is = 'sample'\n  if (this.debug) this.raise.debug(`Sampling option \\`${optionName}\\``)\n  this.runHooks('preSample')\n  let step, val\n  let factor = 1\n  let anchors = {}\n  let parts = this.sampleParts()\n  let option = this.config.options[optionName]\n  if (typeof option.list === 'object') {\n    return this.sampleListOption(optionName)\n  }\n  if (typeof option.min === 'undefined' || typeof option.max === 'undefined') {\n    let min = option * 0.9\n    let max = option * 1.1\n    option = { min, max }\n  }\n  if (typeof option.pct !== 'undefined') factor = 100\n  val = option.min / factor\n  step = (option.max / factor - val) / 9\n  for (let run = 1; run < 11; run++) {\n    this.settings.options[optionName] = val\n    this.sampleRun(parts, anchors, run, 10)\n    val += step\n  }\n  this.parts = parts\n  this.runHooks('postSample')\n\n  return this\n}\n\nPattern.prototype.sampleListOption = function (optionName) {\n  let parts = this.sampleParts()\n  let option = this.config.options[optionName]\n  let anchors = {}\n  let run = 1\n  let runs = option.list.length\n  for (let val of option.list) {\n    this.settings.options[optionName] = val\n    this.sampleRun(parts, anchors, run, runs)\n    run++\n  }\n  this.parts = parts\n\n  return this\n}\n\n/**\n * Handles measurement sampling\n */\nPattern.prototype.sampleMeasurement = function (measurementName) {\n  this.is = 'sample'\n  if (this.debug) this.raise.debug(`Sampling measurement \\`${measurementName}\\``)\n  this.runHooks('preSample')\n  let anchors = {}\n  let parts = this.sampleParts()\n  let val = this.settings.measurements[measurementName]\n  if (val === undefined)\n    this.raise.error(`Cannot sample measurement \\`${measurementName}\\` because it's \\`undefined\\``)\n  let step = val / 50\n  val = val * 0.9\n  for (let run = 1; run < 11; run++) {\n    this.settings.measurements[measurementName] = val\n    this.sampleRun(parts, anchors, run, 10)\n    val += step\n  }\n  this.parts = parts\n  this.runHooks('postSample')\n\n  return this\n}\n\n/**\n * Handles models sampling\n */\nPattern.prototype.sampleModels = function (models, focus = false) {\n  this.is = 'sample'\n  if (this.debug) this.raise.debug(`Sampling models`)\n  this.runHooks('preSample')\n  let anchors = {}\n  let parts = this.sampleParts()\n  // If there's a focus, do it first so it's at the bottom of the SVG\n  if (focus) {\n    this.settings.measurements = models[focus]\n    this.sampleRun(parts, anchors, -1, -1, 'sample-focus')\n    delete models[focus]\n  }\n  let run = -1\n  let runs = Object.keys(models).length\n  for (let l in models) {\n    run++\n    this.settings.measurements = models[l]\n    this.sampleRun(parts, anchors, run, runs)\n  }\n  this.parts = parts\n  this.runHooks('postSample')\n\n  return this\n}\n\nPattern.prototype.render = function () {\n  this.svg = new Svg(this)\n  this.svg.hooks = this.hooks\n\n  return this.pack().svg.render(this)\n}\n\nPattern.prototype.on = function (hook, method, data) {\n  this.hooks[hook].push({ method, data })\n}\n\nPattern.prototype.use = function (plugin, data) {\n  if (this.debug) this.raise.debug(`Loaded plugin \\`${plugin.name}:${plugin.version}\\``)\n  if (plugin.hooks) this.loadPluginHooks(plugin, data)\n  if (plugin.macros) this.loadPluginMacros(plugin)\n\n  return this\n}\n\nPattern.prototype.useIf = function (plugin, settings) {\n  if (plugin.condition(settings)) {\n    if (this.debug)\n      this.raise.debug(\n        `Condition met: Loaded plugin \\`${plugin.plugin.name}:${plugin.plugin.version}\\``\n      )\n    this.loadPluginHooks(plugin.plugin, plugin.data)\n  } else {\n    if (this.debug)\n      this.raise.debug(\n        `Condition not met: Skipped loading plugin \\`${plugin.plugin.name}:${plugin.plugin.version}\\``\n      )\n  }\n\n  return this\n}\n\nPattern.prototype.loadPluginHooks = function (plugin, data) {\n  for (let hook of Object.keys(this.hooks)) {\n    if (typeof plugin.hooks[hook] === 'function') {\n      this.on(hook, plugin.hooks[hook], data)\n    } else if (Array.isArray(plugin.hooks[hook])) {\n      for (let method of plugin.hooks[hook]) {\n        this.on(hook, method, data)\n      }\n    }\n  }\n}\n\nPattern.prototype.loadPluginMacros = function (plugin) {\n  for (let macro in plugin.macros) {\n    if (typeof plugin.macros[macro] === 'function') {\n      this.macro(macro, plugin.macros[macro])\n    }\n  }\n}\n\nPattern.prototype.macro = function (key, method) {\n  this.macros[key] = method\n}\n\n/** Packs parts in a 2D space and sets pattern size */\nPattern.prototype.pack = function () {\n  if (this.events.error.length > 0) {\n    this.raise.warning(`One or more errors occured. Not packing pattern parts`)\n    return this\n  }\n  let bins = []\n  for (let key in this.parts) {\n    let part = this.parts[key]\n    // Avoid multiple render calls to cause stacking of transforms\n    part.attributes.remove('transform')\n    if (part.render) {\n      part.stack()\n      let width = part.bottomRight.x - part.topLeft.x\n      let height = part.bottomRight.y - part.topLeft.y\n      if (this.settings.layout === true) bins.push({ id: key, width, height })\n      else {\n        if (this.width < width) this.width = width\n        if (this.height < height) this.height = height\n      }\n    }\n  }\n  if (this.settings.layout === true) {\n    let size = pack(bins, { inPlace: true })\n    for (let bin of bins) {\n      let part = this.parts[bin.id]\n      if (bin.x !== 0 || bin.y !== 0) part.attr('transform', `translate(${bin.x}, ${bin.y})`)\n    }\n    this.width = size.width\n    this.height = size.height\n  } else if (typeof this.settings.layout === 'object') {\n    this.width = this.settings.layout.width\n    this.height = this.settings.layout.height\n    for (let partId of Object.keys(this.settings.layout.parts)) {\n      let transforms = this.settings.layout.parts[partId]\n      // Moving\n      if (typeof transforms.move === 'object') {\n        this.parts[partId].attributes.set(\n          'transform',\n          'translate(' + transforms.move.x + ', ' + transforms.move.y + ')'\n        )\n      }\n      // Mirrorring\n      let center = this.parts[partId].topLeft.shiftFractionTowards(\n        this.parts[partId].bottomRight,\n        0.5\n      )\n      let anchor = { x: 0, y: 0 }\n      if (transforms.flipX) {\n        let dx = anchor.x - center.x\n        let transform = `translate(${center.x * -1}, ${center.y * -1})`\n        transform += ' scale(-1, 1)'\n        transform += ` translate(${center.x * -1 + 2 * dx}, ${center.y})`\n        this.parts[partId].attributes.add('transform', transform)\n      }\n      if (transforms.flipY) {\n        let dy = anchor.y - center.y\n        let transform = `translate(${center.x * -1}, ${center.y * -1})`\n        transform += ' scale(1, -1)'\n        transform += ` translate(${center.x}, ${center.y * -1 + 2 * dy})`\n        this.parts[partId].attributes.add('transform', transform)\n      }\n      if (transforms.rotate) {\n        let transform = `rotate(${transforms.rotate}, ${center.x - anchor.x}, ${\n          center.y - anchor.y\n        })`\n        this.parts[partId].attributes.add('transform', transform)\n      }\n    }\n  }\n\n  return this\n}\n\n/** Determines the order to draft parts in, based on dependencies */\nPattern.prototype.draftOrder = function (graph = this.resolveDependencies()) {\n  let sorted = []\n  let visited = {}\n  Object.keys(graph).forEach(function visit(name, ancestors) {\n    if (!Array.isArray(ancestors)) ancestors = []\n    ancestors.push(name)\n    visited[name] = true\n    if (typeof graph[name] !== 'undefined') {\n      graph[name].forEach(function (dep) {\n        if (visited[dep]) return\n        visit(dep, ancestors.slice(0))\n      })\n    }\n    if (sorted.indexOf(name) < 0) sorted.push(name)\n  })\n\n  return sorted\n}\n\n/** Recursively solves part dependencies for a part */\nPattern.prototype.resolveDependency = function (\n  seen,\n  part,\n  graph = this.config.dependencies,\n  deps = []\n) {\n  if (typeof seen[part] === 'undefined') seen[part] = true\n  if (typeof graph[part] === 'string') graph[part] = [graph[part]]\n  if (Array.isArray(graph[part])) {\n    if (graph[part].length === 0) return []\n    else {\n      if (deps.indexOf(graph[part]) === -1) deps.push(...graph[part])\n      for (let apart of graph[part]) deps.concat(this.resolveDependency(seen, apart, graph, deps))\n    }\n  }\n\n  return deps\n}\n\n/** Resolves part dependencies into a flat array */\nPattern.prototype.resolveDependencies = function (graph = this.config.dependencies) {\n  for (let i in this.config.inject) {\n    let dependency = this.config.inject[i]\n    if (typeof this.config.dependencies[i] === 'undefined') this.config.dependencies[i] = dependency\n    else if (this.config.dependencies[i] !== dependency) {\n      if (typeof this.config.dependencies[i] === 'string')\n        this.config.dependencies[i] = [this.config.dependencies[i], dependency]\n      else if (Array.isArray(this.config.dependencies[i])) {\n        if (this.config.dependencies[i].indexOf(dependency) === -1)\n          this.config.dependencies[i].push(dependency)\n      } else {\n        this.raise.error('Part dependencies should be a string or an array of strings')\n        throw new Error('Part dependencies should be a string or an array of strings')\n      }\n    }\n    // Parts both in the parts and dependencies array trip up the dependency resolver\n    if (Array.isArray(this.config.parts)) {\n      let pos = this.config.parts.indexOf(this.config.inject[i])\n      if (pos !== -1) this.config.parts.splice(pos, 1)\n    }\n  }\n\n  // Include parts outside the dependency graph\n  if (Array.isArray(this.config.parts)) {\n    for (let part of this.config.parts) {\n      if (typeof this.config.dependencies[part] === 'undefined') this.config.dependencies[part] = []\n    }\n  }\n\n  let resolved = {}\n  let seen = {}\n  for (let part in graph) resolved[part] = this.resolveDependency(seen, part, graph)\n  for (let part in seen) if (typeof resolved[part] === 'undefined') resolved[part] = []\n\n  return resolved\n}\n\n/** Determines whether a part is needed\n * This depends on the 'only' setting and the\n * configured dependencies.\n */\nPattern.prototype.needs = function (partName) {\n  if (typeof this.settings.only === 'undefined' || this.settings.only === false) return true\n  else if (typeof this.settings.only === 'string') {\n    if (this.settings.only === partName) return true\n    if (Array.isArray(this.config.resolvedDependencies[this.settings.only])) {\n      for (let dependency of this.config.resolvedDependencies[this.settings.only]) {\n        if (dependency === partName) return true\n      }\n    }\n  } else if (Array.isArray(this.settings.only)) {\n    for (let part of this.settings.only) {\n      if (part === partName) return true\n      for (let dependency of this.config.resolvedDependencies[part]) {\n        if (dependency === partName) return true\n      }\n    }\n  }\n\n  return false\n}\n\n/* Checks whether a part is hidden in the config */\nPattern.prototype.isHidden = function (partName) {\n  if (Array.isArray(this.config.hide)) {\n    if (this.config.hide.indexOf(partName) !== -1) return true\n  }\n\n  return false\n}\n\n/** Determines whether a part is wanted by the user\n * This depends on the 'only' setting\n */\nPattern.prototype.wants = function (partName) {\n  if (typeof this.settings.only === 'undefined' || this.settings.only === false) {\n    if (this.isHidden(partName)) return false\n  } else if (typeof this.settings.only === 'string') {\n    if (this.settings.only === partName) return true\n    return false\n  } else if (Array.isArray(this.settings.only)) {\n    for (let part of this.settings.only) {\n      if (part === partName) return true\n    }\n    return false\n  }\n\n  return true\n}\n\n/** Returns props required to render this pattern through\n *  an external renderer (eg. a React component)\n */\nPattern.prototype.getRenderProps = function () {\n  // Run pre-render hook\n  let svg = new Svg(this)\n  svg.hooks = this.hooks\n  svg.runHooks('preRender')\n\n  this.pack()\n  let props = { svg }\n  props.width = this.width\n  props.height = this.height\n  props.settings = this.settings\n  props.events = {\n    debug: this.events.debug,\n    info: this.events.info,\n    warning: this.events.warning,\n    error: this.events.error,\n  }\n  props.parts = {}\n  for (let p in this.parts) {\n    if (this.parts[p].render) {\n      props.parts[p] = {\n        paths: this.parts[p].paths,\n        points: this.parts[p].points,\n        snippets: this.parts[p].snippets,\n        attributes: this.parts[p].attributes,\n        height: this.parts[p].height,\n        width: this.parts[p].width,\n        bottomRight: this.parts[p].bottomRight,\n        topLeft: this.parts[p].topLeft,\n      }\n    }\n  }\n\n  return props\n}\n","import Pattern from './pattern'\n\nexport default function Design(config, plugins = false, conditionalPlugins = false) {\n  const pattern = function (settings) {\n    Pattern.call(this, config)\n    // Load plugins\n    if (Array.isArray(plugins)) for (let plugin of plugins) this.use(plugin)\n    else if (plugins) this.use(plugins)\n    // Load conditional plugins\n    if (Array.isArray(conditionalPlugins))\n      for (let plugin of conditionalPlugins) this.useIf(plugin, settings)\n    else if (conditionalPlugins.plugin && conditionalPlugins.condition)\n      this.useIf(conditionalPlugins, settings)\n\n    this.apply(settings)\n\n    return this\n  }\n\n  // Set up inheritance\n  pattern.prototype = Object.create(Pattern.prototype)\n  pattern.prototype.constructor = pattern\n\n  // Make config available without need to instantiate pattern\n  pattern.config = config\n\n  return pattern\n}\n","import Design from './design'\nimport Pattern from './pattern'\nimport Point from './point'\nimport Path from './path'\nimport Snippet from './snippet'\nimport * as utils from './utils'\nimport { version } from '../package.json'\n\nexport default {\n  version,\n  Design,\n  Pattern,\n  Point,\n  Path,\n  Snippet,\n  utils,\n  patterns: {},\n  plugins: {},\n}\n"],"names":["Attributes","list","prototype","add","name","value","push","set","remove","get","join","getAsArray","render","svg","key","renderAsCss","css","renderIfPrefixIs","prefix","prefixLen","length","substr","asPropsIfPrefixIs","props","propKey","clone","JSON","parse","stringify","Point","x","y","debug","attributes","Object","defineProperty","configurable","withRaise","raise","check","warning","rad2deg","radians","deg2rad","degrees","attr","overwrite","dist","that","dx","dy","Math","sqrt","pow","slope","angle","rad","atan2","PI","rotate","deg","radius","cos","sin","copy","flipX","flipY","shift","distance","p","shiftTowards","sitsOn","sitsRoughlyOn","round","shiftFractionTowards","fraction","shiftOutwards","translate","abs","acos","crt","v","pi","tau","quart","epsilon","nMax","Number","MAX_SAFE_INTEGER","nMin","MIN_SAFE_INTEGER","ZERO","z","utils","Tvalues","Cvalues","arcfn","t","derivativeFn","d","l","compute","points","_3d","order","mt","ret","mt2","t2","a","b","c","dCpts","i","splice","computeWithRatios","ratios","r","f1","f2","f3","f4","derive","dpoints","j","dpt","between","m","M","approximately","precision","len","sum","map","ds","de","ts","te","d1","d2","v2","lerp","v1","undefined","pointToString","s","pointsToString","obj","o","dx1","dy1","dx2","dy2","cross","dot","pos","indexOf","parseFloat","substring","p1","p2","closest","LUT","point","mdist","mpos","forEach","idx","abcratio","n","bottom","top","projectionratio","lli8","x1","y1","x2","y2","x3","y3","x4","y4","nx","ny","lli4","p3","p4","lli","makeline","Bezier","findbbox","sections","mx","my","MX","MY","bbox","min","max","mid","size","shapeintersections","s1","bbox1","s2","bbox2","curveIntersectionThreshold","bboxoverlap","intersections","a1","startcap","forward","back","endcap","a2","l1","virtual","l2","iss","intersects","c1","c2","makeshape","bpl","fpl","start","end","shape","getminmax","curve","concat","align","line","tx","ty","roots","aligned","reduce","m1","m2","filter","pa","pb","pc","pd","q","q2","discriminant","u1","mp3","mp33","cosphi","phi","crtr","t1","sd","droots","curvature","kOnly","num","dnm","adk","dk","k","dd","qdsum","pk","nk","inflections","slice","v3","trm","sq","b1","b2","dims","dim","expandbox","_bbox","pairiteration","c1b","c2b","threshold","_t1","_t2","cc1","split","cc2","pairs","left","right","pair","results","getccenter","dx1p","dy1p","dx2p","dy2p","mx1","my1","mx2","my2","mx1n","my1n","mx2n","my2n","arc","e","_","numberSort","PolyBezier","constructor","curves","valueOf","toString","addCurve","offset","coords","args","Array","from","arguments","coordlen","newargs","higher","Error","step","dimlen","_linear","some","_lut","update","quadraticFromPoints","abc","getABC","A","cubicFromPoints","S","B","E","C","selen","lx","ly","bx1","by1","bx2","by2","e1","e2","nc1","nc2","getUtils","toSVG","last","setRatios","verify","print","coordDigest","_print","computedirection","clockwise","derivative","bind","u","um","getLUT","steps","on","error","lut","hits","project","ft","np","pim","dderivative","normal","__normal3","__normal2","r1","r2","q1","R","hull","_p","pt","result","span","extrema","mfn","sort","values","overlaps","lbbox","tbbox","nv","scale","simple","n1","n2","segment","pass1","pass2","distanceFn","ov","rc","outline","d3","d4","reduced","fcurves","bcurves","alen","tlen","graduated","linearDistanceFunction","slen","reverse","fs","fe","bs","be","ls","le","segments","outlineshapes","shapes","selfintersects","lineIntersects","curveintersects","arcs","errorThreshold","_iterate","_error","np1","ref","circles","t_s","t_e","safety","np2","np3","prev_arc","curr_good","prev_good","done","t_m","prev_e","interval","Path","topLeft","bottomRight","ops","setRender","move","to","type","cp1","cp2","_curve","pop","curve_","close","noop","id","insop","noopId","path","newPath","asPathstring","op","pathOffset","current","boundary","Infinity","edges","bb","side","closed","joinPaths","offsetLine","shiftAlong","bezier","asPath","paths","joint","err","stepsPerMm","thisLen","shiftAlongBezier","shiftFractionAlong","previous","next","bbs","lineBoundingBox","curveBoundingBox","bbbbox","boxes","minX","maxX","minY","maxY","box","rev","section","edge","topOp","leftOp","bottomOp","rightOp","edgeCurveAsBezier","curveEdge","divide","intersectsX","intersectsAxis","intersectsY","val","mode","lineStart","lineEnd","addIntersectionsToArray","linesIntersect","lineIntersectsCurve","pathA","pathB","curvesIntersect","candidates","candidate","divided","firstHalf","secondHalf","pointOnLine","unshift","pointOnCurve","trim","chunks","firstCandidate","parseInt","lastCandidate","intersection","trimmedStart","trimmedEnd","glue","first","capitalize","string","charAt","toUpperCase","isCoord","macroName","beamsIntersect","slopeA","slopeB","iA","iB","lenA","lenB","lenC","lenD","pointOnBeam","splitCurve","beamIntersectsX","beamIntersectsY","units","bz","isect","curveIntersectsX","curveIntersectsY","fromA","cp1A","cp2A","toA","fromB","cp1B","cp2B","toB","curveA","curveB","tvalues","unique","dupe","circlesIntersect","chorddistance","halfchordlength","chordmidpointx","chordmidpointy","i1","i2","beamIntersectsCircle","det","lineIntersectsCircle","stretchToScale","stretch","sampleStyle","run","runs","styles","isArray","Snippet","def","anchor","Hooks","preDraft","postDraft","preSample","postSample","preRender","postRender","insertText","Part","snippets","freeId","width","height","hooks","macroClosure","self","method","macro","runHooks","hookName","data","hook","getId","unitsClosure","context","settings","margin","paperless","stack","inject","orig","findBasePoint","toPoint","cp1Point","cp2Point","input","shorthand","complete","sa","store","events","apply","create","pointsProxy","Reflect","Proxy","pathsProxy","snippetsProxy","target","prop","receiver","measurementsProxy","measurements","optionsProxy","options","Svg","pattern","openGroups","layout","body","style","script","defs","locale","version","text","idPrefix","embed","head","renderHead","tail","renderTail","partId","parts","part","partSvg","renderPart","transform","openGroup","closeGroup","renderSvgTag","renderStyle","renderScript","renderDefs","nl","indent","outdent","renderPath","renderText","renderCircle","snippet","renderSnippet","renderPathText","escapeText","lineHeight","lines","replace","tab","space","tabs","GrowingPacker","fit","blocks","node","block","root","findNode","splitNode","growNode","used","down","canGrowDown","canGrowRight","shouldGrowRight","shouldGrowDown","growRight","growDown","module","require","items","packer","inPlace","newItems","item","w","curr","h","Store","Map","setIfUnset","has","Pattern","config","info","is","dependencies","hide","resolvedDependencies","resolveDependencies","draftOrder","option","pct","mm","count","bool","dflt","macros","keys","entry","draft","partName","needs","wants","sample","sampleOption","sampleMeasurement","measurement","sampleModels","models","focus","sampleParts","sampleRun","anchors","extraClass","focusStyle","optionName","factor","sampleListOption","measurementName","pack","use","plugin","loadPluginHooks","loadPluginMacros","useIf","condition","bins","bin","transforms","center","graph","sorted","visited","visit","ancestors","dep","resolveDependency","seen","deps","apart","dependency","resolved","only","isHidden","getRenderProps","Design","plugins","conditionalPlugins","call","patterns"],"mappings":"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"}